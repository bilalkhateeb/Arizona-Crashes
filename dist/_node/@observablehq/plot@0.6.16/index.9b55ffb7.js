import{descending as _e,ascending as ur,timeSecond as Va,timeMinute as Ha,timeHour as Ua,timeDay as Za,timeMonday as Hd,timeTuesday as Ud,timeWednesday as Zd,timeThursday as Kd,timeFriday as Qd,timeSaturday as Jd,timeSunday as th,timeWeek as eh,timeMonth as Ka,timeYear as Qa,utcSecond as Ja,utcMinute as tl,utcHour as el,unixDay as nl,utcMonday as nh,utcTuesday as rh,utcWednesday as ih,utcThursday as oh,utcFriday as ah,utcSaturday as lh,utcSunday as sh,utcWeek as uh,utcMonth as rl,utcYear as il,max as zt,pairs as ch,timeFormat as fh,utcFormat as Li,bisector as dh,range as Mn,quantile as An,symbolAsterisk as hh,symbolCircle as zi,symbolCross as ph,symbolDiamond as mh,symbolDiamond2 as yh,symbolPlus as gh,symbolSquare as $h,symbolSquare2 as xh,symbolStar as wh,symbolTimes as bh,symbolTriangle as vh,symbolTriangle2 as kh,symbolWye as Mh,randomLcg as Si,sort as ol,rollup as Ln,sum as qt,InternSet as zn,group as Ce,mode as al,variance as ll,median as Sn,mean as cr,maxIndex as Ah,minIndex as Lh,min as Nt,deviation as fr,rollups as zh,quantize as Bt,schemeAccent as Sh,schemeCategory10 as Eh,schemeDark2 as Oh,schemeObservable10 as Ch,schemePaired as Nh,schemePastel1 as Rh,schemePastel2 as Th,schemeSet1 as Ih,schemeSet2 as Bh,schemeSet3 as Wh,schemeTableau10 as jh,interpolateBrBG as sl,interpolatePRGn as ul,interpolatePiYG as cl,interpolatePuOr as fl,interpolateRdBu as dr,interpolateRdGy as dl,interpolateRdYlBu as hr,interpolateRdYlGn as hl,interpolateSpectral as pl,interpolateBlues as ml,interpolateGreens as yl,interpolateGreys as gl,interpolatePurples as $l,interpolateReds as xl,interpolateOranges as wl,interpolateTurbo as bl,interpolateViridis as vl,interpolateMagma as kl,interpolateInferno as Ml,interpolatePlasma as Al,interpolateCividis as Ll,interpolateCubehelixDefault as zl,interpolateWarm as Sl,interpolateCool as El,interpolateBuGn as Ol,interpolateBuPu as Cl,interpolateGnBu as Nl,interpolateOrRd as Rl,interpolatePuBuGn as Tl,interpolatePuBu as Il,interpolatePuRd as Bl,interpolateRdPu as Wl,interpolateYlGnBu as jl,interpolateYlGn as Fl,interpolateYlOrBr as Dl,interpolateYlOrRd as ql,interpolateRainbow as Yl,interpolateSinebow as Pl,schemeBrBG as Fh,schemePRGn as Dh,schemePiYG as qh,schemePuOr as Yh,schemeRdBu as Xl,schemeRdGy as Ph,schemeRdYlBu as _l,schemeRdYlGn as Xh,schemeSpectral as _h,schemeBlues as Gh,schemeGreens as Vh,schemeGreys as Hh,schemeOranges as Uh,schemePurples as Zh,schemeReds as Kh,schemeBuGn as Qh,schemeBuPu as Jh,schemeGnBu as tp,schemeOrRd as ep,schemePuBu as np,schemePuBuGn as rp,schemePuRd as ip,schemeRdPu as op,schemeYlGn as ap,schemeYlGnBu as lp,schemeYlOrBr as sp,schemeYlOrRd as up,scaleIdentity as cp,scaleSymlog as fp,scaleLog as dp,scalePow as hp,extent as yt,ticks as Ei,interpolateNumber as En,scaleQuantile as pp,scaleThreshold as mp,reverse as pr,scaleLinear as Gl,interpolateRgb as Oi,interpolateRound as yp,piecewise as Ci,interpolateHsl as gp,interpolateHcl as $p,interpolateLab as xp,scaleDivergingSymlog as wp,scaleDivergingLog as bp,scaleDivergingPow as vp,scaleDiverging as kp,scaleTime as Mp,scaleUtc as Ap,scaleBand as Vl,scalePoint as Lp,scaleImplicit as zp,scaleOrdinal as Sp,symbolsStroke as Ep,symbolsFill as Op,InternMap as Ni,cross as Cp,geoTransform as mr,geoPath as Kt,geoStream as Np,geoClipRectangle as Rp,geoTransverseMercator as Tp,geoStereographic as Ip,geoOrthographic as Bp,geoMercator as Wp,geoGnomonic as jp,geoEquirectangular as Fp,geoEqualEarth as Dp,geoConicEquidistant as qp,geoConicEqualArea as Yp,geoConicConformal as Pp,geoAzimuthalEquidistant as Xp,geoAzimuthalEqualArea as _p,geoAlbers as Gp,geoAlbersUsa as Vp,select as he,creator as Hl,namespaces as Ne,pointer as Hp,format as Ri,axisBottom as Up,pathRound as Qt,rgb as On,cumsum as Zp,groupSort as Ti,greatest as Ii,curveLinear as Bi,curveBasis as Kp,curveBasisClosed as Qp,curveBasisOpen as Jp,curveBundle as tm,curveBumpX as em,curveBumpY as nm,curveCardinal as rm,curveCardinalClosed as im,curveCardinalOpen as om,curveCatmullRom as am,curveCatmullRomClosed as lm,curveCatmullRomOpen as sm,curveLinearClosed as um,curveMonotoneX as cm,curveMonotoneY as fm,curveNatural as dm,curveStep as hm,curveStepAfter as pm,curveStepBefore as mm,thresholdSturges as Ul,thresholdScott as Zl,thresholdFreedmanDiaconis as ym,utcTickInterval as gm,tickIncrement as $m,bisect as xm,area as Wi,line as wm,rank as Kl,count as bm,blurImage as vm,Delaunay as Ge,blur2 as km,contours as Mm,nice as Am,contourDensity as Lm,geoCentroid as zm,geoGraticule10 as Sm,stratify as Ql,tree as yr,cluster as Jl,least as Em}from"../../d3@7.9.0/index.53f82e1f.js";import{parse as ts,format as Om}from"../../isoformat@0.2.1/index.0882e9d9.js";import Cm from"../../interval-tree-1d@1.0.4/index.18b49a7e.js";function xt(t){return t!=null&&!Number.isNaN(t)}function Rt(t,e){return+xt(e)-+xt(t)||ur(t,e)}function gr(t,e){return+xt(e)-+xt(t)||_e(t,e)}function ji(t){return t!=null&&`${t}`!=""}function $r(t){return isFinite(t)?t:NaN}function Jt(t){return t>0&&isFinite(t)?t:NaN}function xr(t){return t<0&&isFinite(t)?t:NaN}function Ve(t){if(t==null)return;const e=t[0],n=t[t.length-1];return _e(e,n)}const He=1e3,pe=He*60,me=pe*60,Yt=me*24,Pt=Yt*7,Re=Yt*30,ye=Yt*365,Fi=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",He],["5 seconds",5*He],["15 seconds",15*He],["30 seconds",30*He],["minute",pe],["5 minutes",5*pe],["15 minutes",15*pe],["30 minutes",30*pe],["hour",me],["3 hours",3*me],["6 hours",6*me],["12 hours",12*me],["day",Yt],["2 days",2*Yt],["week",Pt],["2 weeks",2*Pt],["month",Re],["3 months",3*Re],["6 months",6*Re],["year",ye],["2 years",2*ye],["5 years",5*ye],["10 years",10*ye],["20 years",20*ye],["50 years",50*ye],["100 years",100*ye]],Di=new Map([["second",He],["minute",pe],["hour",me],["day",Yt],["monday",Pt],["tuesday",Pt],["wednesday",Pt],["thursday",Pt],["friday",Pt],["saturday",Pt],["sunday",Pt],["week",Pt],["month",Re],["year",ye]]),es=new Map([["second",Va],["minute",Ha],["hour",Ua],["day",Za],["monday",Hd],["tuesday",Ud],["wednesday",Zd],["thursday",Kd],["friday",Qd],["saturday",Jd],["sunday",th],["week",eh],["month",Ka],["year",Qa]]),qi=new Map([["second",Ja],["minute",tl],["hour",el],["day",nl],["monday",nh],["tuesday",rh],["wednesday",ih],["thursday",oh],["friday",ah],["saturday",lh],["sunday",sh],["week",uh],["month",rl],["year",il]]),Cn=Symbol("intervalDuration"),wr=Symbol("intervalType");for(const[t,e]of es)e[Cn]=Di.get(t),e[wr]="time";for(const[t,e]of qi)e[Cn]=Di.get(t),e[wr]="utc";const Nn=[["year",il,"utc"],["month",rl,"utc"],["day",nl,"utc",6*Re],["hour",el,"utc",3*Yt],["minute",tl,"utc",6*me],["second",Ja,"utc",30*pe]],br=[["year",Qa,"time"],["month",Ka,"time"],["day",Za,"time",6*Re],["hour",Ua,"time",3*Yt],["minute",Ha,"time",6*me],["second",Va,"time",30*pe]],Nm=[Nn[0],br[0],Nn[1],br[1],Nn[2],br[2],...Nn.slice(3)];function Yi(t){let e=`${t}`.toLowerCase();e.endsWith("s")&&(e=e.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(e);switch(r&&(e=e.slice(r[0].length),n=+r[1]),e){case"quarter":e="month",n*=3;break;case"half":e="month",n*=6;break}let i=qi.get(e);if(!i)throw new Error(`unknown interval: ${t}`);if(n>1&&!i.every)throw new Error(`non-periodic interval: ${e}`);return[e,n]}function Pi(t){return ns(Yi(t),"time")}function vr(t){return ns(Yi(t),"utc")}function ns([t,e],n){let r=(n==="time"?es:qi).get(t);return e>1&&(r=r.every(e),r[Cn]=Di.get(t)*e,r[wr]=n),r}function rs(t,e){if(!(e>1))return;const n=t[Cn];if(!Fi.some(([,i])=>i===n)||n%Yt===0&&Yt<n&&n<Re)return;const[r]=Fi[dh(([,i])=>Math.log(i)).center(Fi,Math.log(n*e))];return(t[wr]==="time"?Pi:vr)(r)}function is(t,e,n){const r=e==="time"?fh:Li;if(n==null)return r(t==="year"?"%Y":t==="month"?"%Y-%m":t==="day"?"%Y-%m-%d":t==="hour"||t==="minute"?"%Y-%m-%dT%H:%M":t==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const i=Rm(n);switch(t){case"millisecond":return Ue(r(".%L"),r(":%M:%S"),i);case"second":return Ue(r(":%S"),r("%-I:%M"),i);case"minute":return Ue(r("%-I:%M"),r("%p"),i);case"hour":return Ue(r("%-I %p"),r("%b %-d"),i);case"day":return Ue(r("%-d"),r("%b"),i);case"month":return Ue(r("%b"),r("%Y"),i);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function Rm(t){return t==="left"||t==="right"?(e,n)=>`
${e}
${n}`:t==="top"?(e,n)=>`${n}
${e}`:(e,n)=>`${e}
${n}`}function Tm(t){return t==="time"?br:t==="utc"?Nn:Nm}function Im(t,e,n){const r=zt(ch(e,(i,o)=>Math.abs(o-i)));if(r<1e3)return is("millisecond","utc",n);for(const[i,o,a,l]of Tm(t)){if(r>l||i==="hour"&&!r)break;if(e.every(s=>o.floor(s)>=s))return is(i,a,n)}}function Ue(t,e,n){return(r,i,o)=>{const a=t(r,i),l=e(r,i),s=i-Ve(o);return i!==s&&o[s]!==void 0&&l===e(o[s],s)?a:n(a,l)}}const kr=Object.getPrototypeOf(Uint8Array),Bm=Object.prototype.toString;function te(t){return t instanceof Array||t instanceof kr}function os(t){return t instanceof kr&&!Wm(t)}function as(t){return t?.prototype instanceof kr&&!jm(t)}function Wm(t){return t instanceof BigInt64Array||t instanceof BigUint64Array}function jm(t){return t===BigInt64Array||t===BigUint64Array}const ls=Symbol("reindex");function V(t,e,n){const r=typeof e;return r==="string"?bs(t)?_i(t.getChild(e),n):ss(t,us(e),n):r==="function"?ss(t,e,n):r==="number"||e instanceof Date||r==="boolean"?J(t,wt(e),n):typeof e?.transform=="function"?Xi(e.transform(t),n):Fm(Xi(e,n),t?.[ls])}function Fm(t,e){return t!=null&&e?Ar(t,e):t}function ss(t,e,n){return J(t,as(n)?(r,i)=>Hi(e(r,i)):e,n)}function Xi(t,e){return e===void 0?ee(t):vs(t)?_i(t,e):t instanceof e?t:e.from(t,as(e)&&!os(t)?Hi:void 0)}function _i(t,e){return t==null?t:(e===void 0||e===Array)&&Jm(t.type)?cs(t.toArray()):Xi(t.toArray(),e)}const Rn=[null],us=t=>e=>{const n=e[t];return n===void 0&&e.type==="Feature"?e.properties?.[t]:n},gt={transform:ne},D={transform:t=>t},Gi=()=>1,Dm=()=>!0,kt=t=>t==null?t:`${t}`,rt=t=>t==null?t:+t,Mr=t=>t?t[0]:void 0,Tn=t=>t?t[1]:void 0,qm=t=>t?t[2]:void 0,wt=t=>()=>t;function Vi(t){const e=+`${t}`.slice(1)/100;return(n,r)=>An(n,e,r)}function St(t){return os(t)?t:J(t,Hi,Float64Array)}function Hi(t){return t==null?NaN:Number(t)}function cs(t){return J(t,fs)}function fs(t){return t instanceof Date&&!isNaN(t)?t:typeof t=="string"?ts(t):t==null||isNaN(t=Number(t))?void 0:new Date(t)}function Mt(t,e){return t===void 0&&(t=e),t===null?[void 0,"none"]:Wn(t)?[void 0,t]:[t,void 0]}function dt(t,e){return t===void 0&&(t=e),t===null||typeof t=="number"?[void 0,t]:[t,void 0]}function ds(t,e,n){if(t!=null)return Ot(t,e,n)}function Ot(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function Ze(t){return bs(t)?t:ee(t)}function ee(t){if(t==null||te(t))return t;if(vs(t))return _i(t);switch(t.type){case"FeatureCollection":return t.features;case"GeometryCollection":return t.geometries;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":return[t]}return Array.from(t)}function J(t,e,n=Array){return t==null?t:t instanceof n?t.map(e):n.from(t,e)}function In(t,e=Array){return t instanceof e?t.slice():e.from(t)}function hs({x:t,x1:e,x2:n}){return t!==void 0||e!==void 0||n!==void 0}function ps({y:t,y1:e,y2:n}){return t!==void 0||e!==void 0||n!==void 0}function Ke(t){return hs(t)||ps(t)||t.interval!==void 0}function Tt(t){return t?.toString===Bm}function Te(t){return Tt(t)&&(t.type!==void 0||t.domain!==void 0)}function Xt(t){return Tt(t)&&typeof t.transform!="function"}function ge(t){return Xt(t)&&t.value===void 0&&t.channel===void 0}function ms(t,e,n,r=D){return e===void 0&&n===void 0?(e=0,n=t===void 0?r:t):e===void 0?e=t===void 0?0:t:n===void 0&&(n=t===void 0?0:t),[e,n]}function Wt(t,e){return t===void 0&&e===void 0?[Mr,Tn]:[t,e]}function $e({z:t,fill:e,stroke:n}={}){return t===void 0&&([t]=Mt(e)),t===void 0&&([t]=Mt(n)),t}function Bn(t){return te(t)?t.length:t?.numRows}function ne(t){const e=Bn(t),n=new Uint32Array(e);for(let r=0;r<e;++r)n[r]=r;return n}function Ar(t,e){return te(t)?J(e,n=>t[n],t.constructor):J(e,n=>t.at(n))}function Ui(t){return t.length===1?(e,n)=>t(Ar(n,e)):t}function Ie(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function re(t){return t!==null&&typeof t=="object"?t.valueOf():t}function ys(t,e){if(e[t]!==void 0)return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y";break}return e[t]}function Ct(t){let e;return[{transform:()=>e,label:_t(t)},n=>e=n]}function Et(t){return t==null?[t]:Ct(t)}function _t(t,e){return typeof t=="string"?t:t&&t.label!==void 0?t.label:e}function Lr(t,e){return{transform(n){const r=t.transform(n),i=e.transform(n);return At(r)||At(i)?J(r,(o,a)=>new Date((+r[a]+ +i[a])/2)):J(r,(o,a)=>(+r[a]+ +i[a])/2,Float64Array)},label:t.label}}function zr(t,e){const n=gs(e?.interval,e?.type);return n?J(t,n):t}function gs(t,e){const n=Sr(t,e);return n&&(r=>xt(r)?n.floor(r):r)}function Sr(t,e){if(t!=null){if(typeof t=="number")return $s(t);if(typeof t=="string")return(e==="time"?Pi:vr)(t);if(typeof t.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof t.offset!="function")throw new Error("invalid interval; missing offset method");return t}}function $s(t){t=+t,0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const e=Math.abs(t);return t<0?{floor:n=>Math.floor(n*e)/e,offset:(n,r=1)=>(n*e+Math.floor(r))/e,range:(n,r)=>Mn(Math.ceil(n*e),r*e).map(i=>i/e)}:{floor:n=>Math.floor(n/e)*e,offset:(n,r=1)=>n+e*Math.floor(r),range:(n,r)=>Mn(Math.ceil(n/e),r/e).map(i=>i*e)}}function Qe(t,e){if(t=Sr(t,e),t&&typeof t.range!="function")throw new Error("invalid interval: missing range method");return t}function Ym(t,e){if(t=Qe(t,e),t&&typeof t.ceil!="function")throw new Error("invalid interval: missing ceil method");return t}function Pm(t){return Je(t)&&typeof t?.floor=="function"&&t.floor()instanceof Date}function Je(t){return typeof t?.range=="function"}function tn(t){return t===void 0||Xt(t)?t:{value:t}}function Xm(t){return t==null?null:{transform:e=>V(e,t,Float64Array),label:_t(t)}}function _m(t){if(!ie(t))return!1;for(const e of t)if(e!=null)return typeof e=="object"&&"0"in e&&"1"in e}function ie(t){return t&&typeof t[Symbol.iterator]=="function"}function xs(t){for(const e of t)if(e!=null)return typeof e!="object"||e instanceof Date}function ut(t){for(const e of t){if(e==null)continue;const n=typeof e;return n==="string"||n==="boolean"}}function At(t){for(const e of t)if(e!=null)return e instanceof Date}function Gm(t){for(const e of t)if(e!=null)return typeof e=="string"&&isNaN(e)&&ts(e)}function Vm(t){for(const e of t)if(e!=null){if(typeof e!="string")return!1;if(e.trim())return!isNaN(e)}}function en(t){for(const e of t)if(e!=null)return typeof e=="number"}function Zi(t,e){let n;for(const r of t)if(r!=null){if(!e(r))return!1;n=!0}return n}const Hm=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function Wn(t){return typeof t!="string"?!1:(t=t.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(t)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(t)||Hm.has(t))}function Um(t){return typeof t=="number"&&(0<=t&&t<=1||isNaN(t))}function lt(t){return t==null||nn(t)}function nn(t){return/^\s*none\s*$/i.test(t)}function Zm(t){return/^\s*round\s*$/i.test(t)}function Ki(t,e){return ds(t,e,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function jn(t="middle"){return Ki(t,"frameAnchor")}function Km(t={},...e){let n=t;for(const r of e)for(const i in r)if(n[i]===void 0){const o=r[i];n===t?n={...n,[i]:o}:n[i]=o}return n}function Qm(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,n=>{const{name:r}=n;if(r==null)throw new Error("missing name");const i=`${r}`;if(i==="__proto__")throw new Error(`illegal name: ${i}`);if(e.has(i))throw new Error(`duplicate name: ${i}`);return e.add(i),[r,n]}))}function Qi(t){return ie(t)?Qm(t):t}function ws(t){return t===!0?t="frame":t===!1?t=null:t!=null&&(t=Ot(t,"clip",["frame","sphere"])),t}function bs(t){return t&&typeof t.getChild=="function"&&typeof t.toArray=="function"&&t.schema&&Array.isArray(t.schema.fields)}function vs(t){return t&&typeof t.toArray=="function"&&t.type}function Jm(t){return t&&(t.typeId===8||t.typeId===10)&&t.unit===1}const Gt=Symbol("position"),oe=Symbol("color"),Fn=Symbol("radius"),Dn=Symbol("length"),qn=Symbol("opacity"),Er=Symbol("symbol"),ks=Symbol("projection"),st=new Map([["x",Gt],["y",Gt],["fx",Gt],["fy",Gt],["r",Fn],["color",oe],["opacity",qn],["symbol",Er],["length",Dn],["projection",ks]]);function ty(t){return t===Gt||t===ks}function ey(t){return t===Gt||t===Fn||t===Dn||t===qn}const Ms=Math.sqrt(3),As=2/Ms,ny={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*As,i=r/2;t.moveTo(0,r),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(0,-r),t.lineTo(-n,-i),t.lineTo(-n,i),t.closePath()}},Ji=new Map([["asterisk",hh],["circle",zi],["cross",ph],["diamond",mh],["diamond2",yh],["hexagon",ny],["plus",gh],["square",$h],["square2",xh],["star",wh],["times",bh],["triangle",vh],["triangle2",kh],["wye",Mh]]);function to(t){return t&&typeof t.draw=="function"}function ry(t){return to(t)?!0:typeof t!="string"?!1:Ji.has(t.toLowerCase())}function eo(t){if(t==null||to(t))return t;const e=Ji.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function iy(t){if(t==null||to(t))return[void 0,t];if(typeof t=="string"){const e=Ji.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}function jt({filter:t,sort:e,reverse:n,transform:r,initializer:i,...o}={},a){if(r===void 0&&(t!=null&&(r=io(t)),e!=null&&!ge(e)&&(r=no(r,ao(e))),n&&(r=no(r,oo))),a!=null&&i!=null)throw new Error("transforms cannot be applied after initializers");return{...o,...(e===null||ge(e))&&{sort:e},transform:no(r,a)}}function Lt({filter:t,sort:e,reverse:n,initializer:r,...i}={},o){return r===void 0&&(t!=null&&(r=io(t)),e!=null&&!ge(e)&&(r=ro(r,ao(e))),n&&(r=ro(r,oo))),{...i,...(e===null||ge(e))&&{sort:e},initializer:ro(r,o)}}function no(t,e){return t==null?e===null?void 0:e:e==null?t===null?void 0:t:function(n,r,i){return{data:n,facets:r}=t.call(this,n,r,i),e.call(this,Ze(n),r,i)}}function ro(t,e){return t==null?e===null?void 0:e:e==null?t===null?void 0:t:function(n,r,i,...o){let a,l,s,u,c,d;return{data:l=n,facets:s=r,channels:a}=t.call(this,n,r,i,...o),{data:c=l,facets:d=s,channels:u}=e.call(this,l,s,{...i,...a},...o),{data:c,facets:d,channels:{...a,...u}}}}function Or(t,e){return(t.initializer!=null?Lt:jt)(t,e)}function oy(t,e){return Or(e,io(t))}function io(t){return(e,n)=>{const r=V(e,t);return{data:e,facets:n.map(i=>i.filter(o=>r[o]))}}}function ay({sort:t,...e}={}){return{...Or(e,oo),sort:ge(t)?t:null}}function oo(t,e){return{data:t,facets:e.map(n=>n.slice().reverse())}}function ly({seed:t,sort:e,...n}={}){return{...Or(n,zs(t==null?Math.random:Si(t))),sort:ge(e)?e:null}}function Ls(t,{sort:e,...n}={}){return{...(Xt(t)&&t.channel!==void 0?Lt:Or)(n,ao(t)),sort:ge(e)?e:null}}function ao(t){return(typeof t=="function"&&t.length!==1?sy:zs)(t)}function sy(t){return(e,n)=>{const r=te(e)?(i,o)=>t(e[i],e[o]):(i,o)=>t(e.get(i),e.get(o));return{data:e,facets:n.map(i=>i.slice().sort(r))}}}function zs(t){let e,n;({channel:e,value:t,order:n}={...tn(t)});const r=e?.startsWith("-");if(r&&(e=e.slice(1)),n===void 0&&(n=r?gr:Rt),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=Rt;break;case"descending":n=gr;break;default:throw new Error(`invalid order: ${n}`)}return(i,o,a)=>{let l;if(e===void 0)l=V(i,t);else{if(a===void 0)throw new Error("channel sort requires an initializer");if(l=a[e],!l)return{};l=l.value}const s=(u,c)=>n(l[u],l[c]);return{data:i,facets:o.map(u=>u.slice().sort(s))}}}function lo(t,e){return Cr(null,null,t,e)}function Yn(t={y:"count"},e={}){const{x:n=D}=e;if(n==null)throw new Error("missing channel: x");return Cr(n,null,t,e)}function Pn(t={x:"count"},e={}){const{y:n=D}=e;if(n==null)throw new Error("missing channel: y");return Cr(null,n,t,e)}function so(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=Wt(n,r),n==null)throw new Error("missing channel: x");if(r==null)throw new Error("missing channel: y");return Cr(n,r,t,e)}function Cr(t,e,{data:n=ho,filter:r,sort:i,reverse:o,...a}={},l={}){a=Es(a,l),n=Ns(n,D),i=i==null?void 0:Os("sort",i,l),r=r==null?void 0:Cs("filter",r,l);const[s,u]=Et(t),[c,d]=Et(e),{z:f,fill:h,stroke:p,x1:m,x2:x,y1:g,y2:y,...w}=l,[$,v]=Et(f),[b]=Mt(h),[k]=Mt(p),[M,A]=Et(b),[z,S]=Et(k);return{..."z"in l&&{z:$||f},..."fill"in l&&{fill:M||h},..."stroke"in l&&{stroke:z||p},...jt(w,(L,C,E)=>{const O=zr(V(L,t),E?.x),R=zr(V(L,e),E?.y),N=V(L,f),F=V(L,b),T=V(L,k),B=fo(a,{z:N,fill:F,stroke:T}),j=[],I=[],Y=O&&u([]),H=R&&d([]),G=N&&v([]),X=F&&A([]),W=T&&S([]);let P=0;for(const _ of a)_.initialize(L);i&&i.initialize(L),r&&r.initialize(L);for(const _ of C){const Z=[];for(const K of a)K.scope("facet",_);i&&i.scope("facet",_),r&&r.scope("facet",_);for(const[K,nt]of Be(_,B))for(const[ft,at]of Be(nt,R))for(const[ht,mt]of Be(at,O)){const vt={data:L};if(O&&(vt.x=ht),R&&(vt.y=ft),B&&(vt.z=K),!(r&&!r.reduce(mt,vt))){Z.push(P++),I.push(n.reduceIndex(mt,L,vt)),O&&Y.push(ht),R&&H.push(ft),N&&G.push(B===N?K:N[mt[0]]),F&&X.push(B===F?K:F[mt[0]]),T&&W.push(B===T?K:T[mt[0]]);for(const Ee of a)Ee.reduce(mt,vt);i&&i.reduce(mt,vt)}}j.push(Z)}return Rs(j,i,o),{data:I,facets:j}}),...!xe(a,"x")&&(s?{x:s}:{x1:m,x2:x}),...!xe(a,"y")&&(c?{y:c}:{y1:g,y2:y}),...Object.fromEntries(a.map(({name:L,output:C})=>[L,C]))}}function xe(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function Ss(t,e,n=uo){const r=Object.entries(t);return e.title!=null&&t.title===void 0&&r.push(["title",py]),e.href!=null&&t.href===void 0&&r.push(["href",po]),r.filter(([,i])=>i!==void 0).map(([i,o])=>o===null?uy(i):n(i,o,e))}function uo(t,e,n,r=co){let i;Tt(e)&&"reduce"in e&&(i=e.scale,e=e.reduce);const o=r(t,e,n),[a,l]=Ct(o.label);let s;return{name:t,output:i===void 0?a:{value:a,scale:i},initialize(u){o.initialize(u),s=l([])},scope(u,c){o.scope(u,c)},reduce(u,c){s.push(o.reduce(u,c))}}}function uy(t){return{name:t,initialize(){},scope(){},reduce(){}}}function co(t,e,n,r=Nr){const i=ys(t,n),o=r(e,i);let a,l;return{label:_t(o===Rr?null:i,o.label),initialize(s){a=i===void 0?s:V(s,i),o.scope==="data"&&(l=o.reduceIndex(ne(s),a))},scope(s,u){o.scope===s&&(l=o.reduceIndex(u,a))},reduce(s,u){return o.scope==null?o.reduceIndex(s,a,u):o.reduceIndex(s,a,l,u)}}}function Be(t,e){return e?Ce(t,n=>e[n]):[[,t]]}function Nr(t,e,n=cy){if(t==null)return n(t);if(typeof t.reduceIndex=="function")return t;if(typeof t.reduce=="function"&&Tt(t))return dy(t);if(typeof t=="function")return hy(t);if(/^p\d{2}$/i.test(t))return ae(Vi(t));switch(`${t}`.toLowerCase()){case"first":return po;case"last":return my;case"identity":return ho;case"count":return Rr;case"distinct":return yy;case"sum":return e==null?Rr:gy;case"proportion":return Is(e,"data");case"proportion-facet":return Is(e,"facet");case"deviation":return ae(fr);case"min":return ae(Nt);case"min-index":return ae(Lh);case"max":return ae(zt);case"max-index":return ae(Ah);case"mean":return Ts(cr);case"median":return Ts(Sn);case"variance":return ae(ll);case"mode":return ae(al)}return n(t)}function cy(t){throw new Error(`invalid reduce: ${t}`)}function Es(t,e){return Ss(t,e,Os)}function Os(t,e,n){return uo(t,e,n,Cs)}function Cs(t,e,n){return co(t,e,n,Ns)}function Ns(t,e){return Nr(t,e,fy)}function fy(t){switch(`${t}`.toLowerCase()){case"x":return $y;case"y":return xy;case"z":return Bs}throw new Error(`invalid group reduce: ${t}`)}function fo(t,e){for(const n in e){const r=e[n];if(r!==void 0&&!t.some(i=>i.name===n))return r}}function Rs(t,e,n){if(e){const r=e.output.transform(),i=(o,a)=>Rt(r[o],r[a]);t.forEach(o=>o.sort(i))}n&&t.forEach(r=>r.reverse())}function dy(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}function hy(t){return{reduceIndex(e,n,r){return t(Ar(n,e),r)}}}function ae(t){return{reduceIndex(e,n){return t(e,r=>n[r])}}}function Ts(t){return{reduceIndex(e,n){const r=t(e,i=>n[i]);return At(n)?new Date(r):r}}}const ho={reduceIndex(t,e){return Ar(e,t)}},po={reduceIndex(t,e){return e[t[0]]}},py={reduceIndex(t,e){const n=ol(Ln(t,i=>i.length,i=>e[i]),Tn),r=n.slice(-5).reverse();if(r.length<n.length){const i=n.slice(0,-4);r[4]=[`\u2026 ${i.length.toLocaleString("en-US")} more`,qt(i,Tn)]}return r.map(([i,o])=>`${i} (${o.toLocaleString("en-US")})`).join(`
`)}},my={reduceIndex(t,e){return e[t[t.length-1]]}},Rr={label:"Frequency",reduceIndex(t){return t.length}},yy={label:"Distinct",reduceIndex(t,e){const n=new zn;for(const r of t)n.add(e[r]);return n.size}},gy=ae(qt);function Is(t,e){return t==null?{scope:e,label:"Frequency",reduceIndex:(n,r,i=1)=>n.length/i}:{scope:e,reduceIndex:(n,r,i=1)=>qt(n,o=>r[o])/i}}const $y={reduceIndex(t,e,{x:n}){return n}},xy={reduceIndex(t,e,{y:n}){return n}},Bs={reduceIndex(t,e,{z:n}){return n}};function wy(t){if(typeof t!="function")throw new Error(`invalid test function: ${t}`);return{reduceIndex(e,n,{data:r}){return n[e.find(te(r)?i=>t(r[i],i,r):i=>t(r.get(i),i,r))]}}}function Xn(t,{scale:e,type:n,value:r,filter:i,hint:o,label:a=_t(r)},l){return o===void 0&&typeof r?.transform=="function"&&(o=r.hint),js(l,{scale:e,type:n,value:V(t,r),label:a,filter:i,hint:o})}function Ws(t,e){return Object.fromEntries(Object.entries(t).map(([n,r])=>[n,Xn(e,r,n)]))}function mo(t,e){const n=Object.fromEntries(Object.entries(t).map(([r,{scale:i,value:o}])=>{const a=i==null?null:e[i];return[r,a==null?o:J(o,a)]}));return n.channels=t,n}function js(t,e){const{scale:n,value:r}=e;if(n===!0||n==="auto")switch(t){case"fill":case"stroke":case"color":e.scale=n!==!0&&Zi(r,Wn)?null:"color",e.defaultScale="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":e.scale=n!==!0&&Zi(r,Um)?null:"opacity",e.defaultScale="opacity";break;case"symbol":n!==!0&&Zi(r,ry)?(e.scale=null,e.value=J(r,eo)):e.scale="symbol",e.defaultScale="symbol";break;default:e.scale=st.has(t)?t:null;break}else if(n===!1)e.scale=null;else if(n!=null&&!st.has(n))throw new Error(`unknown scale: ${n}`);return e}function by(t,e,n,r,i){const{order:o,reverse:a,reduce:l=!0,limit:s}=i;for(const u in i){if(!st.has(u))continue;let{value:c,order:d=o,reverse:f=a,reduce:h=l,limit:p=s}=tn(i[u]);const m=c?.startsWith("-");if(m&&(c=c.slice(1)),d=d===void 0?m!==(c==="width"||c==="height")?qs:Ds:My(d),h==null||h===!1)continue;const x=u==="fx"||u==="fy"?ky(e,r[u]):vy(n,u);if(!x)throw new Error(`missing channel for scale: ${u}`);const g=x.value,[y=0,w=1/0]=ie(p)?p:p<0?[p]:[0,p];if(c==null)x.domain=()=>{let $=Array.from(new zn(g));return f&&($=$.reverse()),(y!==0||w!==1/0)&&($=$.slice(y,w)),$};else{const $=c==="data"?t:c==="height"?Fs(n,"y1","y2"):c==="width"?Fs(n,"x1","x2"):yo(n,c,c==="y"?"y2":c==="x"?"x2":void 0),v=Nr(h===!0?"max":h,$);x.domain=()=>{let b=zh(ne(g),k=>v.reduceIndex(k,$),k=>g[k]);return d&&b.sort(d),f&&b.reverse(),(y!==0||w!==1/0)&&(b=b.slice(y,w)),b.map(Mr)}}}}function vy(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function ky(t,e){const n=t.original;if(n===t)return e;const r=e.value,i=e.value=[];for(let o=0;o<n.length;++o){const a=r[n[o][0]];for(const l of t[o])i[l]=a}return e}function Fs(t,e,n){const r=yo(t,e),i=yo(t,n);return J(i,(o,a)=>Math.abs(o-r[a]),Float64Array)}function yo(t,e,n){let r=t[e];if(!r&&n!==void 0&&(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function My(t){if(t==null||typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"ascending":return Ds;case"descending":return qs}throw new Error(`invalid order: ${t}`)}function Ds([t,e],[n,r]){return Rt(e,r)||Rt(t,n)}function qs([t,e],[n,r]){return gr(e,r)||Rt(t,n)}function go(t,e){let n=t[e];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}const Ys=new Map([["accent",Sh],["category10",Eh],["dark2",Oh],["observable10",Ch],["paired",Nh],["pastel1",Rh],["pastel2",Th],["set1",Ih],["set2",Bh],["set3",Wh],["tableau10",jh]]);function Ay(t){return t!=null&&Ys.has(`${t}`.toLowerCase())}const Ps=new Map([...Ys,["brbg",le(Fh,sl)],["prgn",le(Dh,ul)],["piyg",le(qh,cl)],["puor",le(Yh,fl)],["rdbu",le(Xl,dr)],["rdgy",le(Ph,dl)],["rdylbu",le(_l,hr)],["rdylgn",le(Xh,hl)],["spectral",le(_h,pl)],["burd",Xs(Xl,dr)],["buylrd",Xs(_l,hr)],["blues",$t(Gh,ml)],["greens",$t(Vh,yl)],["greys",$t(Hh,gl)],["oranges",$t(Uh,wl)],["purples",$t(Zh,$l)],["reds",$t(Kh,xl)],["turbo",se(bl)],["viridis",se(vl)],["magma",se(kl)],["inferno",se(Ml)],["plasma",se(Al)],["cividis",se(Ll)],["cubehelix",se(zl)],["warm",se(Sl)],["cool",se(El)],["bugn",$t(Qh,Ol)],["bupu",$t(Jh,Cl)],["gnbu",$t(tp,Nl)],["orrd",$t(ep,Rl)],["pubu",$t(np,Il)],["pubugn",$t(rp,Tl)],["purd",$t(ip,Bl)],["rdpu",$t(op,Wl)],["ylgn",$t(ap,Fl)],["ylgnbu",$t(lp,jl)],["ylorbr",$t(sp,Dl)],["ylorrd",$t(up,ql)],["rainbow",_s(Yl)],["sinebow",_s(Pl)]]);function $t(t,e){return({length:n})=>n===1?[t[3][1]]:n===2?[t[3][1],t[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?Bt(e,n):t[n])}function le(t,e){return({length:n})=>n===2?[t[3][0],t[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?Bt(e,n):t[n])}function Xs(t,e){return({length:n})=>n===2?[t[3][2],t[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?Bt(r=>e(1-r),n):t[n].slice().reverse())}function se(t){return({length:e})=>Bt(t,Math.max(2,Math.floor(e)))}function _s(t){return({length:e})=>Bt(t,Math.floor(e)+1).slice(0,-1)}function Gs(t){const e=`${t}`.toLowerCase();if(!Ps.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return Ps.get(e)}function Tr(t,e){const n=Gs(t),r=typeof n=="function"?n({length:e}):n;return r.length!==e?r.slice(0,e):r}function Ly(t,e="greys"){const n=new Set,[r,i]=Tr(e,2);for(const o of t)if(o!=null)if(o===!0)n.add(i);else if(o===!1)n.add(r);else return;return[...n]}const Vs=new Map([["brbg",sl],["prgn",ul],["piyg",cl],["puor",fl],["rdbu",dr],["rdgy",dl],["rdylbu",hr],["rdylgn",hl],["spectral",pl],["burd",t=>dr(1-t)],["buylrd",t=>hr(1-t)],["blues",ml],["greens",yl],["greys",gl],["purples",$l],["reds",xl],["oranges",wl],["turbo",bl],["viridis",vl],["magma",kl],["inferno",Ml],["plasma",Al],["cividis",Ll],["cubehelix",zl],["warm",Sl],["cool",El],["bugn",Ol],["bupu",Cl],["gnbu",Nl],["orrd",Rl],["pubugn",Tl],["pubu",Il],["purd",Bl],["rdpu",Wl],["ylgnbu",jl],["ylgn",Fl],["ylorbr",Dl],["ylorrd",ql],["rainbow",Yl],["sinebow",Pl]]);function $o(t){const e=`${t}`.toLowerCase();if(!Vs.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return Vs.get(e)}const zy=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function Sy(t){return t!=null&&zy.has(`${t}`.toLowerCase())}const Hs=t=>e=>t(1-e),xo=[0,1],Us=new Map([["number",En],["rgb",Oi],["hsl",gp],["hcl",$p],["lab",xp]]);function Zs(t){const e=`${t}`.toLowerCase();if(!Us.has(e))throw new Error(`unknown interpolator: ${e}`);return Us.get(e)}function _n(t,e,n,{type:r,nice:i,clamp:o,zero:a,domain:l=Qs(t,n),unknown:s,round:u,scheme:c,interval:d,range:f=st.get(t)===Fn?Fy(n,l):st.get(t)===Dn?Dy(n,l):st.get(t)===qn?xo:void 0,interpolate:h=st.get(t)===oe?c==null&&f!==void 0?Oi:$o(c!==void 0?c:r==="cyclical"?"rainbow":"turbo"):u?yp:En,reverse:p}){if(d=Qe(d,r),(r==="cyclical"||r==="sequential")&&(r="linear"),typeof h!="function"&&(h=Zs(h)),p=!!p,f!==void 0){const m=(l=ee(l)).length,x=(f=ee(f)).length;if(m!==x){if(h.length===1)throw new Error("invalid piecewise interpolator");h=Ci(h,f),f=void 0}}if(h.length===1?(p&&(h=Hs(h),p=!1),f===void 0&&(f=Float64Array.from(l,(m,x)=>x/(l.length-1)),f.length===2&&(f=xo)),e.interpolate((f===xo?wt:bo)(h))):e.interpolate(h),a){const[m,x]=yt(l);(m>0||x<0)&&(l=In(l),(Ve(l)||1)===Math.sign(m)?l[0]=0:l[l.length-1]=0)}return p&&(l=pr(l)),e.domain(l).unknown(s),i&&(e.nice(Ey(i,r)),l=e.domain()),f!==void 0&&e.range(f),o&&e.clamp(o),{type:r,domain:l,range:f,scale:e,interpolate:h,interval:d}}function Ey(t,e){return t===!0?void 0:typeof t=="number"?t:Ym(t,e)}function Oy(t,e,n){return _n(t,Gl(),e,n)}function Cy(t,e,n){return Ks(t,e,{...n,exponent:.5})}function Ks(t,e,{exponent:n=1,...r}){return _n(t,hp().exponent(n),e,{...r,type:"pow"})}function Ny(t,e,{base:n=10,domain:r=qy(e),...i}){return _n(t,dp().base(n),e,{...i,domain:r})}function Ry(t,e,{constant:n=1,...r}){return _n(t,fp().constant(n),e,r)}function Ty(t,e,{range:n,quantiles:r=n===void 0?5:(n=[...n]).length,n:i=r,scheme:o="rdylbu",domain:a=Yy(e),unknown:l,interpolate:s,reverse:u}){return n===void 0&&(n=s!==void 0?Bt(s,i):st.get(t)===oe?Tr(o,i):void 0),a.length>0&&(a=pp(a,n===void 0?{length:i}:n).quantiles()),wo(t,e,{domain:a,range:n,reverse:u,unknown:l})}function Iy(t,e,{range:n,n:r=n===void 0?5:(n=[...n]).length,scheme:i="rdylbu",domain:o=Qs(t,e),unknown:a,interpolate:l,reverse:s}){const[u,c]=yt(o);let d;return n===void 0?(d=Ei(u,c,r),d[0]<=u&&d.splice(0,1),d[d.length-1]>=c&&d.pop(),r=d.length+1,n=l!==void 0?Bt(l,r):st.get(t)===oe?Tr(i,r):void 0):(d=Bt(En(u,c),r+1).slice(1,-1),u instanceof Date&&(d=d.map(f=>new Date(f)))),Ve(ee(o))<0&&d.reverse(),wo(t,e,{domain:d,range:n,reverse:s,unknown:a})}function wo(t,e,{domain:n=[0],unknown:r,scheme:i="rdylbu",interpolate:o,range:a=o!==void 0?Bt(o,n.length+1):st.get(t)===oe?Tr(i,n.length+1):void 0,reverse:l}){n=ee(n);const s=Ve(n);if(!isNaN(s)&&!By(n,s))throw new Error(`the ${t} scale has a non-monotonic domain`);return l&&(a=pr(a)),{type:"threshold",scale:mp(s<0?pr(n):n,a===void 0?[]:a).unknown(r),domain:n,range:a}}function By(t,e){for(let n=1,r=t.length,i=t[0];n<r;++n){const o=_e(i,i=t[n]);if(o!==0&&o!==e)return!1}return!0}function Wy(t){return{type:"identity",scale:ey(st.get(t))?cp():e=>e}}function Gn(t,e=$r){return t.length?[Nt(t,({value:n})=>n===void 0?n:Nt(n,e)),zt(t,({value:n})=>n===void 0?n:zt(n,e))]:[0,1]}function Qs(t,e){const n=st.get(t);return(n===Fn||n===qn||n===Dn?jy:Gn)(e)}function jy(t){return[0,t.length?zt(t,({value:e})=>e===void 0?e:zt(e,$r)):1]}function Fy(t,e){const n=t.find(({radius:a})=>a!==void 0);if(n!==void 0)return[0,n.radius];const r=An(t,.5,({value:a})=>a===void 0?NaN:An(a,.25,Jt)),i=e.map(a=>3*Math.sqrt(a/r)),o=30/zt(i);return o<1?i.map(a=>a*o):i}function Dy(t,e){const n=Sn(t,({value:o})=>o===void 0?NaN:Sn(o,Math.abs)),r=e.map(o=>12*o/n),i=60/zt(r);return i<1?r.map(o=>o*i):r}function qy(t){for(const{value:e}of t)if(e!==void 0)for(let n of e){if(n>0)return Gn(t,Jt);if(n<0)return Gn(t,xr)}return[1,10]}function Yy(t){const e=[];for(const{value:n}of t)if(n!==void 0)for(const r of n)e.push(r);return e}function bo(t){return(e,n)=>r=>t(e+r*(n-e))}let vo=0,ko;function Py(){const t=vo;return vo=0,ko=void 0,t}function ue(t){t!==ko&&(ko=t,console.warn(t),++vo)}function Ir(t,e,n,r,{type:i,nice:o,clamp:a,domain:l=Gn(r),unknown:s,pivot:u=0,scheme:c,range:d,symmetric:f=!0,interpolate:h=st.get(t)===oe?c==null&&d!==void 0?Oi:$o(c!==void 0?c:"rdbu"):En,reverse:p}){u=+u,l=ee(l);let[m,x]=l;if(l.length>2&&ue(`Warning: the diverging ${t} scale domain contains extra elements.`),_e(m,x)<0&&([m,x]=[x,m],p=!p),m=Math.min(m,u),x=Math.max(x,u),typeof h!="function"&&(h=Zs(h)),d!==void 0&&(h=h.length===1?bo(h)(...d):Ci(h,d)),p&&(h=Hs(h)),f){const g=n.apply(u),y=g-n.apply(m),w=n.apply(x)-g;y<w?m=n.invert(g-w):y>w&&(x=n.invert(g+y))}return e.domain([m,u,x]).unknown(s).interpolator(h),a&&e.clamp(a),o&&e.nice(o),{type:i,domain:[m,x],pivot:u,interpolate:h,scale:e}}function Xy(t,e,n){return Ir(t,kp(),Hy,e,n)}function _y(t,e,n){return Js(t,e,{...n,exponent:.5})}function Js(t,e,{exponent:n=1,...r}){return Ir(t,vp().exponent(n=+n),Ky(n),e,{...r,type:"diverging-pow"})}function Gy(t,e,{base:n=10,pivot:r=1,domain:i=Gn(e,r<0?xr:Jt),...o}){return Ir(t,bp().base(n=+n),Uy,e,{domain:i,pivot:r,...o})}function Vy(t,e,{constant:n=1,...r}){return Ir(t,wp().constant(n=+n),Qy(n),e,r)}const Hy={apply(t){return t},invert(t){return t}},Uy={apply:Math.log,invert:Math.exp},Zy={apply(t){return Math.sign(t)*Math.sqrt(Math.abs(t))},invert(t){return Math.sign(t)*(t*t)}};function Ky(t){return t===.5?Zy:{apply(e){return Math.sign(e)*Math.pow(Math.abs(e),t)},invert(e){return Math.sign(e)*Math.pow(Math.abs(e),1/t)}}}function Qy(t){return{apply(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))},invert(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}}function tu(t,e,n,r){return _n(t,e,n,r)}function Jy(t,e,n){return tu(t,Mp(),e,n)}function tg(t,e,n){return tu(t,Ap(),e,n)}const Vn=Symbol("ordinal");function eu(t,e,n,{type:r,interval:i,domain:o,range:a,reverse:l,hint:s}){return i=Qe(i,r),o===void 0&&(o=ru(n,i,t)),(r==="categorical"||r===Vn)&&(r="ordinal"),l&&(o=pr(o)),o=e.domain(o).domain(),a!==void 0&&(typeof a=="function"&&(a=a(o)),e.range(a)),{type:r,domain:o,range:a,scale:e,hint:s,interval:i}}function eg(t,e,{type:n,interval:r,domain:i,range:o,scheme:a,unknown:l,...s}){r=Qe(r,n),i===void 0&&(i=ru(e,r,t));let u;if(st.get(t)===Er)u=ig(e),o=o===void 0?og(u):J(o,eo);else if(st.get(t)===oe&&(o===void 0&&(n==="ordinal"||n===Vn)&&(o=Ly(i,a),o!==void 0&&(a=void 0)),a===void 0&&o===void 0&&(a=n==="ordinal"?"turbo":"observable10"),a!==void 0))if(o!==void 0){const c=$o(a),d=o[0],f=o[1]-o[0];o=({length:h})=>Bt(p=>c(d+f*p),h)}else o=Gs(a);if(l===zp)throw new Error(`implicit unknown on ${t} scale is not supported`);return eu(t,Sp().unknown(l),e,{...s,type:n,domain:i,range:o,hint:u})}function ng(t,e,{align:n=.5,padding:r=.5,...i}){return nu(Lp().align(n).padding(r),e,i,t)}function rg(t,e,{align:n=.5,padding:r=.1,paddingInner:i=r,paddingOuter:o=t==="fx"||t==="fy"?0:r,...a}){return nu(Vl().align(n).paddingInner(i).paddingOuter(o),e,a,t)}function nu(t,e,n,r){let{round:i}=n;return i!==void 0&&t.round(i=!!i),t=eu(r,t,e,n),t.round=i,t}function ru(t,e,n){const r=new zn;for(const{value:i,domain:o}of t){if(o!==void 0)return o();if(i!==void 0)for(const a of i)r.add(a)}if(e!==void 0){const[i,o]=yt(r).map(e.floor,e);return e.range(i,e.offset(o))}if(r.size>1e4&&st.get(n)===Gt)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return ol(r,Rt)}function iu(t,e){let n;for(const{hint:r}of t){const i=r?.[e];if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}}return n}function ig(t){return{fill:iu(t,"fill"),stroke:iu(t,"stroke")}}function og(t){return lt(t.fill)?Ep:Op}function Mo(t,{label:e,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:o=n,insetLeft:a=n,round:l,nice:s,clamp:u,zero:c,align:d,padding:f,projection:h,facet:{label:p=e}={},...m}={}){const x={};for(const[g,y]of t){const w=m[g],$=du(g,y,{round:st.get(g)===Gt?l:void 0,nice:s,clamp:u,zero:c,align:d,padding:f,projection:h,...w});if($){let{label:v=g==="fx"||g==="fy"?p:e,percent:b,transform:k,inset:M,insetTop:A=M!==void 0?M:g==="y"?r:0,insetRight:z=M!==void 0?M:g==="x"?i:0,insetBottom:S=M!==void 0?M:g==="y"?o:0,insetLeft:L=M!==void 0?M:g==="x"?a:0}=w||{};if(k==null)k=void 0;else if(typeof k!="function")throw new Error("invalid scale transform; not a function");$.percent=!!b,$.label=v===void 0?lg(y,$):v,$.transform=k,g==="x"||g==="fx"?($.insetLeft=+L,$.insetRight=+z):(g==="y"||g==="fy")&&($.insetTop=+A,$.insetBottom=+S),x[g]=$}}return x}function ou(t){const e={},n={scales:e};for(const[r,i]of Object.entries(t)){const{scale:o,type:a,interval:l,label:s}=i;e[r]=yu(i),n[r]=o,o.type=a,l!=null&&(o.interval=l),s!=null&&(o.label=s)}return n}function ag(t,e){const{x:n,y:r,fx:i,fy:o}=t,a=i||o?Ao(e):e;i&&su(i,a),o&&uu(o,a);const l=i||o?lu(t,e):e;n&&su(n,l),r&&uu(r,l)}function lg(t=[],e){let n;for(const{label:r}of t)if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}if(n!==void 0)return!We(e)&&e.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function au(t){return Math.sign(Ve(t.domain()))*Math.sign(Ve(t.range()))}function Ao(t){const{marginTop:e,marginRight:n,marginBottom:r,marginLeft:i,width:o,height:a,facet:{marginTop:l,marginRight:s,marginBottom:u,marginLeft:c}}=t;return{marginTop:Math.max(e,l),marginRight:Math.max(n,s),marginBottom:Math.max(r,u),marginLeft:Math.max(i,c),width:o,height:a}}function lu({fx:t,fy:e},n){const{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:l,height:s}=Ao(n);return{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:t?t.scale.bandwidth()+a+i:l,height:e?e.scale.bandwidth()+r+o:s,facet:{width:l,height:s}}}function su(t,e){if(t.range===void 0){const{insetLeft:n,insetRight:r}=t,{width:i,marginLeft:o=0,marginRight:a=0}=e,l=o+n,s=i-a-r;t.range=[l,Math.max(l,s)],We(t)||(t.range=fu(t)),t.scale.range(t.range)}cu(t)}function uu(t,e){if(t.range===void 0){const{insetTop:n,insetBottom:r}=t,{height:i,marginTop:o=0,marginBottom:a=0}=e,l=o+n,s=i-a-r;t.range=[Math.max(l,s),l],We(t)?t.range.reverse():t.range=fu(t),t.scale.range(t.range)}cu(t)}function cu(t){t.round===void 0&&cg(t)&&sg(t)<=30&&t.scale.round(!0)}function sg({scale:t}){const e=t.domain().length,[n,r]=t.range(),i=t.paddingInner?t.paddingInner():1,o=t.paddingOuter?t.paddingOuter():t.padding(),a=e-i,l=Math.abs(r-n)/Math.max(1,a+o*2);return(l-Math.floor(l))*a}function fu(t){const e=t.scale.domain().length+mu(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},(i,o)=>n+o/(e-1)*(r-n))}function Lo(t,e,n){return du(t,n===void 0?void 0:[{hint:n}],{...e})}function du(t,e=[],n={}){const r=ug(t,e,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&t!=="fx"&&t!=="fy"&&We({type:r})){const i=e.map(({value:o})=>o).filter(o=>o!==void 0);i.some(At)?ue(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${rn(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${rn(r)}".`):i.some(Gm)?ue(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${rn(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${rn(r)}".`):i.some(Vm)&&ue(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${rn(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${rn(r)}".`)}switch(n.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=Br(e,n,St);break;case"identity":switch(st.get(t)){case Gt:n=Br(e,n,St);break;case Er:n=Br(e,n,fg);break}break;case"utc":case"time":n=Br(e,n,cs);break}switch(r){case"diverging":return Xy(t,e,n);case"diverging-sqrt":return _y(t,e,n);case"diverging-pow":return Js(t,e,n);case"diverging-log":return Gy(t,e,n);case"diverging-symlog":return Vy(t,e,n);case"categorical":case"ordinal":case Vn:return eg(t,e,n);case"cyclical":case"sequential":case"linear":return Oy(t,e,n);case"sqrt":return Cy(t,e,n);case"threshold":return wo(t,e,n);case"quantile":return Ty(t,e,n);case"quantize":return Iy(t,e,n);case"pow":return Ks(t,e,n);case"log":return Ny(t,e,n);case"symlog":return Ry(t,e,n);case"utc":return tg(t,e,n);case"time":return Jy(t,e,n);case"point":return ng(t,e,n);case"band":return rg(t,e,n);case"identity":return Wy(t);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function rn(t){return typeof t=="symbol"?t.description:t}function hu(t){return typeof t=="string"?`${t}`.toLowerCase():t}const pu={toString:()=>"projection"};function ug(t,e,{type:n,domain:r,range:i,scheme:o,pivot:a,projection:l}){if(n=hu(n),t==="fx"||t==="fy")return"band";(t==="x"||t==="y")&&l!=null&&(n=pu);for(const u of e){const c=hu(u.type);if(c!==void 0){if(n===void 0)n=c;else if(n!==c)throw new Error(`scale incompatible with channel: ${n} !== ${c}`)}}if(n===pu)return;if(n!==void 0)return n;if(r===void 0&&!e.some(({value:u})=>u!==void 0))return;const s=st.get(t);if(s===Fn)return"sqrt";if(s===qn||s===Dn)return"linear";if(s===Er)return"ordinal";if((r||i||[]).length>2)return zo(s);if(r!==void 0){if(ut(r))return zo(s);if(At(r))return"utc"}else{const u=e.map(({value:c})=>c).filter(c=>c!==void 0);if(u.some(ut))return zo(s);if(u.some(At))return"utc"}if(s===oe){if(a!=null||Sy(o))return"diverging";if(Ay(o))return"categorical"}return"linear"}function zo(t){switch(t){case Gt:return"point";case oe:return Vn;default:return"ordinal"}}function We({type:t}){return t==="ordinal"||t==="point"||t==="band"||t===Vn}function mu({type:t}){return t==="threshold"}function cg({type:t}){return t==="point"||t==="band"}function Vt(t){if(t===void 0)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,i=e.length;r<i;++r)if(t(e[r])-n)return!1;return!0}function Br(t,{domain:e,...n},r){for(const i of t)i.value!==void 0&&(e===void 0&&(e=i.value?.domain),i.value=r(i.value));return{domain:e===void 0?e:r(e),...n}}function fg(t){return J(t,eo)}function dg(t={}){let e;for(const n in t)if(st.has(n)&&Te(t[n])){if(e!==void 0)throw new Error("ambiguous scale definition; multiple scales found");e=yu(Lo(n,t[n]))}if(e===void 0)throw new Error("invalid scale definition; no scale found");return e}function hg(t){return e=>{if(!st.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return t[e]}}function yu({scale:t,type:e,domain:n,range:r,interpolate:i,interval:o,transform:a,percent:l,pivot:s}){if(e==="identity")return{type:"identity",apply:c=>c,invert:c=>c};const u=t.unknown?t.unknown():void 0;return{type:e,domain:In(n),...r!==void 0&&{range:In(r)},...a!==void 0&&{transform:a},...l&&{percent:l},...u!==void 0&&{unknown:u},...o!==void 0&&{interval:o},...i!==void 0&&{interpolate:i},...t.clamp&&{clamp:t.clamp()},...s!==void 0&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:c=>t(c),...t.invert&&{invert:c=>t.invert(c)}}}function pg(t,e){const{fx:n,fy:r}=Mo(t,e),i=n?.scale.domain(),o=r?.scale.domain();return i&&o?Cp(i,o).map(([a,l],s)=>({x:a,y:l,i:s})):i?i.map((a,l)=>({x:a,i:l})):o?o.map((a,l)=>({y:a,i:l})):void 0}function mg(t,{x:e,y:n}){return e&&=Eo(e),n&&=Eo(n),t.filter(e&&n?r=>e.has(r.x)&&n.has(r.y):e?r=>e.has(r.x):r=>n.has(r.y)).sort(e&&n?(r,i)=>e.get(r.x)-e.get(i.x)||n.get(r.y)-n.get(i.y):e?(r,i)=>e.get(r.x)-e.get(i.x):(r,i)=>n.get(r.y)-n.get(i.y))}function So(t,{fx:e,fy:n}){const r=ne(t),i=e?.value,o=n?.value;return e&&n?Ln(r,a=>(a.fx=i[a[0]],a.fy=o[a[0]],a),a=>i[a],a=>o[a]):e?Ln(r,a=>(a.fx=i[a[0]],a),a=>i[a]):Ln(r,a=>(a.fy=o[a[0]],a),a=>o[a])}function yg(t,e,{marginTop:n,marginLeft:r}){return t&&e?({x:i,y:o})=>`translate(${t(i)-r},${e(o)-n})`:t?({x:i})=>`translate(${t(i)-r},0)`:({y:i})=>`translate(0,${e(i)-n})`}function gg(t){const e=[],n=new Uint32Array(qt(t,r=>r.length));for(const r of t){let i=0;for(const o of t)r!==o&&(n.set(o,i),i+=o.length);e.push(n.slice(0,i))}return e}const $g=new Map([["top",Oo],["right",Ro],["bottom",Co],["left",No],["top-left",jr(Oo,No)],["top-right",jr(Oo,Ro)],["bottom-left",jr(Co,No)],["bottom-right",jr(Co,Ro)],["top-empty",bg],["right-empty",Mg],["bottom-empty",vg],["left-empty",kg],["empty",Ag]]);function xg(t){if(t==null)return null;const e=$g.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid facet anchor: ${t}`)}const gu=new WeakMap;function Eo(t){let e=gu.get(t);return e||gu.set(t,e=new Ni(J(t,(n,r)=>[n,r]))),e}function we(t,e){return Eo(t).get(e)}function wg(t,e,n){return e=re(e),n=re(n),t.find(r=>Object.is(re(r.x),e)&&Object.is(re(r.y),n))}function Wr(t,e,n){return wg(t,e,n)?.empty}function Oo(t,{y:e},{y:n}){return e?we(e,n)===0:!0}function Co(t,{y:e},{y:n}){return e?we(e,n)===e.length-1:!0}function No(t,{x:e},{x:n}){return e?we(e,n)===0:!0}function Ro(t,{x:e},{x:n}){return e?we(e,n)===e.length-1:!0}function bg(t,{y:e},{x:n,y:r,empty:i}){if(i)return!1;if(!e)return;const o=we(e,r);if(o>0)return Wr(t,n,e[o-1])}function vg(t,{y:e},{x:n,y:r,empty:i}){if(i)return!1;if(!e)return;const o=we(e,r);if(o<e.length-1)return Wr(t,n,e[o+1])}function kg(t,{x:e},{x:n,y:r,empty:i}){if(i)return!1;if(!e)return;const o=we(e,n);if(o>0)return Wr(t,e[o-1],r)}function Mg(t,{x:e},{x:n,y:r,empty:i}){if(i)return!1;if(!e)return;const o=we(e,n);if(o<e.length-1)return Wr(t,e[o+1],r)}function Ag(t,e,{empty:n}){return n}function jr(t,e){return function(){return t.apply(null,arguments)&&e.apply(null,arguments)}}function To(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map(({x:i,y:o})=>r.get(i)?.get(o)??[]):e?t.map(({x:i})=>r.get(i)??[]):t.map(({y:i})=>r.get(i)??[])}const $u=Math.PI,ce=2*$u,Io=.618;function Lg({projection:t,inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e}={},a){if(t==null)return;if(typeof t.stream=="function")return t;let l,s,u="frame";if(Tt(t)){let v;if({type:t,domain:s,inset:v,insetTop:n=v!==void 0?v:n,insetRight:r=v!==void 0?v:r,insetBottom:i=v!==void 0?v:i,insetLeft:o=v!==void 0?v:o,clip:u=u,...l}=t,t==null)return}typeof t!="function"&&({type:t}=Bo(t));const{width:c,height:d,marginLeft:f,marginRight:h,marginTop:p,marginBottom:m}=a,x=c-f-h-o-r,g=d-p-m-n-i;if(t=t?.({width:x,height:g,clip:u,...l}),t==null)return;u=zg(u,f,p,c-h,d-m);let y=f+o,w=p+n,$;if(s!=null){const[[v,b],[k,M]]=Kt(t).bounds(s),A=Math.min(x/(k-v),g/(M-b));A>0?(y-=(A*(v+k)-x)/2,w-=(A*(b+M)-g)/2,$=mr({point(z,S){this.stream.point(z*A+y,S*A+w)}})):ue("Warning: the projection could not be fit to the specified domain; using the default scale.")}return $??=y===0&&w===0?xu():mr({point(v,b){this.stream.point(v+y,b+w)}}),{stream:v=>t.stream($.stream(u(v)))}}function Bo(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Ft(Vp,.7463,.4673);case"albers":return Fr(Gp,.7463,.4673);case"azimuthal-equal-area":return Ft(_p,4,4);case"azimuthal-equidistant":return Ft(Xp,ce,ce);case"conic-conformal":return Fr(Pp,ce,ce);case"conic-equal-area":return Fr(Yp,6.1702,2.9781);case"conic-equidistant":return Fr(qp,7.312,3.6282);case"equal-earth":return Ft(Dp,5.4133,2.6347);case"equirectangular":return Ft(Fp,ce,$u);case"gnomonic":return Ft(jp,3.4641,3.4641);case"identity":return{type:xu};case"reflect-y":return{type:Sg};case"mercator":return Ft(Wp,ce,ce);case"orthographic":return Ft(Bp,2,2);case"stereographic":return Ft(Ip,2,2);case"transverse-mercator":return Ft(Tp,ce,ce);default:throw new Error(`unknown projection type: ${t}`)}}function zg(t,e,n,r,i){if(t===!1||t==null||typeof t=="number")return o=>o;switch(t===!0&&(t="frame"),`${t}`.toLowerCase()){case"frame":return Rp(e,n,r,i);default:throw new Error(`unknown projection clip type: ${t}`)}}function Ft(t,e,n){return{type:({width:r,height:i,rotate:o,precision:a=.15,clip:l})=>{const s=t();return a!=null&&s.precision?.(a),o!=null&&s.rotate?.(o),typeof l=="number"&&s.clipAngle?.(l),r!=null&&(s.scale(Math.min(r/e,i/n)),s.translate([r/2,i/2])),s},aspectRatio:n/e}}function Fr(t,e,n){const{type:r,aspectRatio:i}=Ft(t,e,n);return{type:o=>{const{parallels:a,domain:l,width:s,height:u}=o,c=r(o);return a!=null&&(c.parallels(a),l===void 0&&s!=null&&c.fitSize([s,u],{type:"Sphere"})),c},aspectRatio:i}}const xu=wt({stream:t=>t}),Sg=wt(mr({point(t,e){this.stream.point(t,-e)}}));function wu(t,e,n,r){const i=n[t],o=n[e],a=i.length,l=n[t]=new Float64Array(a).fill(NaN),s=n[e]=new Float64Array(a).fill(NaN);let u;const c=r.stream({point(d,f){l[u]=d,s[u]=f}});for(u=0;u<a;++u)c.point(i[u],o[u])}function Eg({projection:t}={}){return t==null?!1:typeof t.stream=="function"?!0:(Tt(t)&&(t=t.type),t!=null)}function Og(t){if(typeof t?.stream=="function")return Io;if(Tt(t)){let e,n;if({domain:e,type:t,...n}=t,e!=null&&t!=null){const r=typeof t=="string"?Bo(t).type:t,[[i,o],[a,l]]=Kt(r({...n,width:100,height:100})).bounds(e),s=(l-o)/(a-i);return s&&isFinite(s)?s<.2?.2:s>5?5:s:Io}}if(t!=null){if(typeof t!="function"){const{aspectRatio:e}=Bo(t);if(e)return e}return Io}}function Hn(t,e,{projection:n}){const{x:r,y:i}=t;let o={};return r&&(o.x=r),i&&(o.y=i),o=mo(o,e),n&&r?.scale==="x"&&i?.scale==="y"&&wu("x","y",o,n),r&&(o.x=St(o.x)),i&&(o.y=St(o.y)),o}function Cg(t){const e=[],n=[],r={scale:"x",value:e},i={scale:"y",value:n},o={point(a,l){e.push(a),n.push(l)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const a of t.value)Np(a,o);return[r,i]}function Dr(t={}){const{document:e=typeof window<"u"?window.document:void 0,clip:n}=t;return{document:e,clip:ws(n)}}function U(t,{document:e}){return he(Hl(t).call(e.documentElement))}const Wo=Symbol("unset");function on(t){return(t.length===1?Ng:Rg)(t)}function Ng(t){let e,n=Wo;return r=>(Object.is(n,r)||(n=r,e=t(r)),e)}function Rg(t){let e,n;return(...r)=>((n?.length!==r.length||n.some((i,o)=>!Object.is(i,r[o])))&&(n=r,e=t(...r)),e)}const Tg=on(t=>new Intl.NumberFormat(t)),Ig=on((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}})),Bg=on((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}}));function bu(t="en-US"){const e=Tg(t);return n=>n!=null&&!isNaN(n)?e.format(n):void 0}function Wg(t="en-US",e="short"){const n=Ig(t,e);return r=>r!=null&&!isNaN(r=+new Date(Date.UTC(2e3,+r)))?n.format(r):void 0}function jg(t="en-US",e="short"){const n=Bg(t,e);return r=>r!=null&&!isNaN(r=+new Date(Date.UTC(2001,0,+r)))?n.format(r):void 0}function vu(t){return Om(t,"Invalid Date")}function Fg(t="en-US"){const e=bu(t);return n=>(n instanceof Date?vu:typeof n=="number"?e:kt)(n)}const an=Fg(),bt=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let Dg=0,qg=0;function ku(){return`plot-clip-${++Dg}`}function Yg(){return`plot-pattern-${++qg}`}function Mu(t,{title:e,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:o,target:a,fill:l,fillOpacity:s,stroke:u,strokeWidth:c,strokeOpacity:d,strokeLinejoin:f,strokeLinecap:h,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:x,opacity:g,mixBlendMode:y,imageFilter:w,paintOrder:$,pointerEvents:v,shapeRendering:b,channels:k},{ariaLabel:M,fill:A="currentColor",fillOpacity:z,stroke:S="none",strokeOpacity:L,strokeWidth:C,strokeLinecap:E,strokeLinejoin:O,strokeMiterlimit:R,paintOrder:N}){A===null&&(l=null,s=null),S===null&&(u=null,d=null),lt(A)?!lt(S)&&(!lt(l)||k?.fill)&&(S="none"):lt(S)&&(!lt(u)||k?.stroke)&&(A="none");const[F,T]=Mt(l,A),[B,j]=dt(s,z),[I,Y]=Mt(u,S),[H,G]=dt(d,L),[X,W]=dt(g);nn(Y)||(c===void 0&&(c=C),h===void 0&&(h=E),f===void 0&&(f=O),p===void 0&&!Zm(f)&&(p=R),!nn(T)&&$===void 0&&($=N));const[P,_]=dt(c);return A!==null&&(t.fill=pt(T,"currentColor"),t.fillOpacity=Un(j,1)),S!==null&&(t.stroke=pt(Y,"none"),t.strokeWidth=Un(_,1),t.strokeOpacity=Un(G,1),t.strokeLinejoin=pt(f,"miter"),t.strokeLinecap=pt(h,"butt"),t.strokeMiterlimit=Un(p,4),t.strokeDasharray=pt(m,"none"),t.strokeDashoffset=pt(x,"0")),t.target=kt(a),t.ariaLabel=kt(M),t.ariaDescription=kt(i),t.ariaHidden=kt(o),t.opacity=Un(W,1),t.mixBlendMode=pt(y,"normal"),t.imageFilter=pt(w,"none"),t.paintOrder=pt($,"normal"),t.pointerEvents=pt(v,"auto"),t.shapeRendering=pt(b,"auto"),{title:{value:e,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:F,scale:"auto",optional:!0},fillOpacity:{value:B,scale:"auto",optional:!0},stroke:{value:I,scale:"auto",optional:!0},strokeOpacity:{value:H,scale:"auto",optional:!0},strokeWidth:{value:P,optional:!0},opacity:{value:X,scale:"auto",optional:!0}}}function Pg(t,e){e&&t.filter(n=>ji(e[n])).append("title").call(_g,e)}function Xg(t,e){e&&t.filter(([n])=>ji(e[n])).append("title").call(Gg,e)}function _g(t,e){e&&t.text(n=>an(e[n]))}function Gg(t,e){e&&t.text(([n])=>an(e[n]))}function ct(t,{target:e,tip:n},{ariaLabel:r,title:i,fill:o,fillOpacity:a,stroke:l,strokeOpacity:s,strokeWidth:u,opacity:c,href:d}){r&&q(t,"aria-label",f=>r[f]),o&&q(t,"fill",f=>o[f]),a&&q(t,"fill-opacity",f=>a[f]),l&&q(t,"stroke",f=>l[f]),s&&q(t,"stroke-opacity",f=>s[f]),u&&q(t,"stroke-width",f=>u[f]),c&&q(t,"opacity",f=>c[f]),d&&zu(t,f=>d[f],e),n||Pg(t,i)}function qr(t,{target:e,tip:n},{ariaLabel:r,title:i,fill:o,fillOpacity:a,stroke:l,strokeOpacity:s,strokeWidth:u,opacity:c,href:d}){r&&q(t,"aria-label",([f])=>r[f]),o&&q(t,"fill",([f])=>o[f]),a&&q(t,"fill-opacity",([f])=>a[f]),l&&q(t,"stroke",([f])=>l[f]),s&&q(t,"stroke-opacity",([f])=>s[f]),u&&q(t,"stroke-width",([f])=>u[f]),c&&q(t,"opacity",([f])=>c[f]),d&&zu(t,([f])=>d[f],e),n||Xg(t,i)}function Vg({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:i,strokeOpacity:o,strokeWidth:a,opacity:l,href:s},{tip:u}){return[t,u?void 0:e,n,r,i,o,a,l,s].filter(c=>c!==void 0)}function jo(t,e,n){const r=Ce(t,i=>e[i]);return n===void 0&&r.size>1+t.length>>1&&ue("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*Au(t,e,n,r){const{z:i}=n,{z:o}=r,a=Vg(r,n),l=[...e,...a];for(const s of o?jo(t,o,i):[t]){let u,c;t:for(const d of s){for(const f of l)if(!xt(f[d])){c&&c.push(-1);continue t}if(u===void 0){c&&(yield c),u=a.map(f=>re(f[d])),c=[d];continue}c.push(d);for(let f=0;f<a.length;++f)if(re(a[f][d])!==u[f]){yield c,u=a.map(h=>re(h[d])),c=[d];continue t}}c&&(yield c)}}function Hg(t,e,n,r){let i;const{clip:o=r.clip}=e;switch(o){case"frame":{t=U("svg:g",r).each(function(){this.appendChild(t.node()),t.node=()=>this}),i=Ug(r,n);break}case"sphere":{i=Zg(r);break}}q(t,"aria-label",e.ariaLabel),q(t,"aria-description",e.ariaDescription),q(t,"aria-hidden",e.ariaHidden),q(t,"clip-path",i)}function Lu(t){const e=new WeakMap;return(n,r)=>{let i=e.get(n);if(!i){const o=ku();he(n.ownerSVGElement).append("clipPath").attr("id",o).call(t,n,r),e.set(n,i=`url(#${o})`)}return i}}const Ug=Lu((t,e,n)=>{const{width:r,height:i,marginLeft:o,marginRight:a,marginTop:l,marginBottom:s}=n;t.append("rect").attr("x",o).attr("y",l).attr("width",r-a-o).attr("height",i-l-s)}),Zg=Lu((t,e)=>{const{projection:n}=e;if(!n)throw new Error('the "sphere" clip option requires a projection');t.append("path").attr("d",Kt(n)({type:"Sphere"}))});function ot(t,e,n,r){Hg(t,e,n,r),q(t,"class",e.className),q(t,"fill",e.fill),q(t,"fill-opacity",e.fillOpacity),q(t,"stroke",e.stroke),q(t,"stroke-width",e.strokeWidth),q(t,"stroke-opacity",e.strokeOpacity),q(t,"stroke-linejoin",e.strokeLinejoin),q(t,"stroke-linecap",e.strokeLinecap),q(t,"stroke-miterlimit",e.strokeMiterlimit),q(t,"stroke-dasharray",e.strokeDasharray),q(t,"stroke-dashoffset",e.strokeDashoffset),q(t,"shape-rendering",e.shapeRendering),q(t,"filter",e.imageFilter),q(t,"paint-order",e.paintOrder);const{pointerEvents:i=r.pointerSticky===!1?"none":void 0}=e;q(t,"pointer-events",i)}function Q(t,e){Kg(t,"mix-blend-mode",e.mixBlendMode),q(t,"opacity",e.opacity)}function zu(t,e,n){t.each(function(r){const i=e(r);if(i!=null){const o=this.ownerDocument.createElementNS(Ne.svg,"a");o.setAttribute("fill","inherit"),o.setAttributeNS(Ne.xlink,"href",i),n!=null&&o.setAttribute("target",n),this.parentNode.insertBefore(o,this).appendChild(this)}})}function q(t,e,n){n!=null&&t.attr(e,n)}function Kg(t,e,n){n!=null&&t.style(e,n)}function tt(t,e,{x:n,y:r},i=bt,o=bt){i+=e.dx,o+=e.dy,n?.bandwidth&&(i+=n.bandwidth()/2),r?.bandwidth&&(o+=r.bandwidth()/2),(i||o)&&t.attr("transform",`translate(${i},${o})`)}function pt(t,e){if((t=kt(t))!==e)return t}function Un(t,e){if((t=rt(t))!==e)return t}const Qg=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Yr(t){if(t===void 0)return"plot-d6a7b5";if(t=`${t}`,!Qg.test(t))throw new Error(`invalid class name: ${t}`);return t}function Fo(t,e){if(typeof e=="string")t.property("style",e);else if(e!=null)for(const n of t)Object.assign(n.style,e)}function Ht({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:i,marginBottom:o,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-i:(a+e-i)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-o:(r+n-o)/2]}let et=class{constructor(e,n={},r={},i){const{facet:o="auto",facetAnchor:a,fx:l,fy:s,sort:u,dx:c=0,dy:d=0,margin:f=0,marginTop:h=f,marginRight:p=f,marginBottom:m=f,marginLeft:x=f,className:g,clip:y=i?.clip,channels:w,tip:$,render:v}=r;if(this.data=e,this.sort=ge(u)?u:null,this.initializer=Lt(r).initializer,this.transform=this.initializer?r.transform:jt(r).transform,o===null||o===!1?this.facet=null:(this.facet=Ot(o===!0?"include":o,"facet",["auto","include","exclude","super"]),this.fx=e===Rn&&typeof l=="string"?[l]:l,this.fy=e===Rn&&typeof s=="string"?[s]:s),this.facetAnchor=xg(a),n=Qi(n),w!==void 0&&(n={...Jg(w),...n}),i!==void 0&&(n={...Mu(this,r,i),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([b,k])=>{if(Xt(k.value)){const{value:M,label:A=k.label,scale:z=k.scale}=k.value;k={...k,label:A,scale:z,value:M}}if(e===Rn&&typeof k.value=="string"){const{value:M}=k;k={...k,value:[M]}}return[b,k]}).filter(([b,{value:k,optional:M}])=>{if(k!=null)return!0;if(M)return!1;throw new Error(`missing channel value: ${b}`)})),this.dx=+c,this.dy=+d,this.marginTop=+h,this.marginRight=+p,this.marginBottom=+m,this.marginLeft=+x,this.clip=ws(y),this.tip=t$($),this.className=g?Yr(g):null,this.facet==="super"){if(l||s)throw new Error("super-faceting cannot use fx or fy");for(const b in this.channels){const{scale:k}=n[b];if(!(k!=="x"&&k!=="y"))throw new Error("super-faceting cannot use x or y")}}v!=null&&(this.render=ln(v,this.render))}initialize(e,n,r){let i=Ze(this.data);e===void 0&&i!=null&&(e=[ne(i)]);const o=e;this.transform!=null&&({facets:e,data:i}=this.transform(i,e,r),i=Ze(i)),e!==void 0&&(e.original=o);const a=Ws(this.channels,i);return this.sort!=null&&by(i,e,a,n,this.sort),{data:i,facets:e,channels:a}}filter(e,n,r){for(const i in n){const{filter:o=xt}=n[i];if(o!==null){const a=r[i];e=e.filter(l=>o(a[l]))}}return e}project(e,n,r){for(const i in e)if(e[i].scale==="x"&&/^x|x$/.test(i)){const o=i.replace(/^x|x$/,"y");o in e&&e[o].scale==="y"&&wu(i,o,n,r.projection)}}scale(e,n,r){const i=mo(e,n);return r.projection&&this.project(e,i,r),i}};function It(...t){return t.plot=et.prototype.plot,t}function ln(t,e){if(t==null)return e===null?void 0:e;if(e==null)return t===null?void 0:t;if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);return function(n,r,i,o,a,l){return t.call(this,n,r,i,o,a,(s,u,c,d,f)=>e.call(this,s,u,c,d,f,l))}}function Jg(t){return Object.fromEntries(Object.entries(Qi(t)).map(([e,n])=>(n=typeof n=="string"?{value:n,label:e}:tn(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[e,n])))}function t$(t){return t===!0?"xy":t===!1||t==null?null:typeof t=="string"?Ot(t,"tip",["x","y","xy"]):t}function je(t,e){return t?.tip===!0?{...t,tip:e}:Tt(t?.tip)&&t.tip.pointer===void 0?{...t,tip:{...t.tip,pointer:e}}:t}function e$(t,e,n={}){let r=.5-bt,i=.5+bt,o=.5+bt,a=.5-bt;for(const{marginTop:m,marginRight:x,marginBottom:g,marginLeft:y}of e)m>r&&(r=m),x>i&&(i=x),g>o&&(o=g),y>a&&(a=y);let{margin:l,marginTop:s=l!==void 0?l:r,marginRight:u=l!==void 0?l:i,marginBottom:c=l!==void 0?l:o,marginLeft:d=l!==void 0?l:a}=n;s=+s,u=+u,c=+c,d=+d;let{width:f=640,height:h=n$(t,n,{width:f,marginTopDefault:r,marginRightDefault:i,marginBottomDefault:o,marginLeftDefault:a})+Math.max(0,s-r+c-o)}=n;f=+f,h=+h;const p={width:f,height:h,marginTop:s,marginRight:u,marginBottom:c,marginLeft:d};if(t.fx||t.fy){let{margin:m,marginTop:x=m!==void 0?m:s,marginRight:g=m!==void 0?m:u,marginBottom:y=m!==void 0?m:c,marginLeft:w=m!==void 0?m:d}=n.facet??{};x=+x,g=+g,y=+y,w=+w,p.facet={marginTop:x,marginRight:g,marginBottom:y,marginLeft:w}}return p}function n$({x:t,y:e,fy:n,fx:r},{projection:i,aspectRatio:o},{width:a,marginTopDefault:l,marginRightDefault:s,marginBottomDefault:u,marginLeftDefault:c}){const d=n&&n.scale.domain().length||1,f=Og(i);if(f){const p=r?r.scale.domain().length:1,m=(1.1*d-.1)/(1.1*p-.1)*f,x=Math.max(.1,Math.min(10,m));return Math.round((a-c-s)*x+l+u)}const h=e?We(e)?e.scale.domain().length||1:Math.max(7,17/d):1;if(o!=null){if(o=+o,!(isFinite(o)&&o>0))throw new Error(`invalid aspectRatio: ${o}`);const p=Su("y",e)/(Su("x",t)*o),m=r?r.scale.bandwidth():1,x=n?n.scale.bandwidth():1,g=m*(a-c-s)-t.insetLeft-t.insetRight;return(p*g+e.insetTop+e.insetBottom)/x+l+u}return!!(e||n)*Math.max(1,Math.min(60,h*d))*20+!!r*30+60}function Su(t,e){if(!e)throw new Error(`aspectRatio requires ${t} scale`);const{type:n,domain:r}=e;let i;switch(n){case"linear":case"utc":case"time":i=Number;break;case"pow":{const l=e.scale.exponent();i=s=>Math.pow(s,l);break}case"log":i=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${n}`)}const[o,a]=yt(r);return Math.abs(i(a)-i(o))}const Eu=new WeakMap;function Do(t,e,{x:n,y:r,px:i,py:o,maxRadius:a=40,channels:l,render:s,...u}={}){return a=+a,i!=null&&(n??=null,l={...l,px:{value:i,scale:"x"}}),o!=null&&(r??=null,l={...l,py:{value:o,scale:"y"}}),{x:n,y:r,channels:l,...u,render:ln(function(c,d,f,h,p,m){p={...p,pointerSticky:!1};const x=p.ownerSVGElement,{data:g}=p.getMarkState(this);let y=Eu.get(x);y||Eu.set(x,y={sticky:!1,roots:[],renders:[]});let w=y.renders.push(Y)-1;const{x:$,y:v,fx:b,fy:k}=d;let M=b?b(c.fx)-h.marginLeft:0,A=k?k(c.fy)-h.marginTop:0;$?.bandwidth&&(M+=$.bandwidth()/2),v?.bandwidth&&(A+=v.bandwidth()/2);const z=c.fi!=null;let S;if(z){let W=y.facetStates;W||(y.facetStates=W=new Map),S=W.get(this),S||W.set(this,S=new Map)}const[L,C]=Ht(this,h),{px:E,py:O}=f,R=E?W=>E[W]:Ou(f,L),N=O?W=>O[W]:Cu(f,C);let F,T,B,j;function I(W,P){if(z)if(j&&(j=cancelAnimationFrame(j)),W==null)S.delete(c.fi);else{S.set(c.fi,P),j=requestAnimationFrame(()=>{j=null;for(const[_,Z]of S)if(Z<P||Z===P&&_<c.fi){W=null;break}Y(W)});return}Y(W)}function Y(W){if(F===W&&B===y.sticky)return;F=W,B=p.pointerSticky=y.sticky;const P=F==null?[]:[F];z&&(P.fx=c.fx,P.fy=c.fy,P.fi=c.fi);const _=m(P,d,f,h,p);if(T){if(z){const Z=T.parentNode,K=T.getAttribute("transform"),nt=_.getAttribute("transform");K?_.setAttribute("transform",K):_.removeAttribute("transform"),nt?Z.setAttribute("transform",nt):Z.removeAttribute("transform"),_.removeAttribute("aria-label"),_.removeAttribute("aria-description"),_.removeAttribute("aria-hidden")}T.replaceWith(_)}if(y.roots[w]=T=_,!(F==null&&S?.size>1)){const Z=F==null?null:te(g)?g[F]:g.get(F);p.dispatchValue(Z)}return _}function H(W){if(y.sticky||W.pointerType==="mouse"&&W.buttons===1)return;let[P,_]=Hp(W);P-=M,_-=A;const Z=P<h.marginLeft||P>h.width-h.marginRight?1:t,K=_<h.marginTop||_>h.height-h.marginBottom?1:e;let nt=null,ft=a*a;for(const at of c){const ht=Z*(R(at)-P),mt=K*(N(at)-_),vt=ht*ht+mt*mt;vt<=ft&&(nt=at,ft=vt)}if(nt!=null&&(t!==1||e!==1)){const at=R(nt)-P,ht=N(nt)-_;ft=at*at+ht*ht}I(nt,ft)}function G(W){W.pointerType==="mouse"&&F!=null&&(y.sticky&&y.roots.some(P=>P?.contains(W.target))||(y.sticky?(y.sticky=!1,y.renders.forEach(P=>P(null))):(y.sticky=!0,Y(F)),W.stopImmediatePropagation()))}function X(W){W.pointerType==="mouse"&&(y.sticky||I(null))}return x.addEventListener("pointerenter",H),x.addEventListener("pointermove",H),x.addEventListener("pointerdown",G),x.addEventListener("pointerleave",X),Y(null)},s)}}function qo(t){return Do(1,1,t)}function Yo(t){return Do(1,.01,t)}function Pr(t){return Do(.01,1,t)}function Ou({x1:t,x2:e,x:n=t},r){return t&&e?i=>(t[i]+e[i])/2:n?i=>n[i]:()=>r}function Cu({y1:t,y2:e,y:n=t},r){return t&&e?i=>(t[i]+e[i])/2:n?i=>n[i]:()=>r}function Nu(t){return We(t)&&t.interval===void 0?void 0:"tabular-nums"}function r$(t,e){let{label:n=t.label,tickSize:r=6,width:i=240,height:o=44+r,marginTop:a=18,marginRight:l=0,marginBottom:s=16+r,marginLeft:u=0,style:c,ticks:d=(i-u-l)/64,tickFormat:f,fontVariant:h=Nu(t),round:p=!0,opacity:m,className:x}=e;const g=Dr(e);x=Yr(x),m=dt(m)[1],f===null&&(f=()=>null);const y=U("svg",g).attr("class",`${x}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",o).attr("viewBox",`0 0 ${i} ${o}`).call(L=>L.append("style").text(`:where(.${x}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${x}-ramp text) {
  white-space: pre;
}`)).call(Fo,c);let w=L=>L.selectAll(".tick line").attr("y1",a+s-o),$;const v=p?(L,C)=>L.rangeRound(C):(L,C)=>L.range(C),{type:b,domain:k,range:M,interpolate:A,scale:z,pivot:S}=t;if(A){const L=M===void 0?A:Ci(A.length===1?bo(A):A,M);$=v(z.copy(),Bt(En(u,i-l),Math.min(k.length+(S!==void 0),M===void 0?1/0:M.length)));const C=256,E=g.document.createElement("canvas");E.width=C,E.height=1;const O=E.getContext("2d");for(let R=0,N=C-1;R<C;++R)O.fillStyle=L(R/N),O.fillRect(R,0,1,1);y.append("image").attr("opacity",m).attr("x",u).attr("y",a).attr("width",i-u-l).attr("height",o-a-s).attr("preserveAspectRatio","none").attr("xlink:href",E.toDataURL())}else if(b==="threshold"){const L=k,C=f===void 0?E=>E:typeof f=="string"?Ri(f):f;$=v(Gl().domain([-1,M.length-1]),[u,i-l]),y.append("g").attr("fill-opacity",m).selectAll().data(M).enter().append("rect").attr("x",(E,O)=>$(O-1)).attr("y",a).attr("width",(E,O)=>$(O)-$(O-1)).attr("height",o-a-s).attr("fill",E=>E),d=J(L,(E,O)=>O),f=E=>C(L[E],E)}else $=v(Vl().domain(k),[u,i-l]),y.append("g").attr("fill-opacity",m).selectAll().data(k).enter().append("rect").attr("x",$).attr("y",a).attr("width",Math.max(0,$.bandwidth()-1)).attr("height",o-a-s).attr("fill",z),w=()=>{};return y.append("g").attr("transform",`translate(0,${o-s})`).call(Up($).ticks(Array.isArray(d)?null:d,typeof f=="string"?f:void 0).tickFormat(typeof f=="function"?f:void 0).tickSize(r).tickValues(Array.isArray(d)?d:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",pt(h,"normal")).call(w).call(L=>L.select(".domain").remove()),n!==void 0&&y.append("text").attr("x",u).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(n),y.node()}const Xr=Math.PI/180;function sn(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:i=e}={}){t.markerStart=Po(n),t.markerMid=Po(r),t.markerEnd=Po(i)}function Po(t){if(t==null||t===!1)return null;if(t===!0)return Tu;if(typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return Ru("auto");case"arrow-reverse":return Ru("auto-start-reverse");case"dot":return i$;case"circle":case"circle-fill":return Tu;case"circle-stroke":return o$;case"tick":return Xo("auto");case"tick-x":return Xo(90);case"tick-y":return Xo(0)}throw new Error(`invalid marker: ${t}`)}function Ru(t){return(e,n)=>U("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",t).attr("fill","none").attr("stroke",e).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(r=>r.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function i$(t,e){return U("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function Tu(t,e){return U("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function o$(t,e){return U("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",t).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function Xo(t){return(e,n)=>U("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",t).attr("stroke",e).call(r=>r.append("path").attr("d","M0,-3v6")).node()}let a$=0;function Zn(t,e,{stroke:n},r){return Bu(t,e,n&&(i=>n[i]),null,r)}function l$(t,e,{stroke:n,z:r},i){return Bu(t,e,n&&(([o])=>n[o]),r,i)}const _o=1,Iu=2;function s$(t,e){const n=new Uint8Array(e.length),r=t.data().filter(o=>o.length>1),i=r.length;for(let o=0,a=Wo;o<i;++o){const l=r[o];if(l.length>1){const s=l[0];a!==(a=re(e[s]))&&(n[s]|=_o)}}for(let o=i-1,a=Wo;o>=0;--o){const l=r[o];if(l.length>1){const s=l[0];a!==(a=re(e[s]))&&(n[s]|=Iu)}}return([o])=>n[o]}function Bu(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:i},o=()=>i,a,l){if(!e&&!n&&!r)return;const s=new Map,u=a&&s$(t,a);function c(d,f,h){return function(p){if(h&&!h(p))return;const m=o(p);let x=s.get(f);x||s.set(f,x=new Map);let g=x.get(m);if(!g){const y=this.parentNode.insertBefore(f(m,l),this),w=`plot-marker-${++a$}`;y.setAttribute("id",w),x.set(m,g=`url(#${w})`)}this.setAttribute(d,g)}}e&&t.each(c("marker-start",e,u&&(d=>u(d)&_o))),n&&u&&t.each(c("marker-start",n,d=>!(u(d)&_o))),n&&t.each(c("marker-mid",n)),r&&t.each(c("marker-end",r,u&&(d=>u(d)&Iu)))}function Kn({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=Wu(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function Qn({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=Wu(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function Wu(t,e,n){return t===void 0&&e===void 0&&n===void 0?bt?[1,0]:[.5,.5]:[e,n]}function ju(t,{interval:e}){return t={...tn(t)},t.interval=Sr(t.interval===void 0?e:t.interval),t}function _r(t,e,n,r){const{[t]:i,[`${t}1`]:o,[`${t}2`]:a}=n,{value:l,interval:s}=ju(i,n);if(l==null||s==null&&!r)return n;const u=_t(i);if(s==null){let h;const p={transform:m=>h||(h=V(m,l)),label:u};return{...n,[t]:void 0,[`${t}1`]:o===void 0?p:o,[`${t}2`]:a===void 0&&!(o===a&&r)?p:a}}let c,d;function f(h){return d!==void 0&&h===c?d:d=J(V(c=h,l),p=>s.floor(p))}return e({...n,[t]:void 0,[`${t}1`]:o===void 0?{transform:f,label:u}:o,[`${t}2`]:a===void 0?{transform:h=>f(h).map(p=>s.offset(p)),label:u}:a})}function Fu(t,e,n){const{[t]:r}=n,{value:i,interval:o}=ju(r,n);return i==null||o==null?n:e({...n,[t]:{label:_t(r),transform:a=>{const l=J(V(a,i),u=>o.floor(u)),s=l.map(u=>o.offset(u));return l.map(At(l)?(u,c)=>u==null||isNaN(u=+u)||(c=s[c],c==null)||isNaN(c=+c)?void 0:new Date((u+c)/2):(u,c)=>u==null||(c=s[c],c==null)?NaN:(+u+ +c)/2)}}})}function Du(t={}){return _r("x",Kn,t,!0)}function qu(t={}){return _r("y",Qn,t,!0)}function Go(t={}){return _r("x",Kn,t)}function Vo(t={}){return _r("y",Qn,t)}function Yu(t={}){return Fu("x",Kn,t)}function Pu(t={}){return Fu("y",Qn,t)}const Xu={ariaLabel:"rule",fill:null,stroke:"currentColor"};let _u=class extends et{constructor(e,n={}){const{x:r,y1:i,y2:o,inset:a=0,insetTop:l=a,insetBottom:s=a}=n;super(e,{x:{value:r,scale:"x",optional:!0},y1:{value:i,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},je(n,"x"),Xu),this.insetTop=rt(l),this.insetBottom=rt(s),sn(this,n)}render(e,n,r,i,o){const{x:a,y:l}=n,{x:s,y1:u,y2:c}=r,{width:d,height:f,marginTop:h,marginRight:p,marginLeft:m,marginBottom:x}=i,{insetTop:g,insetBottom:y}=this;return U("svg:g",o).call(ot,this,i,o).call(tt,this,{x:s&&a},bt,0).call(w=>w.selectAll().data(e).enter().append("line").call(Q,this).attr("x1",s?$=>s[$]:(m+d-p)/2).attr("x2",s?$=>s[$]:(m+d-p)/2).attr("y1",u&&!Vt(l)?$=>u[$]+g:h+g).attr("y2",c&&!Vt(l)?l.bandwidth?$=>c[$]+l.bandwidth()-y:$=>c[$]-y:f-x-y).call(ct,this,r).call(Zn,this,r,o)).node()}},Gu=class extends et{constructor(e,n={}){const{x1:r,x2:i,y:o,inset:a=0,insetRight:l=a,insetLeft:s=a}=n;super(e,{y:{value:o,scale:"y",optional:!0},x1:{value:r,scale:"x",optional:!0},x2:{value:i,scale:"x",optional:!0}},je(n,"y"),Xu),this.insetRight=rt(l),this.insetLeft=rt(s),sn(this,n)}render(e,n,r,i,o){const{x:a,y:l}=n,{y:s,x1:u,x2:c}=r,{width:d,height:f,marginTop:h,marginRight:p,marginLeft:m,marginBottom:x}=i,{insetLeft:g,insetRight:y}=this;return U("svg:g",o).call(ot,this,i,o).call(tt,this,{y:s&&l},0,bt).call(w=>w.selectAll().data(e).enter().append("line").call(Q,this).attr("x1",u&&!Vt(a)?$=>u[$]+g:m+g).attr("x2",c&&!Vt(a)?a.bandwidth?$=>c[$]+a.bandwidth()-y:$=>c[$]-y:d-p-y).attr("y1",s?$=>s[$]:(h+f-x)/2).attr("y2",s?$=>s[$]:(h+f-x)/2).call(ct,this,r).call(Zn,this,r,o)).node()}};function be(t,e){let{x:n=D,y:r,y1:i,y2:o,...a}=Vo(e);return[i,o]=Vu(r,i,o),new _u(t,{...a,x:n,y1:i,y2:o})}function ve(t,e){let{y:n=D,x:r,x1:i,x2:o,...a}=Go(e);return[i,o]=Vu(r,i,o),new Gu(t,{...a,y:n,x1:i,x2:o})}function Vu(t,e,n){if(t==null){if(e===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,e]}else{if(e===void 0)return n===void 0?[0,t]:[t,n];if(n===void 0)return[t,e]}return[e,n]}function un(t,...e){let n=e.length;for(let r=0,i=!0;r<n;++r)typeof e[r]!="function"&&(i&&(t=t.slice(),i=!1),t.splice(r,2,t[r]+e[r]+t[r+1]),e.splice(r,1),--r,--n);return r=>{let i=t[0];for(let o=0;o<n;++o)i+=e[o](r)+t[o+1];return i}}const u$={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},Hu="\xAD";let Gr=class extends et{constructor(e,n={}){const{x:r,y:i,text:o=ie(e)&&xs(e)?D:gt,frameAnchor:a,textAnchor:l=/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle",lineAnchor:s=/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle",lineHeight:u=1,lineWidth:c=1/0,textOverflow:d,monospace:f,fontFamily:h=f?"ui-monospace, monospace":void 0,fontSize:p,fontStyle:m,fontVariant:x,fontWeight:g,rotate:y}=n,[w,$]=dt(y,0),[v,b]=h$(p);if(super(e,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},fontSize:{value:v,optional:!0},rotate:{value:Xm(w),optional:!0},text:{value:o,filter:ji,optional:!0}},n,u$),this.rotate=$,this.textAnchor=pt(l,"middle"),this.lineAnchor=Ot(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+u,this.lineWidth=+c,this.textOverflow=Uu(d),this.monospace=!!f,this.fontFamily=kt(h),this.fontSize=b,this.fontStyle=kt(m),this.fontVariant=kt(x),this.fontWeight=kt(g),this.frameAnchor=jn(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${c}`);this.splitLines=tc(this),this.clipLine=ec(this)}render(e,n,r,i,o){const{x:a,y:l}=n,{x:s,y:u,rotate:c,text:d,title:f,fontSize:h}=r,{rotate:p}=this,[m,x]=Ht(this,i);return U("svg:g",o).call(ot,this,i,o).call(Qu,this,d,i).call(tt,this,{x:s&&a,y:u&&l}).call(g=>g.selectAll().data(e).enter().append("text").call(Q,this).call(c$,this,d,f).attr("transform",un`translate(${s?y=>s[y]:m},${u?y=>u[y]:x})${c?y=>` rotate(${c[y]})`:p?` rotate(${p})`:""}`).call(q,"font-size",h&&(y=>h[y])).call(ct,this,r)).node()}};function Uu(t){return t==null?null:Ot(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function c$(t,e,n,r){if(!n)return;const{lineAnchor:i,lineHeight:o,textOverflow:a,splitLines:l,clipLine:s}=e;t.each(function(u){const c=l(an(n[u])??"").map(s),d=c.length,f=i==="top"?.71:i==="bottom"?1-d:(164-d*100)/200;if(d>1){let h=0;for(let p=0;p<d;++p){if(++h,!c[p])continue;const m=this.ownerDocument.createElementNS(Ne.svg,"tspan");m.setAttribute("x",0),p===h-1?m.setAttribute("y",`${(f+p)*o}em`):m.setAttribute("dy",`${h*o}em`),m.textContent=c[p],this.appendChild(m),h=0}}else f&&this.setAttribute("y",`${f*o}em`),this.textContent=c[0];if(a&&!r&&c[0]!==n[u]){const h=this.ownerDocument.createElementNS(Ne.svg,"title");h.textContent=n[u],this.appendChild(h)}})}function cn(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wt(e,n)),new Gr(t,{...r,x:e,y:n})}function Zu(t,{x:e=D,...n}={}){return new Gr(t,Pu({...n,x:e}))}function Ku(t,{y:e=D,...n}={}){return new Gr(t,Yu({...n,y:e}))}function Qu(t,e,n){q(t,"text-anchor",e.textAnchor),q(t,"font-family",e.fontFamily),q(t,"font-size",e.fontSize),q(t,"font-style",e.fontStyle),q(t,"font-variant",e.fontVariant===void 0?f$(n):e.fontVariant),q(t,"font-weight",e.fontWeight)}function f$(t){return t&&(en(t)||At(t))?"tabular-nums":void 0}const d$=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function h$(t){return t==null||typeof t=="number"?[void 0,t]:typeof t!="string"?[t,void 0]:(t=t.trim().toLowerCase(),d$.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}function p$(t,e,n){const r=[];let i,o=0;for(const[a,l,s]of m$(t)){if(i===void 0&&(i=a),o>i&&n(t,i,l)>e&&(r.push(t.slice(i,o)+(t[o-1]===Hu?"-":"")),i=a),s){r.push(t.slice(i,l)),i=void 0;continue}o=l}return r}function*m$(t){let e=0,n=0;const r=t.length;for(;n<r;){let i=1;switch(t[n]){case Hu:case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];t[++n]===" ";);e=n;break;case"\r":t[n+1]===`
`&&++i;case`
`:yield[e,n,!0],n+=i,e=n;break;default:++n;break}}yield[e,n,!0]}const Ju={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"\u2018":31,"\u2019":31,"\u201C":47,"\u201D":47,"\u2026":82};function Ho(t,e=0,n=t.length){let r=0;for(let i=e;i<n;i=hn(t,i))r+=Ju[t[i]]??(ac(t,i)?120:Ju.e);return r}function Uo(t,e=0,n=t.length){let r=0;for(let i=e;i<n;i=hn(t,i))r+=ac(t,i)?126:63;return r}function tc({monospace:t,lineWidth:e,textOverflow:n}){if(n!=null||e==1/0)return o=>o.split(/\r\n?|\n/g);const r=t?Uo:Ho,i=e*100;return o=>p$(o,i,r)}function ec({monospace:t,lineWidth:e,textOverflow:n}){if(n==null||e==1/0)return o=>o;const r=t?Uo:Ho,i=e*100;switch(n){case"clip-start":return o=>rc(o,i,r,"");case"clip-end":return o=>nc(o,i,r,"");case"ellipsis-start":return o=>rc(o,i,r,fn);case"ellipsis-middle":return o=>y$(o,i,r,fn);case"ellipsis-end":return o=>nc(o,i,r,fn)}}const fn="\u2026";function dn(t,e,n,r){const i=[];let o=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=hn(t,a);const u=n(t,a,l);if(o+u>e){for(o+=r;o>e&&a>0;)l=a,a=i.pop(),o-=n(t,a,l);return[a,e-o]}o+=u,i.push(a)}return[-1,0]}function nc(t,e,n,r){t=t.trim();const i=n(r),[o]=dn(t,e,n,i);return o<0?t:t.slice(0,o).trimEnd()+r}function y$(t,e,n,r){t=t.trim();const i=n(t);if(i<=e)return t;const o=n(r)/2,[a,l]=dn(t,e/2,n,o),[s]=dn(t,i-e/2-l+o,n,-o);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(hn(t,s)).trimStart()}function rc(t,e,n,r){t=t.trim();const i=n(t);if(i<=e)return t;const o=n(r),[a]=dn(t,i-e+o,n,-o);return a<0?r:r+t.slice(hn(t,a)).trimStart()}const Zo=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,ic=new RegExp("\\p{Extended_Pictographic}","uy");function hn(t,e){return e+=g$(t,e)?2:1,x$(t,e)&&(e=Zo.lastIndex),$$(t,e)?hn(t,e+1):e}function oc(t,e){return t.charCodeAt(e)<128}function g$(t,e){const n=t.charCodeAt(e);if(n>=55296&&n<56320){const r=t.charCodeAt(e+1);return r>=56320&&r<57344}return!1}function $$(t,e){return t.charCodeAt(e)===8205}function x$(t,e){return oc(t,e)?!1:(Zo.lastIndex=e,Zo.test(t))}function ac(t,e){return oc(t,e)?!1:(ic.lastIndex=e,ic.test(t))}const lc={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},sc=3.5,w$=sc*5,uc={draw(t,e,n){const r=e*n/w$;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-r,r-e),t.lineTo(0,-e),t.lineTo(r,r-e)}},cc={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},b$=new Map([["arrow",uc],["spike",cc]]);function v$(t){return t&&typeof t.draw=="function"}function k$(t){if(v$(t))return t;const e=b$.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}let Vr=class extends et{constructor(e,n={}){const{x:r,y:i,r:o=sc,length:a,rotate:l,shape:s=uc,anchor:u="middle",frameAnchor:c}=n,[d,f]=dt(a,12),[h,p]=dt(l,0);super(e,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},length:{value:d,scale:"length",optional:!0},rotate:{value:h,optional:!0}},n,lc),this.r=+o,this.length=f,this.rotate=p,this.shape=k$(s),this.anchor=Ot(u,"anchor",["start","middle","end"]),this.frameAnchor=jn(c)}render(e,n,r,i,o){const{x:a,y:l}=n,{x:s,y:u,length:c,rotate:d}=r,{length:f,rotate:h,anchor:p,shape:m,r:x}=this,[g,y]=Ht(this,i);return U("svg:g",o).call(ot,this,i,o).call(tt,this,{x:s&&a,y:u&&l}).call(w=>w.selectAll().data(e).enter().append("path").call(Q,this).attr("transform",un`translate(${s?$=>s[$]:g},${u?$=>u[$]:y})${d?$=>` rotate(${d[$]})`:h?` rotate(${h})`:""}${p==="start"?"":p==="end"?c?$=>` translate(0,${c[$]})`:` translate(0,${f})`:c?$=>` translate(0,${c[$]/2})`:` translate(0,${f/2})`}`).attr("d",c?$=>{const v=Qt();return m.draw(v,c[$],x),v}:(()=>{const $=Qt();return m.draw($,f,x),$})()).call(ct,this,r)).node()}};function fc(t,e={}){let{x:n,y:r,...i}=e;return e.frameAnchor===void 0&&([n,r]=Wt(n,r)),new Vr(t,{...i,x:n,y:r})}function dc(t,e={}){const{x:n=D,...r}=e;return new Vr(t,{...r,x:n})}function hc(t,e={}){const{y:n=D,...r}=e;return new Vr(t,{...r,y:n})}function M$(t,e={}){const{shape:n=cc,stroke:r=lc.stroke,strokeWidth:i=1,fill:o=r,fillOpacity:a=.3,anchor:l="start",...s}=e;return fc(t,{...s,shape:n,stroke:r,strokeWidth:i,fill:o,fillOpacity:a,anchor:l})}function ke(t,e){return arguments.length<2&&!ie(t)&&(e=t,t=null),e===void 0&&(e={}),[t,e]}function Hr({anchor:t}={},e){return t===void 0?e[0]:Ot(t,"anchor",e)}function pc(t){return Hr(t,["left","right"])}function mc(t){return Hr(t,["right","left"])}function yc(t){return Hr(t,["bottom","top"])}function gc(t){return Hr(t,["top","bottom"])}function Ko(){const[t,e]=ke(...arguments);return wc("y",pc(e),t,e)}function $c(){const[t,e]=ke(...arguments);return wc("fy",mc(e),t,e)}function Qo(){const[t,e]=ke(...arguments);return bc("x",yc(e),t,e)}function xc(){const[t,e]=ke(...arguments);return bc("fx",gc(e),t,e)}function wc(t,e,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:a=i,strokeWidth:l=1,fill:s=r,fillOpacity:u=i,textAnchor:c,textStroke:d,textStrokeOpacity:f,textStrokeWidth:h,tickSize:p=t==="y"?6:0,tickPadding:m,tickRotate:x,x:g,margin:y,marginTop:w=y===void 0?20:y,marginRight:$=y===void 0?e==="right"?40:0:y,marginBottom:v=y===void 0?20:y,marginLeft:b=y===void 0?e==="left"?40:0:y,label:k,labelAnchor:M,labelArrow:A,labelOffset:z,...S}){return p=rt(p),m=rt(m),x=rt(x),M!==void 0&&(M=Ot(M,"labelAnchor",["center","top","bottom"])),A=Rc(A),It(p&&!lt(o)?A$(t,e,n,{stroke:o,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:x,x:g,...S}):null,lt(s)?null:z$(t,e,n,{fill:s,fillOpacity:u,stroke:d,strokeOpacity:f,strokeWidth:h,textAnchor:c,tickSize:p,tickPadding:m,tickRotate:x,x:g,marginTop:w,marginRight:$,marginBottom:v,marginLeft:b,...S}),!lt(s)&&k!==null?cn([],Ec({fill:s,fillOpacity:u,...S},function(L,C,E,O,R){const N=O[t],{marginTop:F,marginRight:T,marginBottom:B,marginLeft:j}=t==="y"&&R.inset||R,I=M??(N.bandwidth?"center":"top"),Y=z??(e==="right"?T:j)-3;return I==="center"?(this.textAnchor=void 0,this.lineAnchor=e==="right"?"bottom":"top",this.frameAnchor=e,this.rotate=-90):(this.textAnchor=e==="right"?"end":"start",this.lineAnchor=I,this.frameAnchor=`${I}-${e}`,this.rotate=0),this.dy=I==="top"?3-F:I==="bottom"?B-3:0,this.dx=e==="right"?Y:-Y,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[Nc(t,N,{anchor:e,label:k,labelAnchor:I,labelArrow:A})]}}}})):null)}function bc(t,e,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:a=i,strokeWidth:l=1,fill:s=r,fillOpacity:u=i,textAnchor:c,textStroke:d,textStrokeOpacity:f,textStrokeWidth:h,tickSize:p=t==="x"?6:0,tickPadding:m,tickRotate:x,y:g,margin:y,marginTop:w=y===void 0?e==="top"?30:0:y,marginRight:$=y===void 0?20:y,marginBottom:v=y===void 0?e==="bottom"?30:0:y,marginLeft:b=y===void 0?20:y,label:k,labelAnchor:M,labelArrow:A,labelOffset:z,...S}){return p=rt(p),m=rt(m),x=rt(x),M!==void 0&&(M=Ot(M,"labelAnchor",["center","left","right"])),A=Rc(A),It(p&&!lt(o)?L$(t,e,n,{stroke:o,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:x,y:g,...S}):null,lt(s)?null:S$(t,e,n,{fill:s,fillOpacity:u,stroke:d,strokeOpacity:f,strokeWidth:h,textAnchor:c,tickSize:p,tickPadding:m,tickRotate:x,y:g,marginTop:w,marginRight:$,marginBottom:v,marginLeft:b,...S}),!lt(s)&&k!==null?cn([],Ec({fill:s,fillOpacity:u,...S},function(L,C,E,O,R){const N=O[t],{marginTop:F,marginRight:T,marginBottom:B,marginLeft:j}=t==="x"&&R.inset||R,I=M??(N.bandwidth?"center":"right"),Y=z??(e==="top"?F:B)-3;return I==="center"?(this.frameAnchor=e,this.textAnchor=void 0):(this.frameAnchor=`${e}-${I}`,this.textAnchor=I==="right"?"end":"start"),this.lineAnchor=e,this.dy=e==="top"?-Y:Y,this.dx=I==="right"?T-3:I==="left"?3-j:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[Nc(t,N,{anchor:e,label:k,labelAnchor:I,labelArrow:A})]}}}})):null)}function A$(t,e,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:a=e+(t==="y"?"-empty":""),frameAnchor:l=e,tickSize:s,inset:u=0,insetLeft:c=u,insetRight:d=u,dx:f=0,y:h=t==="y"?void 0:null,...p}){return pn(hc,t,n,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:i,strokeLinejoin:o,facetAnchor:a,frameAnchor:l,y:h,...p,dx:e==="left"?+f-bt+ +c:+f+bt-d,anchor:"start",length:s,shape:e==="left"?N$:R$})}function L$(t,e,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:a=e+(t==="x"?"-empty":""),frameAnchor:l=e,tickSize:s,inset:u=0,insetTop:c=u,insetBottom:d=u,dy:f=0,x:h=t==="x"?void 0:null,...p}){return pn(dc,t,n,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:o,strokeLinecap:i,facetAnchor:a,frameAnchor:l,x:h,...p,dy:e==="bottom"?+f-bt-d:+f+bt+ +c,anchor:"start",length:s,shape:e==="bottom"?O$:C$})}function z$(t,e,n,{facetAnchor:r=e+(t==="y"?"-empty":""),frameAnchor:i=e,tickSize:o,tickRotate:a=0,tickPadding:l=Math.max(3,9-o)+(Math.abs(a)>60?4*Math.cos(a*Xr):0),text:s,textAnchor:u=Math.abs(a)>60?"middle":e==="left"?"end":"start",lineAnchor:c=a>60?"top":a<-60?"bottom":"middle",fontVariant:d,inset:f=0,insetLeft:h=f,insetRight:p=f,dx:m=0,y:x=t==="y"?void 0:null,...g}){return pn(Ku,t,n,{ariaLabel:`${t}-axis tick label`},{facetAnchor:r,frameAnchor:i,text:s,textAnchor:u,lineAnchor:c,fontVariant:d,rotate:a,y:x,...g,dx:e==="left"?+m-o-l+ +h:+m+ +o+ +l-p},function(y,w,$,v,b){d===void 0&&(this.fontVariant=Cc(y)),s===void 0&&(b.text=Oc(y,w,$,v,e))})}function S$(t,e,n,{facetAnchor:r=e+(t==="x"?"-empty":""),frameAnchor:i=e,tickSize:o,tickRotate:a=0,tickPadding:l=Math.max(3,9-o)+(Math.abs(a)>=10?4*Math.cos(a*Xr):0),text:s,textAnchor:u=Math.abs(a)>=10?a<0^e==="bottom"?"start":"end":"middle",lineAnchor:c=Math.abs(a)>=10?"middle":e==="bottom"?"top":"bottom",fontVariant:d,inset:f=0,insetTop:h=f,insetBottom:p=f,dy:m=0,x=t==="x"?void 0:null,...g}){return pn(Zu,t,n,{ariaLabel:`${t}-axis tick label`},{facetAnchor:r,frameAnchor:i,text:s===void 0?null:s,textAnchor:u,lineAnchor:c,fontVariant:d,rotate:a,x,...g,dy:e==="bottom"?+m+ +o+ +l-p:+m-o-l+ +h},function(y,w,$,v,b){d===void 0&&(this.fontVariant=Cc(y)),s===void 0&&(b.text=Oc(y,w,$,v,e))})}function vc(){const[t,e]=ke(...arguments);return Lc("y",pc(e),t,e)}function kc(){const[t,e]=ke(...arguments);return Lc("fy",mc(e),t,e)}function Mc(){const[t,e]=ke(...arguments);return zc("x",yc(e),t,e)}function Ac(){const[t,e]=ke(...arguments);return zc("fx",gc(e),t,e)}function Lc(t,e,n,{y:r=t==="y"?void 0:null,x:i=null,x1:o=e==="left"?i:null,x2:a=e==="right"?i:null,...l}){return pn(ve,t,n,{ariaLabel:`${t}-grid`,ariaHidden:!0},{y:r,x1:o,x2:a,...Sc(l)})}function zc(t,e,n,{x:r=t==="x"?void 0:null,y:i=null,y1:o=e==="top"?i:null,y2:a=e==="bottom"?i:null,...l}){return pn(be,t,n,{ariaLabel:`${t}-grid`,ariaHidden:!0},{x:r,y1:o,y2:a,...Sc(l)})}function Sc({color:t="currentColor",opacity:e=.1,stroke:n=t,strokeOpacity:r=e,strokeWidth:i=1,...o}){return{stroke:n,strokeOpacity:r,strokeWidth:i,...o}}function Ec({fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:u,clip:c=!1},d){return[,t]=Mt(t),[,e]=dt(e),{facet:"super",x:null,y:null,fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:u,clip:c,initializer:d}}function pn(t,e,n,r,i,o){let a;function l(c,d,f,h,p,m){const x=c==null&&(e==="fx"||e==="fy"),{[e]:g}=h;if(!g)throw new Error(`missing scale: ${e}`);const y=g.domain();let{interval:w,ticks:$,tickFormat:v,tickSpacing:b=e==="x"?80:35}=i;if(typeof $=="string"&&Tc(g)&&(w=$,$=void 0),$===void 0&&($=Qe(w,g.type)??E$(g,b)),c==null){if(ie($))c=ee($);else if(Je($))c=ta($,...yt(y));else if(g.interval){let M=g.interval;if(g.ticks){const[A,z]=yt(y),S=(z-A)/M[Cn];M=rs(M,S/$)??M,c=ta(M,A,z)}else{c=y;const A=c.length;M=rs(M,A/$)??M,M!==g.interval&&(c=ta(M,...yt(c)))}if(M===g.interval){const A=Math.round(c.length/$);A>1&&(c=c.filter((z,S)=>S%A===0))}}else g.ticks?c=g.ticks($):c=y;if(!g.ticks&&c.length&&c!==y){const M=new zn(y);c=c.filter(A=>M.has(A)),c.length||ue(`Warning: the ${e}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}e==="y"||e==="x"?d=[ne(c)]:a[e]={scale:e,value:D}}o?.call(this,g,c,$,v,a);const k=Object.fromEntries(Object.entries(a).map(([M,A])=>[M,{...A,value:V(c,A.value)}]));return x&&(d=m.filterFacets(c,k)),{data:c,facets:d,channels:k}}const s=Lt(i).initializer,u=t(n,Lt({...i,initializer:l},s));return n==null?(a=u.channels,u.channels={}):a={},r!==void 0&&Object.assign(u,r),u.clip===void 0&&(u.clip=!1),u}function E$(t,e){const[n,r]=yt(t.range());return(r-n)/e}function Oc(t,e,n,r,i){return{value:Jo(t,e,n,r,i)}}function Jo(t,e,n,r,i){return typeof r=="function"&&!(t.type==="log"&&t.tickFormat)?r:r===void 0&&e&&At(e)?Im(t.type,e,i)??an:t.tickFormat?t.tickFormat(typeof n=="number"?n:null,r):r===void 0?an:typeof r=="string"?(At(t.domain())?Li:Ri)(r):wt(r)}function ta(t,e,n){return t.range(e,t.offset(t.floor(n)))}const O$={draw(t,e){t.moveTo(0,0),t.lineTo(0,e)}},C$={draw(t,e){t.moveTo(0,0),t.lineTo(0,-e)}},N$={draw(t,e){t.moveTo(0,0),t.lineTo(-e,0)}},R$={draw(t,e){t.moveTo(0,0),t.lineTo(e,0)}};function Cc(t){return t.bandwidth&&!t.interval?void 0:"tabular-nums"}function Nc(t,e,{anchor:n,label:r=e.label,labelAnchor:i,labelArrow:o}={}){if(!(r==null||r.inferred&&Tc(e)&&/^(date|time|year)$/i.test(r))){if(r=String(r),o==="auto"&&(o=(!e.bandwidth||e.interval)&&!/[]/.test(r)),!o)return r;if(o===!0){const a=au(e);a&&(o=/x$/.test(t)||i==="center"?/x$/.test(t)===a<0?"left":"right":a<0?"up":"down")}switch(o){case"left":return`\u2190 ${r}`;case"right":return`${r} \u2192`;case"up":return n==="right"?`${r} \u2191`:`\u2191 ${r}`;case"down":return n==="right"?`${r} \u2193`:`\u2193 ${r}`}return r}}function Rc(t="auto"){return lt(t)?!1:typeof t=="boolean"?t:Ot(t,"labelArrow",["auto","up","right","down","left"])}function Tc(t){return At(t.domain())}function Ic(t,e){if(e==null)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function T$(t,{opacity:e,...n}={}){if(!We(t)&&!mu(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return Bc(t,n,(r,i,o,a)=>r.append("svg").attr("width",o).attr("height",a).attr("fill",i.scale).attr("fill-opacity",dt(e)[1]).append("rect").attr("width","100%").attr("height","100%"))}function I$(t,{fill:e=t.hint?.fill!==void 0?t.hint.fill:"none",fillOpacity:n=1,stroke:r=t.hint?.stroke!==void 0?t.hint.stroke:lt(e)?"currentColor":"none",strokeOpacity:i=1,strokeWidth:o=1.5,r:a=4.5,...l}={},s){const[u,c]=Mt(e),[d,f]=Mt(r),h=Ic(s,u),p=Ic(s,d),m=a*a*Math.PI;return n=dt(n)[1],i=dt(i)[1],o=dt(o)[1],Bc(t,l,(x,g,y,w)=>x.append("svg").attr("viewBox","-8 -8 16 16").attr("width",y).attr("height",w).attr("fill",u==="color"?$=>h.scale($):c).attr("fill-opacity",n).attr("stroke",d==="color"?$=>p.scale($):f).attr("stroke-opacity",i).attr("stroke-width",o).append("path").attr("d",$=>{const v=Qt();return t.scale($).draw(v,m),v}))}function Bc(t,e={},n){let{columns:r,tickFormat:i,fontVariant:o=Nu(t),swatchSize:a=15,swatchWidth:l=a,swatchHeight:s=a,marginLeft:u=0,className:c,style:d,width:f}=e;const h=Dr(e);c=Yr(c),i=Jo(t.scale,t.domain,void 0,i);const p=U("div",h).attr("class",`${c}-swatches ${c}-swatches-${r!=null?"columns":"wrap"}`);let m;return r!=null?(m=`:where(.${c}-swatches-columns .${c}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${c}-swatches-columns .${c}-swatch::before) {
  flex-shrink: 0;
}
:where(.${c}-swatches-columns .${c}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,p.style("columns",r).selectAll().data(t.domain).enter().append("div").attr("class",`${c}-swatch`).call(n,t,l,s).call(x=>x.append("div").attr("class",`${c}-swatch-label`).attr("title",i).text(i))):(m=`:where(.${c}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${c}-swatches-wrap .${c}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,p.selectAll().data(t.domain).enter().append("span").attr("class",`${c}-swatch`).call(n,t,l,s).append(function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))})),p.call(x=>x.insert("style","*").text(`:where(.${c}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${c}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${m}`)).style("margin-left",u?`${+u}px`:null).style("width",f===void 0?null:`${+f}px`).style("font-variant",pt(o,"normal")).call(Fo,d).node()}const Ur=new Map([["symbol",I$],["color",Wc],["opacity",j$]]);function B$(t={}){for(const[e,n]of Ur){const r=t[e];if(Te(r)){const i=Dr(t);let o;if(e==="symbol"){const{fill:a,stroke:l=a===void 0&&Te(t.color)?"color":void 0}=t;o={fill:a,stroke:l}}return n(Lo(e,r,o),ea(i,r,t),a=>Te(t[a])?Lo(a,t[a]):null)}}throw new Error("unknown legend type; no scale found")}function W$(t,e,n={}){return(r,i)=>{if(!Ur.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return Ur.get(r)(t[r],ea(e,n[r],i),o=>t[o])}}function ea({className:t,...e},{label:n,ticks:r,tickFormat:i}={},o){return Km(o,{className:t,...e},{label:n,ticks:r,tickFormat:i})}function Wc(t,{legend:e=!0,...n}){if(e===!0&&(e=t.type==="ordinal"?"swatches":"ramp"),t.domain!==void 0)switch(`${e}`.toLowerCase()){case"swatches":return T$(t,n);case"ramp":return r$(t,n);default:throw new Error(`unknown legend type: ${e}`)}}function j$({type:t,interpolate:e,...n},{legend:r=!0,color:i=On(0,0,0),...o}){if(!e)throw new Error(`${t} opacity scales are not supported`);if(r===!0&&(r="ramp"),`${r}`.toLowerCase()!=="ramp")throw new Error(`${r} opacity legends are not supported`);return Wc({type:t,...n,interpolate:F$(i)},{legend:r,...o})}function F$(t){const{r:e,g:n,b:r}=On(t)||On(0,0,0);return i=>`rgba(${e},${n},${r},${i})`}function D$(t,e,n){const r=[];for(const[i,o]of Ur){const a=n[i];if(a?.legend&&i in t){const l=o(t[i],ea(e,t[i],a),s=>t[s]);l!=null&&r.push(l)}}return r}function Zr(t={}){return hs(t)?t:{...t,x:D}}function Kr(t={}){return ps(t)?t:{...t,y:D}}function jc(t,e){if(e.length===1)return{data:t,facets:e};const n=Bn(t),r=new Uint8Array(n);let i=0;for(const l of e)for(const s of l)r[s]&&++i,r[s]=1;if(i===0)return{data:t,facets:e};t=In(t);const o=t[ls]=new Uint32Array(n+i);e=e.map(l=>In(l,Uint32Array));let a=n;r.fill(0);for(const l of e)for(let s=0,u=l.length;s<u;++s){const c=l[s];r[c]?(l[s]=a,t[a]=t[c],o[a]=c,++a):o[c]=c,r[c]=1}return{data:t,facets:e}}function Fc(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{y1:n,y:r=n,x:i,...o}=e,[a,l,s,u]=yn(r,i,"y","x",t,o);return{...a,y1:n,y:l,x1:s,x2:u,x:Lr(s,u)}}function q$(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{y1:n,y:r=n,x:i}=e,[o,a,l]=yn(r,i,"y","x",t,e);return{...o,y1:n,y:a,x:l}}function Y$(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{y1:n,y:r=n,x:i}=e,[o,a,,l]=yn(r,i,"y","x",t,e);return{...o,y1:n,y:a,x:l}}function Dc(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{x1:n,x:r=n,y:i,...o}=e,[a,l,s,u]=yn(r,i,"x","y",t,o);return{...a,x1:n,x:l,y1:s,y2:u,y:Lr(s,u)}}function P$(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{x1:n,x:r=n,y:i}=e,[o,a,l]=yn(r,i,"x","y",t,e);return{...o,x1:n,x:a,y:l}}function X$(t={},e={}){arguments.length===1&&([t,e]=mn(t));const{x1:n,x:r=n,y:i}=e,[o,a,,l]=yn(r,i,"x","y",t,e);return{...o,x1:n,x:a,y:l}}function Qr({x:t,x1:e,x2:n,...r}={}){return r=je(r,"y"),e===void 0&&n===void 0?Fc({x:t,...r}):([e,n]=ms(t,e,n),{...r,x1:e,x2:n})}function Jr({y:t,y1:e,y2:n,...r}={}){return r=je(r,"x"),e===void 0&&n===void 0?Dc({y:t,...r}):([e,n]=ms(t,e,n),{...r,y1:e,y2:n})}function mn(t){const{offset:e,order:n,reverse:r,...i}=t;return[{offset:e,order:n,reverse:r},i]}const _$={length:!0};function yn(t,e=Gi,n,r,{offset:i,order:o,reverse:a},l){if(e===null)throw new Error(`stack requires ${r}`);const s=$e(l),[u,c]=Et(t),[d,f]=Ct(e),[h,p]=Ct(e);return d.hint=h.hint=_$,i=G$(i),o=U$(o,i,r),[jt(l,(m,x,g)=>{({data:m,facets:x}=jc(m,x));const y=t==null?void 0:c(zr(V(m,t),g?.[n])),w=V(m,e,Float64Array),$=V(m,s),v=o&&o(m,y,w,$),b=Bn(m),k=f(new Float64Array(b)),M=p(new Float64Array(b)),A=[];for(const z of x){const S=y?Array.from(Ce(z,L=>y[L]).values()):[z];if(v)for(const L of S)L.sort(v);for(const L of S){let C=0,E=0;a&&L.reverse();for(const O of L){const R=w[O];R<0?C=M[O]=(k[O]=C)+R:R>0?E=M[O]=(k[O]=E)+R:M[O]=k[O]=E}}A.push(S)}return i&&i(A,k,M,$),{data:m,facets:x}}),u,d,h]}function G$(t){if(t!=null){if(typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return V$;case"center":case"silhouette":return H$;case"wiggle":return Yc}throw new Error(`unknown offset: ${t}`)}}function qc(t,e){let n=0,r=0;for(const i of t){const o=e[i];o<n&&(n=o),o>r&&(r=o)}return[n,r]}function V$(t,e,n){for(const r of t)for(const i of r){const[o,a]=qc(i,n);for(const l of i){const s=1/(a-o||1);e[l]=s*(e[l]-o),n[l]=s*(n[l]-o)}}}function H$(t,e,n){for(const r of t){for(const i of r){const[o,a]=qc(i,n);for(const l of i){const s=(a+o)/2;e[l]-=s,n[l]-=s}}Pc(r,e,n)}Xc(t,e,n)}function Yc(t,e,n,r){for(const i of t){const o=new Ni;let a=0;for(const l of i){let s=-1;const u=l.map(h=>Math.abs(n[h]-e[h])),c=l.map(h=>{s=r?r[h]:++s;const p=n[h]-e[h],m=o.has(s)?p-o.get(s):0;return o.set(s,p),m}),d=[0,...Zp(c)];for(const h of l)e[h]+=a,n[h]+=a;const f=qt(u);f&&(a-=qt(u,(h,p)=>(c[p]/2+d[p])*h)/f)}Pc(i,e,n)}Xc(t,e,n)}function Pc(t,e,n){const r=Nt(t,i=>Nt(i,o=>e[o]));for(const i of t)for(const o of i)e[o]-=r,n[o]-=r}function Xc(t,e,n){const r=t.length;if(r===1)return;const i=t.map(l=>l.flat()),o=i.map(l=>(Nt(l,s=>e[s])+zt(l,s=>n[s]))/2),a=Nt(o);for(let l=0;l<r;l++){const s=a-o[l];for(const u of i[l])e[u]+=s,n[u]+=s}}function U$(t,e,n){if(t===void 0&&e===Yc)return _c(Rt);if(t!=null){if(typeof t=="string"){const r=t.startsWith("-"),i=r?gr:Rt;switch((r?t.slice(1):t).toLowerCase()){case"value":case n:return Z$(i);case"z":return K$(i);case"sum":return Q$(i);case"appearance":return J$(i);case"inside-out":return _c(i)}return Gc(us(t))}if(typeof t=="function")return(t.length===1?Gc:tx)(t);if(te(t))return ex(t);throw new Error(`invalid order: ${t}`)}}function Z$(t){return(e,n,r)=>(i,o)=>t(r[i],r[o])}function K$(t){return(e,n,r,i)=>(o,a)=>t(i[o],i[a])}function Q$(t){return ti(t,(e,n,r,i)=>Ti(ne(e),o=>qt(o,a=>r[a]),o=>i[o]))}function J$(t){return ti(t,(e,n,r,i)=>Ti(ne(e),o=>n[Ii(o,a=>r[a])],o=>i[o]))}function _c(t){return ti(t,(e,n,r,i)=>{const o=ne(e),a=Ti(o,d=>n[Ii(d,f=>r[f])],d=>i[d]),l=Ln(o,d=>qt(d,f=>r[f]),d=>i[d]),s=[],u=[];let c=0;for(const d of a)c<0?(c+=l.get(d),s.push(d)):(c-=l.get(d),u.push(d));return u.reverse().concat(s)})}function Gc(t){return e=>{const n=V(e,t);return(r,i)=>Rt(n[r],n[i])}}function tx(t){return e=>te(e)?(n,r)=>t(e[n],e[r]):(n,r)=>t(e.get(n),e.get(r))}function ex(t){return ti(Rt,()=>t)}function ti(t,e){return(n,r,i,o)=>{if(!o)throw new Error("missing channel: z");const a=new Ni(e(n,r,i,o).map((l,s)=>[l,s]));return(l,s)=>t(a.get(o[l]),a.get(o[s]))}}const nx={ariaLabel:"rect"};let ei=class extends et{constructor(e,n={}){const{x1:r,y1:i,x2:o,y2:a}=n;super(e,{x1:{value:r,scale:"x",type:r!=null&&o==null?"band":void 0,optional:!0},y1:{value:i,scale:"y",type:i!=null&&a==null?"band":void 0,optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,nx),na(this,n),ra(this,n)}render(e,n,r,i,o){const{x:a,y:l}=n;let{x1:s,y1:u,x2:c,y2:d}=r;const{marginTop:f,marginRight:h,marginBottom:p,marginLeft:m,width:x,height:g}=i,{projection:y}=o,{insetTop:w,insetRight:$,insetBottom:v,insetLeft:b}=this,{rx:k,ry:M,rx1y1:A,rx1y2:z,rx2y1:S,rx2y2:L}=this;(s||c)&&!y&&Vt(a)&&(s=c=null),(u||d)&&!y&&Vt(l)&&(u=d=null);const C=a?.bandwidth?a.bandwidth():0,E=l?.bandwidth?l.bandwidth():0;return U("svg:g",o).call(ot,this,i,o).call(tt,this,{},0,0).call(O=>O.selectAll().data(e).enter().call(A||z||S||L?R=>R.append("path").call(Q,this).call(ia,s&&c?N=>s[N]+(c[N]<s[N]?-$:b):s?N=>s[N]+b:m+b,u&&d?N=>u[N]+(d[N]<u[N]?-v:w):u?N=>u[N]+w:f+w,s&&c?N=>c[N]-(c[N]<s[N]?-b:$):s?N=>s[N]+C-$:x-h-$,u&&d?N=>d[N]-(d[N]<u[N]?-w:v):u?N=>u[N]+E-v:g-p-v,this).call(ct,this,r):R=>R.append("rect").call(Q,this).attr("x",s?c?N=>Math.min(s[N],c[N])+b:N=>s[N]+b:m+b).attr("y",u?d?N=>Math.min(u[N],d[N])+w:N=>u[N]+w:f+w).attr("width",s?c?N=>Math.max(0,Math.abs(c[N]-s[N])+C-b-$):C-b-$:x-h-m-$-b).attr("height",u?d?N=>Math.max(0,Math.abs(u[N]-d[N])+E-w-v):E-w-v:g-f-p-w-v).call(q,"rx",k).call(q,"ry",M).call(ct,this,r))).node()}};function na(t,{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e}={}){t.insetTop=rt(n),t.insetRight=rt(r),t.insetBottom=rt(i),t.insetLeft=rt(o)}function ra(t,{r:e,rx:n,ry:r,rx1:i=e,ry1:o=e,rx2:a=e,ry2:l=e,rx1y1:s=i!==void 0?+i:o!==void 0?+o:0,rx1y2:u=i!==void 0?+i:l!==void 0?+l:0,rx2y1:c=a!==void 0?+a:o!==void 0?+o:0,rx2y2:d=a!==void 0?+a:l!==void 0?+l:0}={}){s||u||c||d?(t.rx1y1=s,t.rx1y2=u,t.rx2y1=c,t.rx2y2=d):(t.rx=pt(n,"auto"),t.ry=pt(r,"auto"))}function ia(t,e,n,r,i,o){const{rx1y1:a,rx1y2:l,rx2y1:s,rx2y2:u}=o;typeof e!="function"&&(e=wt(e)),typeof n!="function"&&(n=wt(n)),typeof r!="function"&&(r=wt(r)),typeof i!="function"&&(i=wt(i));const c=Math.max(Math.abs(a+s),Math.abs(l+u)),d=Math.max(Math.abs(a+l),Math.abs(s+u));t.attr("d",f=>{const h=e(f),p=n(f),m=r(f),x=i(f),g=h>m,y=p>x,w=g?m:h,$=g?h:m,v=y?x:p,b=y?p:x,k=Math.min(1,($-w)/c,(b-v)/d),M=k*(g?y?u:s:y?l:a),A=k*(g?y?l:a:y?u:s),z=k*(g?y?a:l:y?s:u),S=k*(g?y?s:u:y?a:l);return`M${w},${v+ri(M,S)}A${M},${M} 0 0 ${M<0?0:1} ${w+ni(M,S)},${v}H${$-ni(A,z)}A${A},${A} 0 0 ${A<0?0:1} ${$},${v+ri(A,z)}V${b-ri(z,A)}A${z},${z} 0 0 ${z<0?0:1} ${$-ni(z,A)},${b}H${w+ni(S,M)}A${S},${S} 0 0 ${S<0?0:1} ${w},${b-ri(S,M)}Z`})}function ni(t,e){return e<0?t:Math.abs(t)}function ri(t,e){return e<0?Math.abs(t):t}function oa(t,e){return new ei(t,Du(qu(e)))}function ii(t,e={}){return Ke(e)||(e={...e,y:gt,x2:D,interval:1}),new ei(t,Qr(qu(Zr(e))))}function oi(t,e={}){return Ke(e)||(e={...e,x:gt,y2:D,interval:1}),new ei(t,Jr(Du(Kr(e))))}const rx={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},ix={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};let Vc=class extends et{constructor(e={}){const{anchor:n=null}=e;super(Rn,void 0,e,n==null?rx:ix),this.anchor=ds(n,"anchor",["top","right","bottom","left"]),na(this,e),n||ra(this,e)}render(e,n,r,i,o){const{marginTop:a,marginRight:l,marginBottom:s,marginLeft:u,width:c,height:d}=i,{anchor:f,insetTop:h,insetRight:p,insetBottom:m,insetLeft:x}=this,{rx:g,ry:y,rx1y1:w,rx1y2:$,rx2y1:v,rx2y2:b}=this,k=u+x,M=c-l-p,A=a+h,z=d-s-m;return U(f?"svg:line":w||$||v||b?"svg:path":"svg:rect",o).datum(0).call(ot,this,i,o).call(Q,this).call(ct,this,r).call(tt,this,{}).call(f==="left"?S=>S.attr("x1",k).attr("x2",k).attr("y1",A).attr("y2",z):f==="right"?S=>S.attr("x1",M).attr("x2",M).attr("y1",A).attr("y2",z):f==="top"?S=>S.attr("x1",k).attr("x2",M).attr("y1",A).attr("y2",A):f==="bottom"?S=>S.attr("x1",k).attr("x2",M).attr("y1",z).attr("y2",z):w||$||v||b?S=>S.call(ia,k,A,M,z,this):S=>S.attr("x",k).attr("y",A).attr("width",M-k).attr("height",z-A).attr("rx",g).attr("ry",y)).node()}};function aa(t){return new Vc(t)}const la={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},ox=new Set(["geometry","href","src","ariaLabel","scales"]);let Hc=class extends et{constructor(e,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&ie(e)&&xs(e)&&(n={...n,title:D});const{x:r,y:i,x1:o,x2:a,y1:l,y2:s,anchor:u,preferredAnchor:c="bottom",monospace:d,fontFamily:f=d?"ui-monospace, monospace":void 0,fontSize:h,fontStyle:p,fontVariant:m,fontWeight:x,lineHeight:g=1,lineWidth:y=20,frameAnchor:w,format:$,textAnchor:v="start",textOverflow:b,textPadding:k=8,title:M,pointerSize:A=12,pathFilter:z="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(e,{x:{value:o!=null&&a!=null?null:r,scale:"x",optional:!0},y:{value:l!=null&&s!=null?null:i,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:a==null},y1:{value:l,scale:"y",optional:s==null},x2:{value:a,scale:"x",optional:o==null},y2:{value:s,scale:"y",optional:l==null},title:{value:M,optional:!0}},n,la),this.anchor=Ki(u,"anchor"),this.preferredAnchor=Ki(c,"preferredAnchor"),this.frameAnchor=jn(w),this.textAnchor=pt(v,"middle"),this.textPadding=+k,this.pointerSize=+A,this.pathFilter=kt(z),this.lineHeight=+g,this.lineWidth=+y,this.textOverflow=Uu(b),this.monospace=!!d,this.fontFamily=kt(f),this.fontSize=rt(h),this.fontStyle=kt(p),this.fontVariant=kt(m),this.fontWeight=kt(x);for(const S in la)S in this.channels&&(this[S]=la[S]);this.splitLines=tc(this),this.clipLine=ec(this),this.format=typeof $=="string"||typeof $=="function"?{title:$}:{...$}}render(e,n,r,i,o){const a=this,{x:l,y:s,fx:u,fy:c}=n,{ownerSVGElement:d,document:f}=o,{anchor:h,monospace:p,lineHeight:m,lineWidth:x}=this,{textPadding:g,pointerSize:y,pathFilter:w}=this,{marginTop:$,marginLeft:v}=i,{x1:b,y1:k,x2:M,y2:A,x:z=b??M,y:S=k??A}=r,L=u?u(e.fx)-v:0,C=c?c(e.fy)-$:0,[E,O]=Ht(this,i),R=Ou(r,E),N=Cu(r,O),F=p?Uo:Ho,T=F(fn);let B,j;"title"in r?(B=Zc.call(this,{title:r.channels.title},n),j=ux):(B=Zc.call(this,r.channels,n),j=cx);const I=U("svg:g",o).call(ot,this,i,o).call(Qu,this).call(tt,this,{x:z&&l,y:S&&s}).call(G=>G.selectAll().data(e).enter().append("g").attr("transform",X=>`translate(${Math.round(R(X))},${Math.round(N(X))})`).call(Q,this).call(X=>X.append("path").attr("filter",w)).call(X=>X.append("text").each(function(W){const P=he(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const _=j.call(a,W,e,B,n,r);if(typeof _=="string")for(const Z of a.splitLines(_))Y(P,{value:a.clipLine(Z)});else{const Z=new Set;for(const K of _){const{label:nt=""}=K;nt&&Z.has(nt)||(Z.add(nt),Y(P,K))}}})));function Y(G,{label:X,value:W,color:P,opacity:_}){X??="",W??="";const Z=P!=null||_!=null;let K,nt=x*100;const[ft]=dn(X,nt,F,T);if(ft>=0)X=X.slice(0,ft).trimEnd()+fn,K=W.trim(),W="";else{(X||!W&&!Z)&&(W=" "+W);const[ht]=dn(W,nt-F(X),F,T);ht>=0&&(K=W.trim(),W=W.slice(0,ht).trimEnd()+fn)}const at=G.append("tspan").attr("x",0).attr("dy",`${m}em`).text("\u200B");X&&at.append("tspan").attr("font-weight","bold").text(X),W&&at.append(()=>f.createTextNode(W)),Z&&at.append("tspan").text(" \u25A0").attr("fill",P).attr("fill-opacity",_).style("user-select","none"),K&&at.append("title").text(K)}function H(){const{width:G,height:X}=i.facet??i;I.selectChildren().each(function(W){let{x:P,width:_,height:Z}=this.getBBox();_=Math.round(_),Z=Math.round(Z);let K=h;if(K===void 0){const at=R(W)+L,ht=N(W)+C,mt=at+_+y+g*2<G,vt=at-_-y-g*2>0,Ee=ht+Z+y+g*2<X,Oe=ht-Z-y-g*2>0;K=mt&&vt?Ee&&Oe?a.preferredAnchor:Oe?"bottom":"top":Ee&&Oe?mt?"left":"right":(mt||vt)&&(Ee||Oe)?`${Oe?"bottom":"top"}-${mt?"left":"right"}`:a.preferredAnchor}const nt=this.firstChild,ft=this.lastChild;if(nt.setAttribute("d",sx(K,y,g,_,Z)),P)for(const at of ft.childNodes)at.setAttribute("x",-P);ft.setAttribute("y",`${+ax(K,ft.childNodes.length,m).toFixed(6)}em`),ft.setAttribute("transform",`translate(${lx(K,y,g,_,Z)})`)}),I.attr("visibility",null)}return e.length&&(I.attr("visibility","hidden"),d.isConnected?Promise.resolve().then(H):typeof requestAnimationFrame<"u"&&requestAnimationFrame(H)),I.node()}};function Uc(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wt(e,n)),new Hc(t,{...r,x:e,y:n})}function ax(t,e,n){return/^top(?:-|$)/.test(t)?.94-n:-.29-e*n}function lx(t,e,n,r,i){switch(t){case"middle":return[-r/2,i/2];case"top-left":return[n,e+n];case"top":return[-r/2,e/2+n];case"top-right":return[-r-n,e+n];case"right":return[-e/2-r-n,i/2];case"bottom-left":return[n,-e-n];case"bottom":return[-r/2,-e/2-n];case"bottom-right":return[-r-n,-e-n];case"left":return[n+e/2,i/2]}}function sx(t,e,n,r,i){const o=r+n*2,a=i+n*2;switch(t){case"middle":return`M${-o/2},${-a/2}h${o}v${a}h${-o}z`;case"top-left":return`M0,0l${e},${e}h${o-e}v${a}h${-o}z`;case"top":return`M0,0l${e/2},${e/2}h${(o-e)/2}v${a}h${-o}v${-a}h${(o-e)/2}z`;case"top-right":return`M0,0l${-e},${e}h${e-o}v${a}h${o}z`;case"right":return`M0,0l${-e/2},${-e/2}v${e/2-a/2}h${-o}v${a}h${o}v${e/2-a/2}z`;case"bottom-left":return`M0,0l${e},${-e}h${o-e}v${-a}h${-o}z`;case"bottom":return`M0,0l${e/2},${-e/2}h${(o-e)/2}v${-a}h${-o}v${a}h${(o-e)/2}z`;case"bottom-right":return`M0,0l${-e},${-e}h${e-o}v${-a}h${o}z`;case"left":return`M0,0l${e/2},${-e/2}v${e/2-a/2}h${o}v${a}h${-o}v${e/2-a/2}z`}}function Zc(t,e){const n={};let r=this.format;r=Kc(r,t,"x"),r=Kc(r,t,"y"),this.format=r;for(const i in r){const o=r[i];if(!(o===null||o===!1))if(i==="fx"||i==="fy")n[i]=!0;else{const a=go(t,i);a&&(n[i]=a)}}for(const i in t){if(i in n||i in r||ox.has(i)||(i==="x"||i==="y")&&t.geometry)continue;const o=go(t,i);if(o){if(o.scale==null&&o.defaultScale==="color")continue;n[i]=o}}this.facet&&(e.fx&&!("fx"in r)&&(n.fx=!0),e.fy&&!("fy"in r)&&(n.fy=!0));for(const i in n){const o=this.format[i];if(typeof o=="string"){const a=n[i]?.value??e[i]?.domain()??[];this.format[i]=(At(a)?Li:Ri)(o)}else if(o===void 0||o===!0){const a=e[i];this.format[i]=a?.bandwidth?Jo(a,a.domain()):an}}return n}function Kc(t,e,n){if(!(n in t))return t;const r=`${n}1`,i=`${n}2`;if((r in t||!(r in e))&&(i in t||!(i in e)))return t;const o=Object.entries(t),a=t[n];return o.splice(o.findIndex(([l])=>l===n)+1,0,[r,a],[i,a]),Object.fromEntries(o)}function ux(t,e,{title:n}){return this.format.title(n.value[t],t)}function*cx(t,e,n,r,i){for(const o in n){if(o==="fx"||o==="fy"){yield{label:ai(r,n,o),value:this.format[o](e[o],t)};continue}if(o==="x1"&&"x2"in n||o==="y1"&&"y2"in n)continue;const a=n[o];if(o==="x2"&&"x1"in n)yield{label:Jc(r,n,"x"),value:Qc(this.format.x2,n.x1,a,t)};else if(o==="y2"&&"y1"in n)yield{label:Jc(r,n,"y"),value:Qc(this.format.y2,n.y1,a,t)};else{const l=a.value[t],s=a.scale;if(!xt(l)&&s==null)continue;yield{label:ai(r,n,o),value:this.format[o](l,t),color:s==="color"?i[o][t]:null,opacity:s==="opacity"?i[o][t]:null}}}}function Qc(t,e,n,r){return n.hint?.length?`${t(n.value[r]-e.value[r],r)}`:`${t(e.value[r],r)}\u2013${t(n.value[r],r)}`}function Jc(t,e,n){const r=ai(t,e,`${n}1`,n),i=ai(t,e,`${n}2`,n);return r===i?r:`${r}\u2013${i}`}function ai(t,e,n,r=n){const i=e[n],o=t[i?.scale??n];return String(o?.label??i?.label??r)}function tf(t={}){const{facet:e,style:n,title:r,subtitle:i,caption:o,ariaLabel:a,ariaDescription:l}=t,s=Yr(t.className),u=t.marks===void 0?[]:nf(t.marks);u.push(...gx(u));const c=mx(e,t),d=new Map;for(const T of u){const B=of(T,c,t);B&&d.set(T,B)}const f=new Map;c&&Jn(f,[c],t),Jn(f,d,t);const h=nf($x(u,f,t));for(const T of h){const B=of(T,c,t);B&&d.set(T,B)}u.unshift(...h);let p=pg(f,t);if(p!==void 0){const T=c?To(p,c):void 0;for(const j of u){if(j.facet===null||j.facet==="super")continue;const I=d.get(j);I!==void 0&&(I.facetsIndex=j.fx!=null||j.fy!=null?To(p,I):T)}const B=new Set;for(const{facetsIndex:j}of d.values())j?.forEach((I,Y)=>{I?.length>0&&B.add(Y)});p.forEach(0<B.size&&B.size<p.length?(j,I)=>j.empty=!B.has(I):j=>j.empty=!1);for(const j of u)if(j.facet==="exclude"){const I=d.get(j);I!==void 0&&(I.facetsIndex=gg(I.facetsIndex))}}for(const T of st.keys())Te(t[T])&&T!=="fx"&&T!=="fy"&&f.set(T,[]);const m=new Map;for(const T of u){if(m.has(T))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:B,channels:j}=d.get(T)??{},{data:I,facets:Y,channels:H}=T.initialize(B,j,t);sa(H,t),m.set(T,{data:I,facets:Y,channels:H})}const x=Mo(Jn(f,m,t),t),g=e$(x,u,t);ag(x,g);const y=ou(x),{fx:w,fy:$}=y,v=w||$?lu(x,g):g,b=w||$?Ax(y,g):g,k=Dr(t),M=k.document,A=Hl("svg").call(M.documentElement);let z=A;k.ownerSVGElement=A,k.className=s,k.projection=Lg(t,v),k.filterFacets=(T,B)=>To(p,{channels:B,groups:So(T,B)}),k.getMarkState=T=>{const B=m.get(T),j=d.get(T);return{...B,channels:{...B.channels,...j?.channels}}},k.dispatchValue=T=>{z.value!==T&&(z.value=T,z.dispatchEvent(new Event("input",{bubbles:!0})))};const S=new Set;for(const[T,B]of m)if(T.initializer!=null){const j=T.facet==="super"?b:v,I=T.initializer(B.data,B.facets,B.channels,y,j,k);if(I.data!==void 0&&(B.data=I.data),I.facets!==void 0&&(B.facets=I.facets),I.channels!==void 0){const{fx:Y,fy:H,...G}=I.channels;px(G),Object.assign(B.channels,G);for(const X of Object.values(G)){const{scale:W}=X;W!=null&&!ty(st.get(W))&&(rf(X,t),S.add(W))}(Y!=null||H!=null)&&d.set(T,!0)}}if(S.size){const T=new Map;Jn(T,m,t,Y=>S.has(Y)),Jn(f,m,t,Y=>S.has(Y));const B=Mx(Mo(T,t),x),{scales:j,...I}=ou(B);Object.assign(x,B),Object.assign(y,I),Object.assign(y.scales,j)}let L,C;p!==void 0&&(L={x:w?.domain(),y:$?.domain()},p=mg(p,L),C=yg(w,$,g));for(const[T,B]of m)B.values=T.scale(B.channels,y,k);const{width:E,height:O}=g;he(A).attr("class",s).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",E).attr("height",O).attr("viewBox",`0 0 ${E} ${O}`).attr("aria-label",a).attr("aria-description",l).call(T=>T.append("style").text(`:where(.${s}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${s} text),
:where(.${s} tspan) {
  white-space: pre;
}`)).call(Fo,n);for(const T of u){const{channels:B,values:j,facets:I}=m.get(T);if(p===void 0||T.facet==="super"){let Y=null;if(I&&(Y=I[0],Y=T.filter(Y,B,j),Y.length===0))continue;const H=T.render(Y,y,j,b,k);if(H==null)continue;A.appendChild(H)}else{let Y;for(const H of p){if(!(T.facetAnchor?.(p,L,H)??!H.empty))continue;let G=null;if(I){const W=d.has(T);if(G=I[W?H.i:0],G=T.filter(G,B,j),G.length===0)continue;!W&&G===I[0]&&(G=Ie(G)),G.fx=H.x,G.fy=H.y,G.fi=H.i}const X=T.render(G,y,j,v,k);if(X!=null){(Y??=he(A).append("g")).append(()=>X).datum(H);for(const W of["aria-label","aria-description","aria-hidden","transform"])X.hasAttribute(W)&&(Y.attr(W,X.getAttribute(W)),X.removeAttribute(W))}}Y?.selectChildren().attr("transform",C)}}const R=D$(x,k,t),{figure:N=r!=null||i!=null||o!=null||R.length>0}=t;N&&(z=M.createElement("figure"),z.className=`${s}-figure`,z.style.maxWidth="initial",r!=null&&z.append(ef(M,r,"h2")),i!=null&&z.append(ef(M,i,"h3")),z.append(...R,A),o!=null&&z.append(fx(M,o)),"value"in A&&(z.value=A.value,delete A.value)),z.scale=hg(y.scales),z.legend=W$(x,k,t);const F=Py();return F>0&&he(A).append("text").attr("x",E).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("\u26A0\uFE0F").append("title").text(`${F.toLocaleString("en-US")} warning${F===1?"":"s"}. Please check the console.`),z}function ef(t,e,n){if(e.ownerDocument)return e;const r=t.createElement(n);return r.append(e),r}function fx(t,e){const n=t.createElement("figcaption");return n.append(e),n}function nf(t){return t.flat(1/0).filter(e=>e!=null).map(dx)}function dx(t){return typeof t.render=="function"?t:new hx(t)}let hx=class extends et{constructor(e){if(typeof e!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=e}render(){}};function sa(t,e){for(const n in t)rf(t[n],e);return t}function rf(t,e){const{scale:n,transform:r=!0}=t;if(n==null||!r)return;const{type:i,percent:o,interval:a,transform:l=o?s=>s==null?NaN:s*100:gs(a,i)}=e[n]??{};l!=null&&(t.value=J(t.value,l),t.transform=!1)}function px(t){for(const e in t)js(e,t[e])}function Jn(t,e,n,r=Dm){for(const{channels:i}of e.values())for(const o in i){const a=i[o],{scale:l}=a;if(l!=null&&r(l))if(l==="projection"){if(!Eg(n)){const s=n.x?.domain===void 0,u=n.y?.domain===void 0;if(s||u){const[c,d]=Cg(a);s&&ua(t,"x",c),u&&ua(t,"y",d)}}}else ua(t,l,a)}return t}function ua(t,e,n){const r=t.get(e);r!==void 0?r.push(n):t.set(e,[n])}function mx(t,e){if(t==null)return;const{x:n,y:r}=t;if(n==null&&r==null)return;const i=Ze(t.data);if(i==null)throw new Error("missing facet data");const o={};n!=null&&(o.fx=Xn(i,{value:n,scale:"fx"})),r!=null&&(o.fy=Xn(i,{value:r,scale:"fy"})),sa(o,e);const a=So(i,o);return{channels:o,groups:a,data:t.data}}function of(t,e,n){if(t.facet===null||t.facet==="super")return;const{fx:r,fy:i}=t;if(r!=null||i!=null){const s=Ze(t.data??r??i);if(s===void 0)throw new Error(`missing facet data in ${t.ariaLabel}`);if(s===null)return;const u={};return r!=null&&(u.fx=Xn(s,{value:r,scale:"fx"})),i!=null&&(u.fy=Xn(s,{value:i,scale:"fy"})),sa(u,n),{channels:u,groups:So(s,u)}}if(e===void 0)return;const{channels:o,groups:a,data:l}=e;if(t.facet!=="auto"||t.data===l)return{channels:o,groups:a};l.length>0&&(a.size>1||a.size===1&&o.fx&&o.fy&&[...a][0][1].size>1)&&Bn(Ze(t.data))===Bn(l)&&ue(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn\u2019t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function yx(t,e={}){return Lt({...e,x:null,y:null},(n,r,i,o,a,l)=>l.getMarkState(t))}function gx(t){const e=[];for(const n of t){let r=n.tip;if(r){r===!0?r={}:typeof r=="string"&&(r={pointer:r});let{pointer:i,preferredAnchor:o}=r;i=/^x$/i.test(i)?Yo:/^y$/i.test(i)?Pr:qo,r=i(yx(n,r)),r.title=null,o===void 0&&(r.preferredAnchor=i===Pr?"left":"bottom");const a=Uc(n.data,r);a.facet=n.facet,a.facetAnchor=n.facetAnchor,e.push(a)}}return e}function $x(t,e,n){let{projection:r,x:i={},y:o={},fx:a={},fy:l={},axis:s,grid:u,facet:c={},facet:{axis:d=s,grid:f}=c,x:{axis:h=s,grid:p=h===null?null:u}=i,y:{axis:m=s,grid:x=m===null?null:u}=o,fx:{axis:g=d,grid:y=g===null?null:f}=a,fy:{axis:w=d,grid:$=w===null?null:f}=l}=n;(r||!Te(i)&&!af("x",t))&&(h=p=null),(r||!Te(o)&&!af("y",t))&&(m=x=null),e.has("fx")||(g=y=null),e.has("fy")||(w=$=null),h===void 0&&(h=!ui(t,"x")),m===void 0&&(m=!ui(t,"y")),g===void 0&&(g=!ui(t,"fx")),w===void 0&&(w=!ui(t,"fy")),h===!0&&(h="bottom"),m===!0&&(m="left"),g===!0&&(g=h==="top"||h===null?"bottom":"top"),w===!0&&(w=m==="right"||m===null?"left":"right");const v=[];return si(v,$,kc,l),li(v,w,$c,"right","left",c,l),si(v,y,Ac,a),li(v,g,xc,"top","bottom",c,a),si(v,x,vc,o),li(v,m,Ko,"left","right",n,o),si(v,p,Mc,i),li(v,h,Qo,"bottom","top",n,i),v}function li(t,e,n,r,i,o,a){if(!e)return;const l=xx(e);a=wx(l?r:e,o,a);const{line:s}=a;(n===Ko||n===Qo)&&s&&!nn(s)&&t.push(aa(bx(a))),t.push(n(a)),l&&t.push(n({...a,anchor:i,label:null}))}function si(t,e,n,r){!e||nn(e)||t.push(n(vx(e,r)))}function xx(t){return/^\s*both\s*$/i.test(t)}function wx(t,e,{line:n=e.line,ticks:r,tickSize:i,tickSpacing:o,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:u,ariaLabel:c,ariaDescription:d,label:f=e.label,labelAnchor:h,labelArrow:p=e.labelArrow,labelOffset:m}){return{anchor:t,line:n,ticks:r,tickSize:i,tickSpacing:o,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:u,ariaLabel:c,ariaDescription:d,label:f,labelAnchor:h,labelArrow:p,labelOffset:m}}function bx(t){const{anchor:e,line:n}=t;return{anchor:e,facetAnchor:e+"-empty",stroke:n===!0?void 0:n}}function vx(t,{stroke:e=Wn(t)?t:void 0,ticks:n=kx(t)?t:void 0,tickSpacing:r,ariaLabel:i,ariaDescription:o}){return{stroke:e,ticks:n,tickSpacing:r,ariaLabel:i,ariaDescription:o}}function kx(t){switch(typeof t){case"number":return!0;case"string":return!Wn(t)}return ie(t)||typeof t?.range=="function"}function ui(t,e){const n=`${e}-axis `;return t.some(r=>r.ariaLabel?.startsWith(n))}function af(t,e){for(const n of e)for(const r in n.channels){const{scale:i}=n.channels[r];if(i===t||i==="projection")return!0}return!1}function Mx(t,e){for(const n in t){const r=t[n],i=e[n];r.label===void 0&&i&&(r.label=i.label)}return t}function Ax({fx:t,fy:e},n){const{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:l,height:s}=Ao(n),u=t&&lf(t),c=e&&lf(e);return{marginTop:e?c[0]:r,marginRight:t?l-u[1]:i,marginBottom:e?s-c[1]:o,marginLeft:t?u[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:l,height:s}}function lf(t){const e=t.domain();if(e.length===0)return[0,t.bandwidth()];let n=t(e[0]),r=t(e[e.length-1]);return r<n&&([n,r]=[r,n]),[n,r+t.bandwidth()]}const Lx=new Map([["basis",Kp],["basis-closed",Qp],["basis-open",Jp],["bundle",tm],["bump-x",em],["bump-y",nm],["cardinal",rm],["cardinal-closed",im],["cardinal-open",om],["catmull-rom",am],["catmull-rom-closed",lm],["catmull-rom-open",sm],["linear",Bi],["linear-closed",um],["monotone-x",cm],["monotone-y",fm],["natural",dm],["step",hm],["step-after",pm],["step-before",mm]]);function ca(t=Bi,e){if(typeof t=="function")return t;const n=Lx.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${t}`);if(e!==void 0){if("beta"in n)return n.beta(e);if("tension"in n)return n.tension(e);if("alpha"in n)return n.alpha(e)}return n}function sf(t=gn,e){return typeof t!="function"&&`${t}`.toLowerCase()==="auto"?gn:ca(t,e)}function gn(t){return Bi(t)}function Me(t={y:"count"},e={}){[t,e]=pa(t,e);const{x:n,y:r}=e;return ha(ci(n,e,D),null,null,r,t,Kn(e))}function Ae(t={x:"count"},e={}){[t,e]=pa(t,e);const{x:n,y:r}=e;return ha(null,ci(r,e,D),n,null,t,Qn(e))}function Fe(t={fill:"count"},e={}){[t,e]=pa(t,e);const{x:n,y:r}=zx(e);return ha(n,r,null,null,t,Kn(Qn(e)))}function uf(t,e,n={}){if(n?.interval==null)return n;const{reduce:r=po}=n,i={filter:null};return n[e]!=null&&(i[e]=r),n[`${e}1`]!=null&&(i[`${e}1`]=r),n[`${e}2`]!=null&&(i[`${e}2`]=r),t(i,n)}function fa(t={}){return uf(Me,"y",je(t,"x"))}function da(t={}){return uf(Ae,"x",je(t,"y"))}function ha(t,e,n,r,{data:i=ho,filter:o=Rr,sort:a,reverse:l,...s}={},u={}){t=cf(t),e=cf(e),s=Sx(s,u),i=pf(i,D),a=a==null?void 0:df("sort",a,u),o=o==null?void 0:hf("filter",o,u),n!=null&&xe(s,"x","x1","x2")&&(n=null),r!=null&&xe(s,"y","y1","y2")&&(r=null);const[c,d]=Et(t),[f,h]=Et(t),[p,m]=Et(e),[x,g]=Et(e),[y,w]=n!=null?[n,"x"]:r!=null?[r,"y"]:[],[$,v]=Et(y),{x:b,y:k,z:M,fill:A,stroke:z,x1:S,x2:L,y1:C,y2:E,domain:O,cumulative:R,thresholds:N,interval:F,...T}=u,[B,j]=Et(M),[I]=Mt(A),[Y]=Mt(z),[H,G]=Et(I),[X,W]=Et(Y);return{..."z"in u&&{z:B||M},..."fill"in u&&{fill:H||A},..."stroke"in u&&{stroke:X||z},...jt(T,(P,_,Z)=>{const K=zr(V(P,y),Z?.[w]),nt=V(P,M),ft=V(P,I),at=V(P,Y),ht=fo(s,{z:nt,fill:ft,stroke:at}),mt=[],vt=[],Ee=K&&v([]),Oe=nt&&j([]),Fd=ft&&G([]),Dd=at&&W([]),Xa=t&&d([]),qd=t&&h([]),_a=e&&m([]),Yd=e&&g([]),Pd=Cx(t,e,P);let Xd=0;for(const Pe of s)Pe.initialize(P);a&&a.initialize(P),o&&o.initialize(P);for(const Pe of _){const Ga=[];for(const Xe of s)Xe.scope("facet",Pe);a&&a.scope("facet",Pe),o&&o.scope("facet",Pe);for(const[Xe,_d]of Be(Pe,ht))for(const[Gd,sr]of Be(_d,K))for(const[Dt,Zt]of Pd(sr))if(ht&&(Zt.z=Xe),!(o&&!o.reduce(Dt,Zt))){Ga.push(Xd++),vt.push(i.reduceIndex(Dt,P,Zt)),K&&Ee.push(Gd),nt&&Oe.push(ht===nt?Xe:nt[(Dt.length>0?Dt:sr)[0]]),ft&&Fd.push(ht===ft?Xe:ft[(Dt.length>0?Dt:sr)[0]]),at&&Dd.push(ht===at?Xe:at[(Dt.length>0?Dt:sr)[0]]),Xa&&(Xa.push(Zt.x1),qd.push(Zt.x2)),_a&&(_a.push(Zt.y1),Yd.push(Zt.y2));for(const Vd of s)Vd.reduce(Dt,Zt);a&&a.reduce(Dt,Zt)}mt.push(Ga)}return Rs(mt,a,l),{data:vt,facets:mt}}),...!xe(s,"x")&&(c?{x1:c,x2:f,x:Lr(c,f)}:{x:b,x1:S,x2:L}),...!xe(s,"y")&&(p?{y1:p,y2:x,y:Lr(p,x)}:{y:k,y1:C,y2:E}),...$&&{[w]:$},...Object.fromEntries(s.map(({name:P,output:_})=>[P,_]))}}function pa({cumulative:t,domain:e,thresholds:n,interval:r,...i},o){return[i,{cumulative:t,domain:e,thresholds:n,interval:r,...o}]}function ci(t,{cumulative:e,domain:n,thresholds:r,interval:i},o){return t={...tn(t)},t.domain===void 0&&(t.domain=n),t.cumulative===void 0&&(t.cumulative=e),t.thresholds===void 0&&(t.thresholds=r),t.interval===void 0&&(t.interval=i),t.value===void 0&&(t.value=o),t.thresholds=ff(t.thresholds,t.interval),t}function zx(t){let{x:e,y:n}=t;return e=ci(e,t),n=ci(n,t),[e.value,n.value]=Wt(e.value,n.value),{x:e,y:n}}function cf(t){if(t==null)return;const{value:e,cumulative:n,domain:r=yt,thresholds:i}=t,o=a=>{let l=V(a,e),s;if(At(l)||Ox(i)){l=J(l,fs,Float64Array);let[c,d]=typeof r=="function"?r(l):r,f=typeof i=="function"&&!Je(i)?i(l,c,d):i;typeof f=="number"&&(f=gm(c,d,f)),Je(f)&&(r===yt&&(c=f.floor(c),d=f.offset(f.floor(d))),f=f.range(c,f.offset(d))),s=f}else{l=St(l);let[c,d]=typeof r=="function"?r(l):r,f=typeof i=="function"&&!Je(i)?i(l,c,d):i;if(typeof f=="number")if(r===yt){let h=$m(c,d,f);if(isFinite(h))if(h>0){let p=Math.round(c/h),m=Math.round(d/h);p*h<=c||--p,m*h>d||++m;let x=m-p+1;f=new Float64Array(x);for(let g=0;g<x;++g)f[g]=(p+g)*h}else if(h<0){h=-h;let p=Math.round(c*h),m=Math.round(d*h);p/h<=c||--p,m/h>d||++m;let x=m-p+1;f=new Float64Array(x);for(let g=0;g<x;++g)f[g]=(p+g)/h}else f=[c];else f=[c]}else f=Ei(c,d,f);else Je(f)&&(r===yt&&(c=f.floor(c),d=f.offset(f.floor(d))),f=f.range(c,f.offset(d)));s=f}const u=[];if(s.length===1)u.push([s[0],s[0]]);else for(let c=1;c<s.length;++c)u.push([s[c-1],s[c]]);return u.bin=(n<0?Rx:n>0?Nx:ma)(u,s,l),u};return o.label=_t(e),o}function ff(t,e,n=mf){if(t===void 0)return e===void 0?n:Qe(e);if(typeof t=="string"){switch(t.toLowerCase()){case"freedman-diaconis":return ym;case"scott":return Zl;case"sturges":return Ul;case"auto":return mf}return vr(t)}return t}function Sx(t,e){return Ss(t,e,df)}function df(t,e,n){return uo(t,e,n,hf)}function hf(t,e,n){return co(t,e,n,pf)}function pf(t,e){return Nr(t,e,Ex)}function Ex(t){switch(`${t}`.toLowerCase()){case"x":return Tx;case"x1":return Bx;case"x2":return Wx;case"y":return Ix;case"y1":return jx;case"y2":return Fx;case"z":return Bs}throw new Error(`invalid bin reduce: ${t}`)}function mf(t,e,n){return Math.min(200,Zl(t,e,n))}function Ox(t){return Pm(t)||ie(t)&&At(t)}function Cx(t,e,n){const r=t?.(n),i=e?.(n);return r&&i?function*(o){const a=r.bin(o);for(const[l,[s,u]]of r.entries()){const c=i.bin(a[l]);for(const[d,[f,h]]of i.entries())yield[c[d],{data:n,x1:s,y1:f,x2:u,y2:h}]}}:r?function*(o){const a=r.bin(o);for(const[l,[s,u]]of r.entries())yield[a[l],{data:n,x1:s,x2:u}]}:function*(o){const a=i.bin(o);for(const[l,[s,u]]of i.entries())yield[a[l],{data:n,y1:s,y2:u}]}}function ma(t,e,n){return e=St(e),r=>{const i=t.map(()=>[]);for(const o of r)i[xm(e,n[o])-1]?.push(o);return i}}function Nx(t,e,n){const r=ma(t,e,n);return i=>{const o=r(i);for(let a=1,l=o.length;a<l;++a){const s=o[a-1],u=o[a];for(const c of s)u.push(c)}return o}}function Rx(t,e,n){const r=ma(t,e,n);return i=>{const o=r(i);for(let a=o.length-2;a>=0;--a){const l=o[a+1],s=o[a];for(const u of l)s.push(u)}return o}}function yf(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const Tx={reduceIndex(t,e,{x1:n,x2:r}){return yf(n,r)}},Ix={reduceIndex(t,e,{y1:n,y2:r}){return yf(n,r)}},Bx={reduceIndex(t,e,{x1:n}){return n}},Wx={reduceIndex(t,e,{x2:n}){return n}},jx={reduceIndex(t,e,{y1:n}){return n}},Fx={reduceIndex(t,e,{y2:n}){return n}},Dx={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};let fi=class extends et{constructor(e,n={}){const{x1:r,y1:i,x2:o,y2:a,z:l,curve:s,tension:u}=n;super(e,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0},z:{value:$e(n),optional:!0}},n,Dx),this.z=l,this.curve=ca(s,u)}filter(e){return e}render(e,n,r,i,o){const{x1:a,y1:l,x2:s=a,y2:u=l}=r;return U("svg:g",o).call(ot,this,i,o).call(tt,this,n,0,0).call(c=>c.selectAll().data(Au(e,[a,l,s,u],this,r)).enter().append("path").call(Q,this).call(qr,this,r).attr("d",Wi().curve(this.curve).defined(d=>d>=0).x0(d=>a[d]).y0(d=>l[d]).x1(d=>s[d]).y1(d=>u[d]))).node()}};function ya(t,e){return e===void 0?$n(t,{x:Mr,y:Tn}):new fi(t,e)}function tr(t,e){const{y:n=gt,...r}=da(e);return new fi(t,Qr(Zr({...r,y1:n,y2:void 0})))}function $n(t,e){const{x:n=gt,...r}=fa(e);return new fi(t,Jr(Kr({...r,x1:n,x2:void 0})))}const qx={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};let gf=class extends et{constructor(e,n={}){const{x1:r,y1:i,x2:o,y2:a,curve:l,tension:s}=n;super(e,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,qx),this.curve=sf(l,s),sn(this,n)}project(e,n,r){this.curve!==gn&&super.project(e,n,r)}render(e,n,r,i,o){const{x1:a,y1:l,x2:s=a,y2:u=l}=r,{curve:c}=this;return U("svg:g",o).call(ot,this,i,o).call(tt,this,n).call(d=>d.selectAll().data(e).enter().append("path").call(Q,this).attr("d",c===gn&&o.projection?Yx(o.projection,a,l,s,u):f=>{const h=Qt(),p=c(h);return p.lineStart(),p.point(a[f],l[f]),p.point(s[f],u[f]),p.lineEnd(),h}).call(ct,this,r).call(Zn,this,r,o)).node()}};function Yx(t,e,n,r,i){const o=Kt(t);return e=St(e),n=St(n),r=St(r),i=St(i),a=>o({type:"LineString",coordinates:[[e[a],n[a]],[r[a],i[a]]]})}function $f(t,{x:e,x1:n,x2:r,y:i,y1:o,y2:a,...l}={}){return[n,r]=di(e,n,r),[o,a]=di(i,o,a),new gf(t,{...l,x1:n,x2:r,y1:o,y2:a})}function di(t,e,n){if(t===void 0){if(e===void 0){if(n!==void 0)return[n]}else if(n===void 0)return[e]}else{if(e===void 0)return n===void 0?[t]:[t,n];if(n===void 0)return[t,e]}return[e,n]}const Px={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};let xf=class extends et{constructor(e,n={}){const{x1:r,y1:i,x2:o,y2:a,bend:l=0,headAngle:s=60,headLength:u=8,inset:c=0,insetStart:d=c,insetEnd:f=c,sweep:h}=n;super(e,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,Px),this.bend=l===!0?22.5:Math.max(-90,Math.min(90,l)),this.headAngle=+s,this.headLength=+u,this.insetStart=+d,this.insetEnd=+f,this.sweep=Xx(h)}render(e,n,r,i,o){const{x1:a,y1:l,x2:s=a,y2:u=l,SW:c}=r,{strokeWidth:d,bend:f,headAngle:h,headLength:p,insetStart:m,insetEnd:x}=this,g=c?$=>c[$]:wt(d===void 0?1:d),y=h*Xr/2,w=p/1.5;return U("svg:g",o).call(ot,this,i,o).call(tt,this,n).call($=>$.selectAll().data(e).enter().append("path").call(Q,this).attr("d",v=>{let b=a[v],k=l[v],M=s[v],A=u[v];const z=Math.hypot(M-b,A-k);if(z<=m+x)return null;let S=Math.atan2(A-k,M-b);const L=Math.min(w*g(v),z/3),C=this.sweep(b,k,M,A)*f*Xr,E=Math.hypot(z/Math.tan(C),z)/2;if(m||x)if(E<1e5){const H=Math.sign(C),[G,X]=_x([b,k],[M,A],E,H);if(m&&([b,k]=wf([G,X,E],[b,k,m],-H*Math.sign(m))),x){const[W,P]=wf([G,X,E],[M,A,x],H*Math.sign(x));S+=Math.atan2(P-X,W-G)-Math.atan2(A-X,M-G),M=W,A=P}}else{const H=M-b,G=A-k,X=Math.hypot(H,G);m&&(b+=H/X*m,k+=G/X*m),x&&(M-=H/X*x,A-=G/X*x)}const O=S+C,R=O+y,N=O-y,F=M-L*Math.cos(R),T=A-L*Math.sin(R),B=M-L*Math.cos(N),j=A-L*Math.sin(N),I=E<1e5?`A${E},${E} 0,0,${C>0?1:0} `:"L",Y=L?`M${F},${T}L${M},${A}L${B},${j}`:"";return`M${b},${k}${I}${M},${A}${Y}`}).call(ct,this,r)).node()}};function Xx(t=1){if(typeof t=="number")return wt(Math.sign(t));if(typeof t=="function")return(e,n,r,i)=>Math.sign(t(e,n,r,i));switch(Ot(t,"sweep",["+x","-x","+y","-y"])){case"+x":return(e,n,r)=>ur(e,r);case"-x":return(e,n,r)=>_e(e,r);case"+y":return(e,n,r,i)=>ur(n,i);case"-y":return(e,n,r,i)=>_e(n,i)}}function _x([t,e],[n,r],i,o){const a=n-t,l=r-e,s=Math.hypot(a,l),u=o*Math.sqrt(i*i-s*s/4)/s;return[(t+n)/2-l*u,(e+r)/2+a*u]}function wf([t,e,n],[r,i,o],a){const l=r-t,s=i-e,u=Math.hypot(l,s),c=(l*l+s*s-o*o+n*n)/(2*u),d=a*Math.sqrt(n*n-c*c);return[t+(l*c+s*d)/u,e+(s*c-l*d)/u]}function Gx(t,{x:e,x1:n,x2:r,y:i,y1:o,y2:a,...l}={}){return[n,r]=di(e,n,r),[o,a]=di(i,o,a),new xf(t,{...l,x1:n,x2:r,y1:o,y2:a})}const Vx={ariaLabel:"bar"};let ga=class extends et{constructor(e,n,r={},i=Vx){super(e,n,r,i),na(this,r),ra(this,r)}render(e,n,r,i,o){const{rx:a,ry:l,rx1y1:s,rx1y2:u,rx2y1:c,rx2y2:d}=this,f=this._x(n,r,i),h=this._y(n,r,i),p=this._width(n,r,i),m=this._height(n,r,i);return U("svg:g",o).call(ot,this,i,o).call(this._transform,this,n).call(x=>x.selectAll().data(e).enter().call(s||u||c||d?g=>g.append("path").call(Q,this).call(ia,f,h,bf(f,p),bf(h,m),this).call(ct,this,r):g=>g.append("rect").call(Q,this).attr("x",f).attr("width",p).attr("y",h).attr("height",m).call(q,"rx",a).call(q,"ry",l).call(ct,this,r))).node()}_x(e,{x:n},{marginLeft:r}){const{insetLeft:i}=this;return n?o=>n[o]+i:r+i}_y(e,{y:n},{marginTop:r}){const{insetTop:i}=this;return n?o=>n[o]+i:r+i}_width({x:e},{x:n},{marginRight:r,marginLeft:i,width:o}){const{insetLeft:a,insetRight:l}=this,s=n&&e?e.bandwidth():o-r-i;return Math.max(0,s-a-l)}_height({y:e},{y:n},{marginTop:r,marginBottom:i,height:o}){const{insetTop:a,insetBottom:l}=this,s=n&&e?e.bandwidth():o-r-i;return Math.max(0,s-a-l)}};function bf(t,e){return typeof t=="function"&&typeof e=="function"?n=>t(n)+e(n):typeof t=="function"?n=>t(n)+e:typeof e=="function"?n=>t+e(n):t+e}let $a=class extends ga{constructor(e,n={},r){const{x1:i,x2:o,y:a}=n;super(e,{x1:{value:i,scale:"x"},x2:{value:o,scale:"x"},y:{value:a,scale:"y",type:"band",optional:!0}},n,r)}_transform(e,n,{x:r}){e.call(tt,n,{x:r},0,0)}_x({x:e},{x1:n,x2:r},{marginLeft:i}){const{insetLeft:o}=this;return Vt(e)?i+o:a=>Math.min(n[a],r[a])+o}_width({x:e},{x1:n,x2:r},{marginRight:i,marginLeft:o,width:a}){const{insetLeft:l,insetRight:s}=this;return Vt(e)?a-i-o-l-s:u=>Math.max(0,Math.abs(r[u]-n[u])-l-s)}},xa=class extends ga{constructor(e,n={},r){const{x:i,y1:o,y2:a}=n;super(e,{y1:{value:o,scale:"y"},y2:{value:a,scale:"y"},x:{value:i,scale:"x",type:"band",optional:!0}},n,r)}_transform(e,n,{y:r}){e.call(tt,n,{y:r},0,0)}_y({y:e},{y1:n,y2:r},{marginTop:i}){const{insetTop:o}=this;return Vt(e)?i+o:a=>Math.min(n[a],r[a])+o}_height({y:e},{y1:n,y2:r},{marginTop:i,marginBottom:o,height:a}){const{insetTop:l,insetBottom:s}=this;return Vt(e)?a-i-o-l-s:u=>Math.max(0,Math.abs(r[u]-n[u])-l-s)}};function De(t,e={}){return Ke(e)||(e={...e,y:gt,x2:D}),new $a(t,Qr(Go(Zr(e))))}function qe(t,e={}){return Ke(e)||(e={...e,x:gt,y2:D}),new xa(t,Jr(Vo(Kr(e))))}const Hx={ariaLabel:"cell"};let hi=class extends ga{constructor(e,{x:n,y:r,...i}={}){super(e,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:r,scale:"y",type:"band",optional:!0}},i,Hx)}_transform(e,n){e.call(tt,n,{},0,0)}};function xn(t,{x:e,y:n,...r}={}){return[e,n]=Wt(e,n),new hi(t,{...r,x:e,y:n})}function Ux(t,{x:e=gt,fill:n,stroke:r,...i}={}){return n===void 0&&Mt(r)[0]===void 0&&(n=D),new hi(t,{...i,x:e,fill:n,stroke:r})}function Zx(t,{y:e=gt,fill:n,stroke:r,...i}={}){return n===void 0&&Mt(r)[0]===void 0&&(n=D),new hi(t,{...i,y:e,fill:n,stroke:r})}const Kx={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function wa(t){return t.sort===void 0&&t.reverse===void 0?Ls({channel:"-r"},t):t}let pi=class extends et{constructor(e,n={}){const{x:r,y:i,r:o,rotate:a,symbol:l=zi,frameAnchor:s}=n,[u,c]=dt(a,0),[d,f]=iy(l),[h,p]=dt(o,d==null?3:4.5);super(e,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:h,scale:"r",filter:Jt,optional:!0},rotate:{value:u,optional:!0},symbol:{value:d,scale:"auto",optional:!0}},wa(n),Kx),this.r=p,this.rotate=c,this.symbol=f,this.frameAnchor=jn(s);const{channels:m}=this,{symbol:x}=m;if(x){const{fill:g,stroke:y}=m;x.hint={fill:g?g.value===x.value?"color":"currentColor":this.fill??"currentColor",stroke:y?y.value===x.value?"color":"currentColor":this.stroke??"none"}}}render(e,n,r,i,o){const{x:a,y:l}=n,{x:s,y:u,r:c,rotate:d,symbol:f}=r,{r:h,rotate:p,symbol:m}=this,[x,g]=Ht(this,i),y=m===zi,w=c?void 0:h*h*Math.PI;return xr(h)&&(e=[]),U("svg:g",o).call(ot,this,i,o).call(tt,this,{x:s&&a,y:u&&l}).call($=>$.selectAll().data(e).enter().append(y?"circle":"path").call(Q,this).call(y?v=>{v.attr("cx",s?b=>s[b]:x).attr("cy",u?b=>u[b]:g).attr("r",c?b=>c[b]:h)}:v=>{v.attr("transform",un`translate(${s?b=>s[b]:x},${u?b=>u[b]:g})${d?b=>` rotate(${d[b]})`:p?` rotate(${p})`:""}`).attr("d",c&&f?b=>{const k=Qt();return f[b].draw(k,c[b]*c[b]*Math.PI),k}:c?b=>{const k=Qt();return m.draw(k,c[b]*c[b]*Math.PI),k}:f?b=>{const k=Qt();return f[b].draw(k,w),k}:(()=>{const b=Qt();return m.draw(b,w),b})())}).call(ct,this,r)).node()}};function Le(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wt(e,n)),new pi(t,{...r,x:e,y:n})}function Qx(t,{x:e=D,...n}={}){return new pi(t,Pu({...n,x:e}))}function Jx(t,{y:e=D,...n}={}){return new pi(t,Yu({...n,y:e}))}function t1(t,e){return Le(t,{...e,symbol:"circle"})}function e1(t,e){return Le(t,{...e,symbol:"hexagon"})}const n1={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};let mi=class extends et{constructor(e,n={}){const{x:r,y:i,z:o,curve:a,tension:l}=n;super(e,{x:{value:r,scale:"x"},y:{value:i,scale:"y"},z:{value:$e(n),optional:!0}},n,n1),this.z=o,this.curve=sf(a,l),sn(this,n)}filter(e){return e}project(e,n,r){this.curve!==gn&&super.project(e,n,r)}render(e,n,r,i,o){const{x:a,y:l}=r,{curve:s}=this;return U("svg:g",o).call(ot,this,i,o).call(tt,this,n).call(u=>u.selectAll().data(Au(e,[a,l],this,r)).enter().append("path").call(Q,this).call(qr,this,r).call(l$,this,r,o).attr("d",s===gn&&o.projection?r1(o.projection,a,l):wm().curve(s).defined(c=>c>=0).x(c=>a[c]).y(c=>l[c]))).node()}};function r1(t,e,n){const r=Kt(t);return e=St(e),n=St(n),i=>{let o=[];const a=[o];for(const l of i)l===-1?(o=[],a.push(o)):o.push([e[l],n[l]]);return r({type:"MultiLineString",coordinates:a})}}function yi(t,{x:e,y:n,...r}={}){return[e,n]=Wt(e,n),new mi(t,{...r,x:e,y:n})}function er(t,{x:e=D,y:n=gt,...r}={}){return new mi(t,da({...r,x:e,y:n}))}function nr(t,{x:e=gt,y:n=D,...r}={}){return new mi(t,fa({...r,x:e,y:n}))}function vf(t,e){e=o1(e);const{x:n,y:r,color:i,size:o}=e,a=gi(t,n),l=gi(t,r),s=gi(t,i),u=gi(t,o);let{fx:c,fy:d,x:{value:f,reduce:h,zero:p,...m},y:{value:x,reduce:g,zero:y,...w},color:{value:$,color:v,reduce:b},size:{value:k,reduce:M},mark:A}=e;if(h===void 0&&(h=g==null&&f==null&&k==null&&x!=null?"count":null),g===void 0&&(g=h==null&&x==null&&k==null&&f!=null?"count":null),M===void 0&&k==null&&b==null&&h==null&&g==null&&(f==null||ut(a))&&(x==null||ut(l))&&(M="count"),p===void 0&&(p=$i(h)?!0:void 0),y===void 0&&(y=$i(g)?!0:void 0),f==null&&x==null)throw new Error("must specify x or y");if(h!=null&&x==null)throw new Error("reducing x requires y");if(g!=null&&f==null)throw new Error("reducing y requires x");A===void 0&&(A=k!=null||M!=null?"dot":$i(h)||$i(g)||b!=null?"bar":f!=null&&x!=null?ut(a)||ut(l)||h==null&&g==null&&!rr(a)&&!rr(l)?"dot":"line":f!=null||x!=null?"rule":null);let z,S,L;switch(A){case"dot":L=Le,S="stroke";break;case"line":L=a&&l||h!=null||g!=null?y||g!=null||a&&rr(a)?nr:p||h!=null||l&&rr(l)?er:yi:a?er:nr,S="stroke",Mf(s)&&(z=null);break;case"area":L=!(y||g!=null)&&(p||h!=null||l&&rr(l))?tr:$n,S="fill",Mf(s)&&(z=null);break;case"rule":L=a?be:ve,S="stroke";break;case"bar":L=h!=null?ut(l)?kf(h)&&a&&ut(a)?xn:De:ii:g!=null?ut(a)?kf(g)&&l&&ut(l)?xn:qe:oi:b!=null||M!=null?a&&ut(a)&&l&&ut(l)?xn:a&&ut(a)?qe:l&&ut(l)?De:oa:a&&en(a)&&!(l&&en(l))?De:l&&en(l)&&!(a&&en(a))?qe:xn,S="fill";break;default:throw new Error(`invalid mark: ${A}`)}let C={fx:c,fy:d,x:a??void 0,y:l??void 0,[S]:s??v,z,r:u??void 0,tip:!0},E,O={[S]:b??void 0,r:M??void 0};if(h!=null&&g!=null)throw new Error("cannot reduce both x and y");return g!=null?(O.y=g,E=ut(a)?Yn:Me):h!=null?(O.x=h,E=ut(l)?Pn:Ae):(b!=null||M!=null)&&(a&&l?E=ut(a)&&ut(l)?so:ut(a)?Ae:ut(l)?Me:Fe:a?E=ut(a)?Yn:Me:l&&(E=ut(l)?Pn:Ae)),(E===Fe||E===Me)&&(C.x={value:a,...m}),(E===Fe||E===Ae)&&(C.y={value:l,...w}),p===void 0&&(p=a&&!(E===Fe||E===Me)&&(L===De||L===tr||L===ii||L===ve)),y===void 0&&(y=l&&!(E===Fe||E===Ae)&&(L===qe||L===$n||L===oi||L===be)),{fx:c??null,fy:d??null,x:{value:f??null,reduce:h??null,zero:!!p,...m},y:{value:x??null,reduce:g??null,zero:!!y,...w},color:{value:$??null,reduce:b??null,...v!==void 0&&{color:v}},size:{value:k??null,reduce:M??null},mark:A,markImpl:Af[L],markOptions:C,transformImpl:Af[E],transformOptions:O,colorMode:S}}function i1(t,e){const n=vf(t,e),{fx:r,fy:i,x:{zero:o},y:{zero:a},markOptions:l,transformOptions:s,colorMode:u}=n,c=ba[n.markImpl],d=ba[n.transformImpl],f=r!=null||i!=null?aa({strokeOpacity:.1}):null,h=[o?be([0]):null,a?ve([0]):null],p=c(t,d?d(s,l):l);return u==="stroke"?It(f,h,p):It(f,p,h)}function rr(t){let e,n;for(const r of t){if(r==null)continue;if(e===void 0){e=r;continue}const i=Math.sign(ur(e,r));if(i){if(n!==void 0&&i!==n)return!1;e=r,n=i}}return!0}function o1({x:t,y:e,color:n,size:r,fx:i,fy:o,mark:a}={}){return Xt(t)||(t=wn(t)),Xt(e)||(e=wn(e)),Xt(n)||(n=Wn(n)?{color:n}:wn(n)),Xt(r)||(r=wn(r)),Xt(i)&&({value:i}=wn(i)),Xt(o)&&({value:o}=wn(o)),a!=null&&(a=`${a}`.toLowerCase()),{x:t,y:e,color:n,size:r,fx:i,fy:o,mark:a}}function gi(t,e){const n=V(t,e.value);return n&&(n.label=_t(e.value)),n}function wn(t){return a1(t)?{reduce:t}:{value:t}}function $i(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function kf(t){return/^(?:first|last|mode)$/i.test(t)}function a1(t){if(t==null)return!1;if(typeof t.reduceIndex=="function"||typeof t.reduce=="function"&&Tt(t)||/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}function Mf(t){return t?new zn(t).size>t.length>>1:!1}const ba={dot:Le,line:yi,lineX:er,lineY:nr,areaX:tr,areaY:$n,ruleX:be,ruleY:ve,barX:De,barY:qe,rect:oa,rectX:ii,rectY:oi,cell:xn,bin:Fe,binX:Me,binY:Ae,group:so,groupX:Yn,groupY:Pn},Af=Object.fromEntries(Object.entries(ba).map(([t,e])=>[e,t]));function va(t,e={}){let{x:n,x1:r,x2:i}=e;n===void 0&&r===void 0&&i===void 0&&(e={...e,x:n=D});const o={};return n!=null&&(o.x=t),r!=null&&(o.x1=t),i!=null&&(o.x2=t),Ut(o,e)}function ka(t,e={}){let{y:n,y1:r,y2:i}=e;n===void 0&&r===void 0&&i===void 0&&(e={...e,y:n=D});const o={};return n!=null&&(o.y=t),r!=null&&(o.y1=t),i!=null&&(o.y2=t),Ut(o,e)}function Ut(t={},e={}){const n=$e(e),r=Object.entries(t).map(([i,o])=>{const a=ys(i,e);if(a==null)throw new Error(`missing channel: ${i}`);const[l,s]=Ct(a);return{key:i,input:a,output:l,setOutput:s,map:l1(o)}});return{...jt(e,(i,o)=>{const a=V(i,n),l=r.map(({input:u})=>V(i,u)),s=r.map(({setOutput:u})=>u(new Array(i.length)));for(const u of o)for(const c of a?Ce(u,d=>a[d]).values():[u])r.forEach(({map:d},f)=>d.mapIndex(c,l[f],s[f]));return{data:i,facets:o}}),...Object.fromEntries(r.map(({key:i,output:o})=>[i,o]))}}function l1(t){if(t==null)throw new Error("missing map");if(typeof t.mapIndex=="function")return t;if(typeof t.map=="function"&&Tt(t))return s1(t);if(typeof t=="function")return Ma(Ui(t));switch(`${t}`.toLowerCase()){case"cumsum":return c1;case"rank":return Ma((e,n)=>Kl(e,r=>n[r]));case"quantile":return Ma((e,n)=>u1(e,r=>n[r]))}throw new Error(`invalid map: ${t}`)}function s1(t){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:t.map.bind(t)}}function u1(t,e){const n=bm(t,e)-1;return Kl(t,e).map(r=>r/n)}function Ma(t){return{mapIndex(e,n,r){const i=t(e,n);if(i.length!==e.length)throw new Error("map function returned a mismatched length");for(let o=0,a=e.length;o<a;++o)r[e[o]]=i[o]}}}const c1={mapIndex(t,e,n){let r=0;for(const i of t)n[i]=r+=e[i]}};function f1(t={},e){return arguments.length===1&&(e=t),va(xi(t),e)}function d1(t={},e){return arguments.length===1&&(e=t),ka(xi(t),e)}function xi(t={}){typeof t=="number"&&(t={k:t});let{k:e,reduce:n,shift:r,anchor:i,strict:o}=t;if(i===void 0&&r!==void 0&&(i=p1(r),ue(`Warning: the shift option is deprecated; please use anchor "${i}" instead.`)),!((e=Math.floor(e))>0))throw new Error(`invalid k: ${e}`);return m1(n)(e,h1(i,e),o)}function h1(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}function p1(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}function m1(t="mean"){if(typeof t=="string"){if(/^p\d{2}$/i.test(t))return wi(Vi(t));switch(t.toLowerCase()){case"deviation":return wi(fr);case"max":return bi((e,n)=>zt(e,r=>n[r]));case"mean":return y1;case"median":return wi(Sn);case"min":return bi((e,n)=>Nt(e,r=>n[r]));case"mode":return bi((e,n)=>al(e,r=>n[r]));case"sum":return Lf;case"variance":return wi(ll);case"difference":return x1;case"ratio":return w1;case"first":return b1;case"last":return v1}}if(typeof t!="function")throw new Error(`invalid reduce: ${t}`);return bi(Ui(t))}function wi(t){return(e,n,r)=>r?{mapIndex(i,o,a){const l=u=>o[u]==null?NaN:+o[u];let s=0;for(let u=0;u<e-1;++u)isNaN(l(u))&&++s;for(let u=0,c=i.length-e+1;u<c;++u)isNaN(l(u+e-1))&&++s,a[i[u+n]]=s===0?t(Ie(i,u,u+e),l):NaN,isNaN(l(u))&&--s}}:{mapIndex(i,o,a){const l=s=>o[s]==null?NaN:+o[s];for(let s=-n;s<0;++s)a[i[s+n]]=t(Ie(i,0,s+e),l);for(let s=0,u=i.length-n;s<u;++s)a[i[s+n]]=t(Ie(i,s,s+e),l)}}}function bi(t){return(e,n,r)=>r?{mapIndex(i,o,a){let l=0;for(let s=0;s<e-1;++s)l+=xt(o[i[s]]);for(let s=0,u=i.length-e+1;s<u;++s)l+=xt(o[i[s+e-1]]),l===e&&(a[i[s+n]]=t(Ie(i,s,s+e),o)),l-=xt(o[i[s]])}}:{mapIndex(i,o,a){for(let l=-n;l<0;++l)a[i[l+n]]=t(Ie(i,0,l+e),o);for(let l=0,s=i.length-n;l<s;++l)a[i[l+n]]=t(Ie(i,l,l+e),o)}}}function Lf(t,e,n){return n?{mapIndex(r,i,o){let a=0,l=0;for(let s=0;s<t-1;++s){const u=i[r[s]];u===null||isNaN(u)?++a:l+=+u}for(let s=0,u=r.length-t+1;s<u;++s){const c=i[r[s]],d=i[r[s+t-1]];d===null||isNaN(d)?++a:l+=+d,o[r[s+e]]=a===0?l:NaN,c===null||isNaN(c)?--a:l-=+c}}}:{mapIndex(r,i,o){let a=0;const l=r.length;for(let s=0,u=Math.min(l,t-e-1);s<u;++s)a+=+i[r[s]]||0;for(let s=-e,u=l-e;s<u;++s)a+=+i[r[s+t-1]]||0,o[r[s+e]]=a,a-=+i[r[s]]||0}}}function y1(t,e,n){if(n){const r=Lf(t,e,n);return{mapIndex(i,o,a){r.mapIndex(i,o,a);for(let l=0,s=i.length-t+1;l<s;++l)a[i[l+e]]/=t}}}else return{mapIndex(r,i,o){let a=0,l=0;const s=r.length;for(let u=0,c=Math.min(s,t-e-1);u<c;++u){let d=i[r[u]];d!==null&&!isNaN(d=+d)&&(a+=d,++l)}for(let u=-e,c=s-e;u<c;++u){let d=i[r[u+t-1]],f=i[r[u]];d!==null&&!isNaN(d=+d)&&(a+=d,++l),o[r[u+e]]=a/l,f!==null&&!isNaN(f=+f)&&(a-=f,--l)}}}}function g1(t,e,n,r){for(let i=n+r;n<i;++n){const o=t[e[n]];if(xt(o))return o}}function $1(t,e,n,r){for(let i=n+r-1;i>=n;--i){const o=t[e[i]];if(xt(o))return o}}function zf(t,e,n,r){for(let i=n+r;n<i;++n){let o=t[e[n]];if(o!==null&&!isNaN(o=+o))return o}}function Sf(t,e,n,r){for(let i=n+r-1;i>=n;--i){let o=t[e[i]];if(o!==null&&!isNaN(o=+o))return o}}function x1(t,e,n){return n?{mapIndex(r,i,o){for(let a=0,l=r.length-t;a<l;++a){const s=i[r[a]],u=i[r[a+t-1]];o[r[a+e]]=s===null||u===null?NaN:u-s}}}:{mapIndex(r,i,o){for(let a=-e,l=r.length-t+e+1;a<l;++a)o[r[a+e]]=Sf(i,r,a,t)-zf(i,r,a,t)}}}function w1(t,e,n){return n?{mapIndex(r,i,o){for(let a=0,l=r.length-t;a<l;++a){const s=i[r[a]],u=i[r[a+t-1]];o[r[a+e]]=s===null||u===null?NaN:u/s}}}:{mapIndex(r,i,o){for(let a=-e,l=r.length-t+e+1;a<l;++a)o[r[a+e]]=Sf(i,r,a,t)/zf(i,r,a,t)}}}function b1(t,e,n){return n?{mapIndex(r,i,o){for(let a=0,l=r.length-t;a<l;++a)o[r[a+e]]=i[r[a]]}}:{mapIndex(r,i,o){for(let a=-e,l=r.length-t+e+1;a<l;++a)o[r[a+e]]=g1(i,r,a,t)}}}function v1(t,e,n){return n?{mapIndex(r,i,o){for(let a=0,l=r.length-t;a<l;++a)o[r[a+e]]=i[r[a+t-1]]}}:{mapIndex(r,i,o){for(let a=-e,l=r.length-t+e+1;a<l;++a)o[r[a+e]]=$1(i,r,a,t)}}}const fe={n:20,k:2,color:"currentColor",opacity:.2,strict:!0,anchor:"end"};function k1(t,{x:e=D,y:n,k:r=fe.k,color:i=fe.color,opacity:o=fe.opacity,fill:a=i,fillOpacity:l=o,stroke:s=i,strokeOpacity:u,strokeWidth:c,...d}={}){return It(lt(a)?null:tr(t,Ut({x1:Ye({k:-r,...d}),x2:Ye({k:r,...d})},{x1:e,x2:e,y:n,fill:a,fillOpacity:l,...d})),lt(s)?null:er(t,Ut({x:Ye(d)},{x:e,y:n,stroke:s,strokeOpacity:u,strokeWidth:c,...d})))}function M1(t,{x:e,y:n=D,k:r=fe.k,color:i=fe.color,opacity:o=fe.opacity,fill:a=i,fillOpacity:l=o,stroke:s=i,strokeOpacity:u,strokeWidth:c,...d}={}){return It(lt(a)?null:$n(t,Ut({y1:Ye({k:-r,...d}),y2:Ye({k:r,...d})},{x:e,y1:n,y2:n,fill:a,fillOpacity:l,...d})),lt(s)?null:nr(t,Ut({y:Ye(d)},{x:e,y:n,stroke:s,strokeOpacity:u,strokeWidth:c,...d})))}function Ye({n:t=fe.n,k:e=0,strict:n=fe.strict,anchor:r=fe.anchor}={}){return xi({k:t,reduce:i=>cr(i)+e*(fr(i)||0),strict:n,anchor:r})}const A1={ariaLabel:"tick",fill:null,stroke:"currentColor"};let Ef=class extends et{constructor(e,n,r){super(e,n,r,A1),sn(this,r)}render(e,n,r,i,o){return U("svg:g",o).call(ot,this,i,o).call(this._transform,this,n).call(a=>a.selectAll().data(e).enter().append("line").call(Q,this).attr("x1",this._x1(n,r,i)).attr("x2",this._x2(n,r,i)).attr("y1",this._y1(n,r,i)).attr("y2",this._y2(n,r,i)).call(ct,this,r).call(Zn,this,r,o)).node()}},Of=class extends Ef{constructor(e,n={}){const{x:r,y:i,inset:o=0,insetTop:a=o,insetBottom:l=o}=n;super(e,{x:{value:r,scale:"x"},y:{value:i,scale:"y",type:"band",optional:!0}},n),this.insetTop=rt(a),this.insetBottom=rt(l)}_transform(e,n,{x:r}){e.call(tt,n,{x:r},bt,0)}_x1(e,{x:n}){return r=>n[r]}_x2(e,{x:n}){return r=>n[r]}_y1({y:e},{y:n},{marginTop:r}){const{insetTop:i}=this;return n&&e?o=>n[o]+i:r+i}_y2({y:e},{y:n},{height:r,marginBottom:i}){const{insetBottom:o}=this;return n&&e?a=>n[a]+e.bandwidth()-o:r-i-o}},Cf=class extends Ef{constructor(e,n={}){const{x:r,y:i,inset:o=0,insetRight:a=o,insetLeft:l=o}=n;super(e,{y:{value:i,scale:"y"},x:{value:r,scale:"x",type:"band",optional:!0}},n),this.insetRight=rt(a),this.insetLeft=rt(l)}_transform(e,n,{y:r}){e.call(tt,n,{y:r},0,bt)}_x1({x:e},{x:n},{marginLeft:r}){const{insetLeft:i}=this;return n&&e?o=>n[o]+i:r+i}_x2({x:e},{x:n},{width:r,marginRight:i}){const{insetRight:o}=this;return n&&e?a=>n[a]+e.bandwidth()-o:r-i-o}_y1(e,{y:n}){return r=>n[r]}_y2(e,{y:n}){return r=>n[r]}};function Nf(t,{x:e=D,...n}={}){return new Of(t,{...n,x:e})}function Rf(t,{y:e=D,...n}={}){return new Cf(t,{...n,y:e})}function L1(t,{x:e=D,y:n=null,r,fill:i="#ccc",fillOpacity:o,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:u,...c}={}){const d=n!=null?Pn:lo;return It(ve(t,d({x1:Aa,x2:La},{x:e,y:n,stroke:a,strokeOpacity:l,...c})),De(t,d({x1:"p25",x2:"p75"},{x:e,y:n,fill:i,fillOpacity:o,...c})),Nf(t,d({x:"p50"},{x:e,y:n,stroke:a,strokeOpacity:l,strokeWidth:s,sort:u,...c})),Le(t,Ut({x:Tf},{x:e,y:n,z:n,r,stroke:a,strokeOpacity:l,...c})))}function z1(t,{y:e=D,x:n=null,r,fill:i="#ccc",fillOpacity:o,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:u,...c}={}){const d=n!=null?Yn:lo;return It(be(t,d({y1:Aa,y2:La},{x:n,y:e,stroke:a,strokeOpacity:l,...c})),qe(t,d({y1:"p25",y2:"p75"},{x:n,y:e,fill:i,fillOpacity:o,...c})),Rf(t,d({y:"p50"},{x:n,y:e,stroke:a,strokeOpacity:l,strokeWidth:s,sort:u,...c})),Le(t,Ut({y:Tf},{x:n,y:e,z:n,r,stroke:a,strokeOpacity:l,...c})))}function Tf(t){const e=Aa(t),n=La(t);return t.map(r=>r<e||r>n?r:NaN)}function Aa(t){const e=If(t)*2.5-Bf(t)*1.5;return Nt(t,n=>n>=e?n:NaN)}function La(t){const e=Bf(t)*2.5-If(t)*1.5;return zt(t,n=>n<=e?n:NaN)}function If(t){return An(t,.25)}function Bf(t){return An(t,.75)}const S1={ariaLabel:"raster",stroke:null,pixelSize:1};function bn(t,e){const n=+t;if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}function Wf(t,e){const n=Math.floor(t);if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}let jf=class extends et{constructor(e,n,r={},i){let{width:o,height:a,x:l,y:s,x1:u=l==null?0:void 0,y1:c=s==null?0:void 0,x2:d=l==null?o:void 0,y2:f=s==null?a:void 0,pixelSize:h=i.pixelSize,blur:p=0,interpolate:m}=r;if(o!=null&&(o=Wf(o,"width")),a!=null&&(a=Wf(a,"height")),u!=null&&(u=bn(u,"x1")),c!=null&&(c=bn(c,"y1")),d!=null&&(d=bn(d,"x2")),f!=null&&(f=bn(f,"y2")),l==null&&(u==null||d==null))throw new Error("missing x");if(s==null&&(c==null||f==null))throw new Error("missing y");e!=null&&o!=null&&a!=null&&(l===void 0&&u!=null&&d!=null&&(l=W1(u,d,o)),s===void 0&&c!=null&&f!=null&&(s=j1(c,f,o,a))),super(e,{x:{value:l,scale:"x",optional:!0},y:{value:s,scale:"y",optional:!0},x1:{value:u==null?null:[u],scale:"x",optional:!0,filter:null},y1:{value:c==null?null:[c],scale:"y",optional:!0,filter:null},x2:{value:d==null?null:[d],scale:"x",optional:!0,filter:null},y2:{value:f==null?null:[f],scale:"y",optional:!0,filter:null},...n},r,i),this.width=o,this.height=a,this.pixelSize=bn(h,"pixelSize"),this.blur=bn(p,"blur"),this.interpolate=l==null||s==null?null:O1(m)}};class Ff extends jf{constructor(e,n={}){const{imageRendering:r}=n;if(e==null){const{fill:i,fillOpacity:o}=n;dt(o)[0]!==void 0&&(n=za("fillOpacity",n)),Mt(i)[0]!==void 0&&(n=za("fill",n))}super(e,void 0,n,S1),this.imageRendering=pt(r,"auto")}scale(e,{color:n,...r},i){return super.scale(e,r,i)}render(e,n,r,i,o){const a=n[r.channels.fill?.scale]??(O=>O),{x:l,y:s}=r,{document:u}=o,[c,d,f,h]=qf(r,i,o),p=f-c,m=h-d,{pixelSize:x,width:g=Math.round(Math.abs(p)/x),height:y=Math.round(Math.abs(m)/x)}=this,w=g*y;let{fill:$,fillOpacity:v}=r,b=0;if(this.interpolate){const O=g/p,R=y/m,N=J(l,T=>(T-c)*O,Float64Array),F=J(s,T=>(T-d)*R,Float64Array);$&&($=this.interpolate(e,g,y,N,F,$)),v&&(v=this.interpolate(e,g,y,N,F,v))}else this.data==null&&e&&(b=e.fi*w);const k=u.createElement("canvas");k.width=g,k.height=y;const M=k.getContext("2d"),A=M.createImageData(g,y),z=A.data;let{r:S,g:L,b:C}=On(this.fill)??{r:0,g:0,b:0},E=(this.fillOpacity??1)*255;for(let O=0;O<w;++O){const R=O<<2;if($){const N=a($[O+b]);if(N==null){z[R+3]=0;continue}({r:S,g:L,b:C}=On(N))}v&&(E=v[O+b]*255),z[R+0]=S,z[R+1]=L,z[R+2]=C,z[R+3]=E}return this.blur>0&&vm(A,this.blur),M.putImageData(A,0,0),U("svg:g",o).call(ot,this,i,o).call(tt,this,n).call(O=>O.append("image").attr("transform",`translate(${c},${d}) scale(${Math.sign(f-c)},${Math.sign(h-d)})`).attr("width",Math.abs(p)).attr("height",Math.abs(m)).attr("preserveAspectRatio","none").call(q,"image-rendering",this.imageRendering).call(Q,this).attr("xlink:href",k.toDataURL())).node()}}function Df(t,e,n){arguments.length<3&&(n=e,e=null);let{x:r,y:i,[t]:o,...a}=n;return r===void 0&&i===void 0&&_m(e)&&(r=Mr,i=Tn,o===void 0&&(o=qm)),[e,{...a,x:r,y:i,[t]:o}]}function E1(){const[t,e]=Df("fill",...arguments);return new Ff(t,t==null||e.fill!==void 0||e.fillOpacity!==void 0?e:{...e,fill:D})}function qf({x1:t,y1:e,x2:n,y2:r},i,{projection:o}){const{width:a,height:l,marginTop:s,marginRight:u,marginBottom:c,marginLeft:d}=i;return[t&&o==null?t[0]:d,e&&o==null?e[0]:s,n&&o==null?n[0]:a-u,r&&o==null?r[0]:l-c]}function Yf({x1:t,y1:e,x2:n,y2:r},i,o,a){const l={};return t&&(l.x1=t),e&&(l.y1=e),n&&(l.x2=n),r&&(l.y2=r),qf(mo(l,i),o,a)}function za(t,e={}){const{[t]:n}=e;if(typeof n!="function")throw new Error(`invalid ${t}: not a function`);return Lt({...e,[t]:void 0},function(r,i,o,a,l,s){const{x:u,y:c}=a;if(!u)throw new Error("missing scale: x");if(!c)throw new Error("missing scale: y");const[d,f,h,p]=Yf(o,a,l,s),m=h-d,x=p-f,{pixelSize:g}=this,{width:y=Math.round(Math.abs(m)/g),height:w=Math.round(Math.abs(x)/g)}=e,$=new Array(y*w*(i?i.length:1)),v=m/y,b=x/w;let k=0;for(const M of i??[void 0])for(let A=.5;A<w;++A)for(let z=.5;z<y;++z,++k)$[k]=n(u.invert(d+z*v),c.invert(f+A*b),M);return{data:$,facets:i,channels:{[t]:{value:$,scale:"auto"}}}})}function O1(t){if(typeof t=="function")return t;if(t==null)return Sa;switch(`${t}`.toLowerCase()){case"none":return Sa;case"nearest":return Xf;case"barycentric":return Pf();case"random-walk":return _f()}throw new Error(`invalid interpolate: ${t}`)}function Sa(t,e,n,r,i,o){const a=new Array(e*n);for(const l of t)r[l]<0||r[l]>=e||i[l]<0||i[l]>=n||(a[Math.floor(i[l])*e+Math.floor(r[l])]=o[l]);return a}function Pf({random:t=Si(42)}={}){return(e,n,r,i,o,a)=>{const{points:l,triangles:s,hull:u}=Ge.from(e,h=>i[h],h=>o[h]),c=new a.constructor(n*r).fill(NaN),d=new Uint8Array(n*r),f=B1(a,t);for(let h=0;h<s.length;h+=3){const p=s[h],m=s[h+1],x=s[h+2],g=l[2*p],y=l[2*m],w=l[2*x],$=l[2*p+1],v=l[2*m+1],b=l[2*x+1],k=Math.min(g,y,w),M=Math.max(g,y,w),A=Math.min($,v,b),z=Math.max($,v,b),S=(v-b)*(g-w)+($-b)*(w-y);if(!S)continue;const L=a[e[p]],C=a[e[m]],E=a[e[x]];for(let O=Math.floor(k);O<M;++O)for(let R=Math.floor(A);R<z;++R){if(O<0||O>=n||R<0||R>=r)continue;const N=O+.5,F=R+.5,T=Math.sign(S),B=(v-b)*(N-w)+(F-b)*(w-y);if(B*T<0)continue;const j=(b-$)*(N-w)+(F-b)*(g-w);if(j*T<0)continue;const I=S-(B+j);if(I*T<0)continue;const Y=O+n*R;c[Y]=f(L,B/S,C,j/S,E,I/S,O,R),d[Y]=1}}return C1(c,d,i,o,a,n,r,u,e,f),c}}function C1(t,e,n,r,i,o,a,l,s,u){n=Float64Array.from(l,h=>n[s[h]]),r=Float64Array.from(l,h=>r[s[h]]),i=Array.from(l,h=>i[s[h]]);const c=n.length,d=Array.from({length:c},(h,p)=>R1(p,n,r));let f=0;for(let h=0;h<a;++h){const p=h+.5;for(let m=0;m<o;++m){const x=m+o*h;if(!e[x]){const g=m+.5;for(let y=0;y<c;++y){const w=(c+f+(y%2?(y+1)/2:-y/2))%c;if(d[w](g,p)){const $=N1(n.at(w-1),r.at(w-1),n[w],r[w],g,p);t[x]=u(i.at(w-1),$,i[w],1-$,i[w],0,m,h),f=w;break}}}}}}function N1(t,e,n,r,i,o){const a=n-t,l=r-e,s=a*(n-i)+l*(r-o),u=a*(i-t)+l*(o-e);return s>0&&u>0?s/(s+u):+(s>u)}function ir(t,e,n,r){return t*r-n*e}function R1(t,e,n){const r=e.length,i=e.at(t-2),o=n.at(t-2),a=e.at(t-1),l=n.at(t-1),s=e[t],u=n[t],c=e.at(t+1-r),d=n.at(t+1-r),f=a-s,h=l-u,p=i-a,m=o-l,x=s-c,g=u-d,y=Math.hypot(f,h),w=Math.hypot(p,m),$=Math.hypot(x,g);return(v,b)=>{const k=v-a,M=b-l,A=v-s,z=b-u;return ir(k,M,A,z)>-1e-6&&ir(k,M,f,h)*w-ir(k,M,p,m)*y>-1e-6&&ir(A,z,x,g)*y-ir(A,z,f,h)*$<=0}}function Xf(t,e,n,r,i,o){const a=new o.constructor(e*n),l=Ge.from(t,c=>r[c],c=>i[c]);let s,u;for(let c=.5,d=0;c<n;++c){u=s;for(let f=.5;f<e;++f,++d)u=l.find(f,c,u),f===.5&&(s=u),a[d]=o[t[u]]}return a}function _f({random:t=Si(42),minDistance:e=.5,maxSteps:n=2}={}){return(r,i,o,a,l,s)=>{const u=new s.constructor(i*o),c=Ge.from(r,p=>a[p],p=>l[p]);let d,f,h;for(let p=.5,m=0;p<o;++p){f=d;for(let x=.5;x<i;++x,++m){let g=x,y=p;h=f=c.find(g,y,f),x===.5&&(d=f);let w,$=0;for(;(w=Math.hypot(a[r[h]]-g,l[r[h]]-y))>e&&$<n;){const v=t(x,p,$)*2*Math.PI;g+=Math.cos(v)*w,y+=Math.sin(v)*w,h=c.find(g,y,h),++$}u[m]=s[r[h]]}}return u}}function T1(t,e,n,r,i,o){return e*t+r*n+o*i}function I1(t){return(e,n,r,i,o,a,l,s)=>{const u=t(l,s);return u<n?e:u<n+i?r:o}}function B1(t,e){return en(t)||At(t)?T1:I1(e)}function W1(t,e,n){return{transform(r){const i=r.length,o=new Float64Array(i),a=(e-t)/n,l=t+a/2;for(let s=0;s<i;++s)o[s]=s%n*a+l;return o}}}function j1(t,e,n,r){return{transform(i){const o=i.length,a=new Float64Array(o),l=(e-t)/r,s=t+l/2;for(let u=0;u<o;++u)a[u]=Math.floor(u/n)%r*l+s;return a}}}const Gf={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};let Vf=class extends jf{constructor(e,{smooth:n=!0,value:r,...i}={}){const o=Mu({},i,Gf);if(r===void 0){for(const l in o)if(o[l].value!=null){if(r!==void 0)throw new Error("ambiguous contour value");r=i[l],i[l]="value"}}if(r!=null){const l={transform:s=>s.map(u=>u.value),label:_t(r)};for(const s in o)i[s]==="value"&&(i[s]=l)}if(e==null){if(r==null)throw new Error("missing contour value");i=za("value",{value:r,...i}),r=null}else{let{interpolate:l}=i;r===void 0&&(r=D),l===void 0&&(i.interpolate="nearest")}super(e,{value:{value:r,optional:!0}},F1(i),Gf);const a={geometry:{value:D}};for(const l in this.channels){const s=this.channels[l],{scale:u}=s;u==="x"||u==="y"||l==="value"||(a[l]=s,delete this.channels[l])}this.contourChannels=a,this.smooth=!!n}filter(e,{x:n,y:r,value:i,...o},a){return super.filter(e,o,a)}render(e,n,r,i,o){const{geometry:a}=r,l=Kt();return U("svg:g",o).call(ot,this,i,o).call(tt,this,n).call(s=>{s.selectAll().data(e).enter().append("path").call(Q,this).attr("d",u=>l(a[u])).call(ct,this,r)}).node()}};function F1({thresholds:t,interval:e,...n}){return t=ff(t,e,Ul),Lt(n,function(r,i,o,a,l,s){const[u,c,d,f]=Yf(o,a,l,s),h=d-u,p=f-c,{pixelSize:m,width:x=Math.round(Math.abs(h)/m),height:g=Math.round(Math.abs(p)/m)}=this,y=x/h,w=g/p,$=o.value.value,v=[];if(this.interpolate){const{x:z,y:S}=Hn(o,a,s),L=J(z,R=>(R-u)*y,Float64Array),C=J(S,R=>(R-c)*w,Float64Array),E=[o.x,o.y,o.value],O=[L,C,$];for(const R of i){const N=this.filter(R,E,O);v.push(this.interpolate(N,x,g,L,C,$))}}else if(i){const z=x*g,S=i.length;for(let L=0;L<S;++L)v.push($.slice(L*z,L*z+z))}else v.push($);if(this.blur>0)for(const z of v)km({data:z,width:x,height:g},this.blur);const b=D1(t,$,...Y1(v));if(b===null)throw new Error(`unsupported thresholds: ${t}`);const{contour:k}=Mm().size([x,g]).smooth(this.smooth),M=[],A=[];for(const z of v)A.push(Mn(M.length,M.push(...J(b,S=>k(z,S)))));for(const{coordinates:z}of M)for(const S of z)for(const L of S)for(const C of L)C[0]=C[0]/y+u,C[1]=C[1]/w+c;return{data:M,facets:A,channels:Ws(this.contourChannels,M)}})}function D1(t,e,n,r){if(typeof t?.range=="function")return t.range(t.floor(n),r);if(typeof t=="function"&&(t=t(e,n,r)),typeof t!="number")return ee(t);const i=Ei(...Am(n,r,t),t);for(;i[i.length-1]>=r;)i.pop();for(;i[1]<n;)i.shift();return i}function q1(){return new Vf(...Df("value",...arguments))}function Y1(t){return[Nt(t,e=>Nt(e,Hf)),zt(t,e=>zt(e,Hf))]}function Hf(t){return isFinite(t)?t:NaN}function P1(t,e){return Ea(qo,t,e)}function X1(t,e={}){return Ea(Yo,t,e)}function _1(t,e={}){return Ea(Pr,t,e)}function Ea(t,e,n={}){const{x:r,y:i,maxRadius:o}=n,a=t({px:r,py:i,maxRadius:o}),l=[];r!=null&&l.push(be(e,Zf("x",{...a,inset:-6},n))),i!=null&&l.push(ve(e,Zf("y",{...a,inset:-6},n))),r!=null&&l.push(cn(e,Kf("x",{...a,dy:9,frameAnchor:"bottom",lineAnchor:"top"},n))),i!=null&&l.push(cn(e,Kf("y",{...a,dx:-9,frameAnchor:"left",textAnchor:"end"},n)));for(const s of l)s.ariaLabel=`crosshair ${s.ariaLabel}`;return It(...l)}function Uf(t,{channels:e,...n},{facet:r,facetAnchor:i,fx:o,fy:a,[t]:l,channels:s,transform:u,initializer:c}){return{...n,facet:r,facetAnchor:i,fx:o,fy:a,[t]:l,channels:{...e,...s},transform:u,initializer:G1(t,c)}}function G1(t,e){return e==null?e:function(n,r,{x:i,y:o,px:a,py:l,...s},...u){const{channels:{x:c,y:d,...f}={},...h}=e.call(this,n,r,{...s,x:a,y:l},...u);return{channels:{...f,...c&&{px:c,...t==="x"&&{x:c}},...d&&{py:d,...t==="y"&&{y:d}}},...h}}}function Zf(t,e,n){const{color:r="currentColor",opacity:i=.2,ruleStroke:o=r,ruleStrokeOpacity:a=i,ruleStrokeWidth:l}=n;return{...Uf(t,e,n),stroke:o,strokeOpacity:a,strokeWidth:l}}function Kf(t,e,n){const{color:r="currentColor",textFill:i=r,textFillOpacity:o,textStroke:a="var(--plot-background)",textStrokeOpacity:l,textStrokeWidth:s=5}=n;return{...Uf(t,e,V1(t,n)),fill:i,fillOpacity:o,stroke:a,strokeOpacity:l,strokeWidth:s}}function V1(t,e){return Lt(e,(n,r,i)=>({channels:{text:{value:go(i,t)?.value}}}))}const H1={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},U1={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},Z1={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},K1={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Q1={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};let J1=class extends et{constructor(e,n={}){const{x:r,y:i,z:o,curve:a,tension:l}=n;super(e,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:o,optional:!0}},n,H1),this.curve=ca(a,l),sn(this,n)}render(e,n,r,i,o){const{x:a,y:l}=n,{x:s,y:u,z:c}=r,{curve:d}=this,[f,h]=Ht(this,i),p=s?y=>s[y]:wt(f),m=u?y=>u[y]:wt(h),x=this;function g(y){let w=-1;const $=[],v={};for(const E in r)v[E]=[];const b=[],k=[],M=[],A=[];function z(E,O){E=y[E],O=y[O],$.push(++w),b[w]=p(E),M[w]=m(E),k[w]=p(O),A[w]=m(O);for(const R in r)v[R].push(r[R][O])}const{halfedges:S,hull:L,triangles:C}=Ge.from(y,p,m);for(let E=0;E<S.length;++E){const O=S[E];O>E&&z(C[E],C[O])}for(let E=0;E<L.length;++E)z(L[E],L[(E+1)%L.length]);he(this).selectAll().data($).enter().append("path").call(Q,x).attr("d",E=>{const O=Qt(),R=d(O);return R.lineStart(),R.point(b[E],M[E]),R.point(k[E],A[E]),R.lineEnd(),O}).call(ct,x,v).call(Zn,x,v,o)}return U("svg:g",o).call(ot,this,i,o).call(tt,this,{x:s&&a,y:u&&l}).call(c?y=>y.selectAll().data(Ce(e,w=>c[w]).values()).enter().append("g").each(g):y=>y.datum(e).each(g)).node()}},Oa=class extends et{constructor(e,n={},r,i=({z:o})=>o){const{x:o,y:a}=n;super(e,{x:{value:o,scale:"x",optional:!0},y:{value:a,scale:"y",optional:!0},z:{value:i(n),optional:!0}},n,r)}render(e,n,r,i,o){const{x:a,y:l}=n,{x:s,y:u,z:c}=r,[d,f]=Ht(this,i),h=s?g=>s[g]:wt(d),p=u?g=>u[g]:wt(f),m=this;function x(g){const y=Ge.from(g,h,p);he(this).append("path").datum(g[0]).call(Q,m).attr("d",m._render(y,i)).call(ct,m,r)}return U("svg:g",o).call(ot,this,i,o).call(tt,this,{x:s&&a,y:u&&l}).call(c?g=>g.selectAll().data(Ce(e,y=>c[y]).values()).enter().append("g").each(x):g=>g.datum(e).each(x)).node()}};class tw extends Oa{constructor(e,n={}){super(e,n,U1),this.fill="none"}_render(e){return e.render()}}class ew extends Oa{constructor(e,n={}){super(e,n,Z1,$e)}_render(e){return e.renderHull()}}class nw extends et{constructor(e,n={}){const{x:r,y:i,z:o}=n;super(e,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:o,optional:!0}},Lt(n,function(a,l,s,u,c,d){let{x:f,y:h,z:p}=s;({x:f,y:h}=Hn(s,u,d)),p=p?.value;const m=new Array((f??h).length).fill(null),[x,g]=Ht(this,c),y=f?$=>f[$]:wt(x),w=h?$=>h[$]:wt(g);for(let $ of l){f&&($=$.filter(v=>xt(y(v)))),h&&($=$.filter(v=>xt(w(v))));for(const[,v]of Be($,p)){const b=Ge.from(v,y,w),k=Qf(b,c);for(let M=0,A=v.length;M<A;++M)m[v[M]]=k.renderCell(M)}}return{data:a,facets:l,channels:{cells:{value:m}}}}),K1)}render(e,n,r,i,o){const{x:a,y:l}=n,{x:s,y:u,cells:c}=r;return U("svg:g",o).call(ot,this,i,o).call(tt,this,{x:s&&a,y:u&&l}).call(d=>{d.selectAll().data(e).enter().append("path").call(Q,this).attr("d",f=>c[f]).call(ct,this,r)}).node()}}class rw extends Oa{constructor(e,n){super(e,n,Q1),this.fill="none"}_render(e,n){return Qf(e,n).render()}}function Qf(t,e){const{width:n,height:r,marginTop:i,marginRight:o,marginBottom:a,marginLeft:l}=e;return t.voronoi([l,i,n-o,r-a])}function or(t,e,{x:n,y:r,...i}={}){return[n,r]=Wt(n,r),new t(e,{...i,x:n,y:r})}function iw(t,e){return or(J1,t,e)}function ow(t,e){return or(tw,t,e)}function aw(t,e){return or(ew,t,e)}function lw(t,{x:e,y:n,initializer:r,...i}={}){return or(nw,t,{...jt({...i,x:e,y:n},jc),initializer:r})}function sw(t,e){return or(rw,t,e)}const uw={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};let Jf=class extends et{constructor(e,{x:n,y:r,z:i,weight:o,fill:a,stroke:l,...s}={}){const u=td(a)&&(a="currentColor",!0),c=td(l)&&(l="currentColor",!0);super(e,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:$e({z:i,fill:a,stroke:l}),optional:!0},weight:{value:o,optional:!0}},dw({...s,fill:a,stroke:l},u,c),uw),u&&(this.fill=void 0),c&&(this.stroke=void 0),this.z=i}filter(e){return e}render(e,n,r,i,o){const{contours:a}=r,l=Kt();return U("svg:g",o).call(ot,this,i,o).call(tt,this,{}).call(s=>s.selectAll().data(e).enter().append("path").call(Q,this).call(ct,this,r).attr("d",u=>l(a[u]))).node()}};function cw(t,{x:e,y:n,...r}={}){return[e,n]=Wt(e,n),new Jf(t,{...r,x:e,y:n})}const fw=new Set(["x","y","z","weight"]);function dw(t,e,n){let{bandwidth:r,thresholds:i}=t;return r=r===void 0?20:+r,i=i===void 0?20:typeof i?.[Symbol.iterator]=="function"?St(i):+i,Lt(t,function(o,a,l,s,u,c){const d=l.weight?St(l.weight.value):null,f=l.z?.value,{z:h}=this,[p,m]=Ht(this,u),{width:x,height:g}=u,{x:y,y:w}=Hn(l,s,c),$=Object.fromEntries(Object.entries(l).filter(([L])=>!fw.has(L)).map(([L,C])=>[L,{...C,value:[]}])),v=e&&[],b=n&&[],k=Lm().x(y?L=>y[L]:p).y(w?L=>w[L]:m).weight(d?L=>d[L]:1).size([x,g]).bandwidth(r),M=[];for(const L of a){const C=[];M.push(C);for(const E of f?jo(L,f,h):[L]){const O=k.contours(E);C.push([E,O])}}let A=i;if(!(A instanceof kr)){let L=0;for(const C of M)for(const[,E]of C){const O=E.max;O>L&&(L=O)}A=Float64Array.from({length:i-1},(C,E)=>L*100*(E+1)/i)}const z=[],S=[];for(const L of M){const C=[];z.push(C);for(const[E,O]of L)for(const R of A){C.push(S.length),S.push(O(R/100)),v&&v.push(R),b&&b.push(R);for(const N in $)$[N].value.push(l[N].value[E[0]])}}return v&&v.push(0),b&&b.push(0),{data:o,facets:z,channels:{...$,...v&&{fill:{value:v,scale:"color"}},...b&&{stroke:{value:b,scale:"color"}},contours:{value:S}}}})}function td(t){return/^density$/i.test(t)}function hw(t,e){return ed("x",t,e)}function pw(t,e){return ed("y",t,e)}function ed(t,e,{x1:n,x2:r,y1:i,y2:o,x:a=n===void 0&&r===void 0?t==="y"?gt:D:void 0,y:l=i===void 0&&o===void 0?t==="x"?gt:D:void 0,fill:s,positiveFill:u="#3ca951",negativeFill:c="#4269d0",fillOpacity:d=1,positiveFillOpacity:f=d,negativeFillOpacity:h=d,stroke:p,strokeOpacity:m,z:x=Mt(p)[0],clip:g,tip:y,render:w,...$}={}){return[n,r]=nd(a,n,r),[i,o]=nd(l,i,o),n===r&&i===o&&(t==="y"?i=de(0):n=de(0)),{tip:y}=je({tip:y},t==="y"?"x":"y"),It(lt(u)?null:Object.assign(ya(e,{x1:n,x2:r,y1:i,y2:o,z:x,fill:u,fillOpacity:f,render:ln(w,rd(t,!0)),clip:g,...$}),{ariaLabel:"positive difference"}),lt(c)?null:Object.assign(ya(e,{x1:n,x2:r,y1:i,y2:o,z:x,fill:c,fillOpacity:h,render:ln(w,rd(t,!1)),clip:g,...$}),{ariaLabel:"negative difference"}),yi(e,{x:r,y:o,z:x,stroke:p,strokeOpacity:m,tip:y,clip:!0,...$}))}function nd(t,e,n){return e===void 0&&n===void 0?e=n=de(t):e===void 0?(n=de(n),e=t===void 0?n:de(t)):n===void 0?(e=de(e),n=t===void 0?e:de(t)):(e=de(e),n=de(n)),[e,n]}function de(t){let e;const{value:n,label:r=_t(n)}=tn(t);return{transform:i=>e||(e=V(i,n)),label:r}}function rd(t,e){const n=t==="x"?"y":"x",r=`${n}1`,i=`${n}2`,o=`${t}1`,a=`${t}2`;return(l,s,u,c,d,f)=>{const{[r]:h,[i]:p}=u,m=new Float32Array(h.length),x=new Float32Array(p.length),g=c[t==="y"?"height":"width"];(e===au(s[t])<0?m:x).fill(g);const y=f(l,s,{...u,[i]:h,[a]:x},c,d),w=f(l,s,{...u,[r]:p,[o]:m},c,d),$=y.querySelector("g")??y,v=w.querySelector("g")??w;for(let b=0;$.firstChild;b+=2){const k=ku(),M=U("svg:clipPath",d).attr("id",k).node();M.appendChild($.firstChild),v.childNodes[b].setAttribute("clip-path",`url(#${k})`),v.insertBefore(M,v.childNodes[b])}return w}}function id({geometry:t=D,...e}={}){const n=on(r=>V(r,t));return Lt({...e,x:null,y:null,geometry:{transform:n}},(r,i,o,a,l,{projection:s})=>{const u=n(r),c=u.length,d=new Float64Array(c),f=new Float64Array(c),h=Kt(s);for(let p=0;p<c;++p)[d[p],f[p]]=h.centroid(u[p]);return{data:r,facets:i,channels:{x:{value:d,scale:s==null?"x":null,source:null},y:{value:f,scale:s==null?"y":null,source:null}}}})}function mw({geometry:t=D,...e}={}){const n=on(i=>V(i,t)),r=on(i=>V(n(i),zm));return{...e,x:{transform:i=>Float64Array.from(r(i),([o])=>o)},y:{transform:i=>Float64Array.from(r(i),([,o])=>o)},geometry:{transform:n}}}const yw={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};let od=class extends et{constructor(e,n={}){const[r,i]=dt(n.r,3);super(e,{x:{value:n.tip?n.x:null,scale:"x",optional:!0},y:{value:n.tip?n.y:null,scale:"y",optional:!0},r:{value:r,scale:"r",filter:Jt,optional:!0},geometry:{value:n.geometry,scale:"projection"}},wa(n),yw),this.r=i}render(e,n,r,i,o){const{geometry:a,r:l}=r,s=Kt(o.projection??gw(n)),{r:u}=this;return xr(u)?e=[]:u!==void 0&&s.pointRadius(u),U("svg:g",o).call(ot,this,i,o).call(tt,this,n).call(c=>{c.selectAll().data(e).enter().append("path").call(Q,this).attr("d",l?d=>s.pointRadius(l[d])(a[d]):d=>s(a[d])).call(ct,this,r)}).node()}};function gw({x:t,y:e}){if(t||e)return t??=n=>n,e??=n=>n,mr({point(n,r){this.stream.point(t(n),e(r))}})}function Ca(t,e={}){return e.tip&&e.x===void 0&&e.y===void 0?e=id(e):e.geometry===void 0&&(e={...e,geometry:D}),new od(t,e)}function $w({strokeWidth:t=1.5,...e}={}){return Ca({type:"Sphere"},{strokeWidth:t,...e})}function xw({strokeOpacity:t=.1,...e}={}){return Ca(Sm(),{strokeOpacity:t,...e})}const ar=.5,lr=0;function ww(t={fill:"count"},{binWidth:e,...n}={}){const{z:r}=n;return e=e===void 0?20:rt(e),t=Es(t,n),xe(t,"fill")&&(n.channels={...n.channels,fill:{value:[]}}),n.symbol===void 0&&(n.symbol="hexagon"),n.r===void 0&&!xe(t,"r")&&(n.r=e/2),Lt(n,(i,o,a,l,s,u)=>{let{x:c,y:d,z:f,fill:h,stroke:p,symbol:m}=a;if(c===void 0)throw new Error("missing channel: x");if(d===void 0)throw new Error("missing channel: y");({x:c,y:d}=Hn(a,l,u)),f=f?f.value:V(i,r),h=h?.value,p=p?.value,m=m?.value;const x=fo(t,{z:f,fill:h,stroke:p,symbol:m}),g=f&&[],y=h&&[],w=p&&[],$=m&&[],v=[],b=[],k=[];let M=-1;for(const L of t)L.initialize(i);for(const L of o){const C=[];for(const E of t)E.scope("facet",L);for(const[E,O]of Be(L,x))for(const{index:R,extent:N}of bw(i,O,c,d,e)){C.push(++M),b.push(N.x),k.push(N.y),f&&g.push(x===f?E:f[R[0]]),h&&y.push(x===h?E:h[R[0]]),p&&w.push(x===p?E:p[R[0]]),m&&$.push(x===m?E:m[R[0]]);for(const F of t)F.reduce(R,N)}v.push(C)}const A=a.x.scale,z=a.y.scale,S={x:{value:b,source:l[A]?{value:J(b,l[A].invert),scale:A}:null},y:{value:k,source:l[z]?{value:J(k,l[z].invert),scale:z}:null},...f&&{z:{value:g}},...h&&{fill:{value:y,scale:"auto"}},...p&&{stroke:{value:w,scale:"auto"}},...m&&{symbol:{value:$,scale:"auto"}},...Object.fromEntries(t.map(({name:L,output:C})=>[L,{scale:"auto",label:C.label,radius:L==="r"?e/2:void 0,value:C.transform()}]))};return{data:i,facets:v,channels:S}})}function bw(t,e,n,r,i){const o=i*(1.5/Ms),a=new Map;for(const l of e){let s=n[l],u=r[l];if(isNaN(s)||isNaN(u))continue;let c=Math.round(u=(u-lr)/o),d=Math.round(s=(s-ar)/i-(c&1)/2),f=u-c;if(Math.abs(f)*3>1){let m=s-d,x=d+(s<d?-1:1)/2,g=c+(u<c?-1:1),y=s-x,w=u-g;m*m+f*f>y*y+w*w&&(d=x+(c&1?1:-1)/2,c=g)}const h=`${d},${c}`;let p=a.get(h);p===void 0&&(p={index:[],extent:{data:t,x:(d+(c&1)/2)*i+ar,y:c*o+lr}},a.set(h,p)),p.index.push(l)}return a.values()}const vw={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};function kw(t){return new ad(t)}class ad extends et{constructor({binWidth:e=20,clip:n=!0,...r}={}){super(Rn,void 0,{clip:n,...r},vw),this.binWidth=rt(e)}render(e,n,r,i,o){const{binWidth:a}=this,{marginTop:l,marginRight:s,marginBottom:u,marginLeft:c,width:d,height:f}=i,h=c-ar,p=d-s-ar,m=l-lr,x=f-u-lr,g=a/2,y=g*As,w=y/2,$=g*2,v=y*1.5,b=Math.floor(h/$),k=Math.ceil(p/$),M=Math.floor((m+w)/v),A=Math.ceil((x-w)/v)+1,z=`m0,${ze(-y)}l${ze(g)},${ze(w)}v${ze(y)}l${ze(-g)},${ze(w)}`;let S=z;for(let L=M;L<A;++L)for(let C=b;C<k;++C)S+=`M${ze(C*$+(L&1)*g)},${ze(L*v)}${z}`;return U("svg:g",o).datum(0).call(ot,this,i,o).call(tt,this,{},bt+ar,bt+lr).call(L=>L.append("path").call(Q,this).call(ct,this,r).attr("d",S)).node()}}function ze(t){return Math.round(t*1e3)/1e3}const Mw={ariaLabel:"image",fill:null,stroke:null};function Aw(t){return/^\.*\//.test(t)}function Lw(t){return/^(blob|data|file|http|https):/i.test(t)}function zw(t){return typeof t=="string"&&(Aw(t)||Lw(t))?[void 0,t]:[t,void 0]}class ld extends et{constructor(e,n={}){let{x:r,y:i,r:o,width:a,height:l,rotate:s,src:u,preserveAspectRatio:c,crossOrigin:d,frameAnchor:f,imageRendering:h}=n;o==null&&(o=void 0),o===void 0&&a===void 0&&l===void 0?a=l=16:a===void 0&&l!==void 0?a=l:l===void 0&&a!==void 0&&(l=a);const[p,m]=zw(u),[x,g]=dt(o),[y,w]=dt(a,g!==void 0?g*2:void 0),[$,v]=dt(l,g!==void 0?g*2:void 0),[b,k]=dt(s,0);super(e,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:x,scale:"r",filter:Jt,optional:!0},width:{value:y,filter:Jt,optional:!0},height:{value:$,filter:Jt,optional:!0},rotate:{value:b,optional:!0},src:{value:p,optional:!0}},wa(n),Mw),this.src=m,this.width=w,this.rotate=k,this.height=v,this.r=g,this.preserveAspectRatio=pt(c,"xMidYMid"),this.crossOrigin=kt(d),this.frameAnchor=jn(f),this.imageRendering=pt(h,"auto")}render(e,n,r,i,o){const{x:a,y:l}=n,{x:s,y:u,width:c,height:d,r:f,rotate:h,src:p}=r,{r:m,width:x,height:g,rotate:y}=this,[w,$]=Ht(this,i);return U("svg:g",o).call(ot,this,i,o).call(tt,this,{x:s&&a,y:u&&l}).call(v=>v.selectAll().data(e).enter().append("image").call(Q,this).attr("x",sd(s,c,f,w,x,m)).attr("y",sd(u,d,f,$,g,m)).attr("width",c?b=>c[b]:x!==void 0?x:f?b=>f[b]*2:m*2).attr("height",d?b=>d[b]:g!==void 0?g:f?b=>f[b]*2:m*2).attr("transform",h?b=>`rotate(${h[b]})`:y?`rotate(${y})`:null).attr("transform-origin",h||y?un`${s?b=>s[b]:w}px ${u?b=>u[b]:$}px`:null).call(q,"href",p?b=>p[b]:this.src).call(q,"preserveAspectRatio",this.preserveAspectRatio).call(q,"crossorigin",this.crossOrigin).call(q,"image-rendering",this.imageRendering).call(q,"clip-path",f?b=>`circle(${f[b]}px)`:m!==void 0?`circle(${m}px)`:null).call(ct,this,r)).node()}}function sd(t,e,n,r,i,o){return e&&t?a=>t[a]-e[a]/2:e?a=>r-e[a]/2:t&&i!==void 0?a=>t[a]-i/2:i!==void 0?r-i/2:n&&t?a=>t[a]-n[a]:n?a=>r-n[a]:t?a=>t[a]-o:r-o}function Sw(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wt(e,n)),new ld(t,{...r,x:e,y:n})}function Ew(t,e,n){var r=1e-8,i=e-1,o=n-1,a=0,l,s,u,c,d,f,h,p;if(t<=0)return 0;if(t>=1)return 1;for(l=Math.log(e/(e+n)),s=Math.log(n/(e+n)),u=Math.exp(e*l)/e,c=Math.exp(n*s)/n,h=u+c,t<u/h?f=Math.pow(e*h*t,1/e):f=1-Math.pow(n*h*(1-t),1/n),p=-vn(e)-vn(n)+vn(e+n);a<10;a++){if(f===0||f===1)return f;if(d=Ow(f,e,n)-t,u=Math.exp(i*Math.log(f)+o*Math.log(1-f)+p),c=d/u,f-=u=c/(1-.5*Math.min(1,c*(i/f-o/(1-f)))),f<=0&&(f=.5*(f+u)),f>=1&&(f=.5*(f+u+1)),Math.abs(u)<r*f&&a>0)break}return f}function Ow(t,e,n){var r=t===0||t===1?0:Math.exp(vn(e+n)-vn(e)-vn(n)+e*Math.log(t)+n*Math.log(1-t));return t<0||t>1?!1:t<(e+1)/(e+n+2)?r*ud(t,e,n)/e:1-r*ud(1-t,n,e)/n}function ud(t,e,n){var r=1e-30,i=1,o=e+n,a=e+1,l=e-1,s=1,u=1-o*t/a,c,d,f,h;for(Math.abs(u)<r&&(u=r),u=1/u,h=u;i<=100&&(c=2*i,d=i*(n-i)*t/((l+c)*(e+c)),u=1+d*u,Math.abs(u)<r&&(u=r),s=1+d/s,Math.abs(s)<r&&(s=r),u=1/u,h*=u*s,d=-(e+i)*(o+i)*t/((e+c)*(a+c)),u=1+d*u,Math.abs(u)<r&&(u=r),s=1+d/s,Math.abs(s)<r&&(s=r),u=1/u,f=u*s,h*=f,!(Math.abs(f-1)<3e-7));i++);return h}function vn(t){var e=0,n=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=1.000000000190015,i,o,a;for(a=(o=i=t)+5.5,a-=(i+.5)*Math.log(a);e<6;e++)r+=n[e]/++o;return Math.log(2.506628274631*r/i)-a}function Cw(t,e){var n=Ew(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const Nw={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};let cd=class extends et{constructor(e,n={}){const{x:r,y:i,z:o,ci:a=.95,precision:l=4}=n;if(super(e,{x:{value:r,scale:"x"},y:{value:i,scale:"y"},z:{value:$e(n),optional:!0}},n,Nw),this.z=o,this.ci=+a,this.precision=+l,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${a}`);if(!(this.precision>0))throw new Error(`invalid precision: ${l}`)}render(e,n,r,i,o){const{x:a,y:l,z:s}=r,{ci:u}=this;return U("svg:g",o).call(ot,this,i,o).call(tt,this,n).call(c=>c.selectAll().data(s?jo(e,s,this.z):[e]).enter().call(d=>d.append("path").attr("fill","none").call(Q,this).call(qr,this,{...r,fill:null,fillOpacity:null}).attr("d",f=>this._renderLine(f,a,l)).call(u&&!nn(this.fill)?f=>f.select(Rw).attr("stroke","none").call(Q,this).call(qr,this,{...r,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",h=>this._renderBand(h,a,l)):()=>{}))).node()}};function Rw(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Ne.svg,"path"),this)}let Tw=class extends cd{constructor(e,n){super(e,n)}_renderBand(e,n,r){const{ci:i,precision:o}=this,[a,l]=yt(e,c=>r[c]),s=vi(e,r,n),u=fd(e,r,n,(1-i)/2,s);return Wi().y(c=>c).x0(c=>u(c,-1)).x1(c=>u(c,1))(Mn(a,l-o/2,o).concat(l))}_renderLine(e,n,r){const[i,o]=yt(e,l=>r[l]),a=vi(e,r,n);return`M${a(i)},${i}L${a(o)},${o}`}},Iw=class extends cd{constructor(e,n){super(e,n)}_renderBand(e,n,r){const{ci:i,precision:o}=this,[a,l]=yt(e,c=>n[c]),s=vi(e,n,r),u=fd(e,n,r,(1-i)/2,s);return Wi().x(c=>c).y0(c=>u(c,-1)).y1(c=>u(c,1))(Mn(a,l-o/2,o).concat(l))}_renderLine(e,n,r){const[i,o]=yt(e,l=>n[l]),a=vi(e,n,r);return`M${i},${a(i)}L${o},${a(o)}`}};function Bw(t,{y:e=gt,x:n=D,stroke:r,fill:i=lt(r)?"currentColor":r,...o}={}){return new Tw(t,da({...o,x:n,y:e,fill:i,stroke:r}))}function Ww(t,{x:e=gt,y:n=D,stroke:r,fill:i=lt(r)?"currentColor":r,...o}={}){return new Iw(t,fa({...o,x:e,y:n,fill:i,stroke:r}))}function vi(t,e,n){let r=0,i=0,o=0,a=0;for(const c of t){const d=e[c],f=n[c];r+=d,i+=f,o+=d*f,a+=d*d}const l=t.length,s=(l*o-r*i)/(l*a-r*r),u=(i-s*r)/l;return c=>s*c+u}function fd(t,e,n,r,i){const o=qt(t,c=>e[c])/t.length;let a=0,l=0;for(const c of t)a+=(e[c]-o)**2,l+=(n[c]-i(e[c]))**2;const s=Math.sqrt(l/(t.length-2)),u=Cw(r,t.length-2);return(c,d)=>{const f=i(c),h=s*Math.sqrt(1/t.length+(c-o)**2/a);return f+d*u*h}}function Na({path:t=D,delimiter:e,frameAnchor:n,treeLayout:r=yr,treeSort:i,treeSeparation:o,treeAnchor:a,treeFilter:l,...s}={}){a=Ra(a),i=hd(i),l!=null&&(l=Ia(l)),n===void 0&&(n=a.frameAnchor);const u=md(e),c=kd(s,Ia),[d,f]=Ct(),[h,p]=Ct();return{x:d,y:h,frameAnchor:n,...jt(s,(m,x)=>{const g=u(V(m,t)),y=f([]),w=p([]);let $=-1;const v=[],b=[],k=Ql().path(z=>g[z]),M=te(m)?z=>z.data=m[z.data]:z=>z.data=m.get(z.data),A=r();A.nodeSize&&A.nodeSize([1,1]),A.separation&&o!==void 0&&A.separation(o??Gi);for(const z of c)z[Mi]=z[bd]([]);for(const z of x){const S=[],L=k(z.filter(C=>g[C]!=null)).each(M);i!=null&&L.sort(i),A(L);for(const C of L.descendants())if(!(l!=null&&!l(C))){S.push(++$),v[$]=C.data,a.position(C,$,y,w);for(const E of c)E[Mi][$]=E[vd](C)}b.push(S)}return{data:v,facets:b}}),...Object.fromEntries(c)}}function dd({path:t=D,delimiter:e,curve:n="bump-x",stroke:r="#555",strokeWidth:i=1.5,strokeOpacity:o=.5,treeLayout:a=yr,treeSort:l,treeSeparation:s,treeAnchor:u,treeFilter:c,...d}={}){u=Ra(u),l=hd(l),c!=null&&(c=$d(c)),d={curve:n,stroke:r,strokeWidth:i,strokeOpacity:o,...d};const f=md(e),h=kd(d,$d),[p,m]=Ct(),[x,g]=Ct(),[y,w]=Ct(),[$,v]=Ct();return{x1:p,x2:x,y1:y,y2:$,...jt(d,(b,k)=>{const M=f(V(b,t)),A=m([]),z=g([]),S=w([]),L=v([]);let C=-1;const E=[],O=[],R=Ql().path(F=>M[F]),N=a();N.nodeSize&&N.nodeSize([1,1]),N.separation&&s!==void 0&&N.separation(s??Gi);for(const F of h)F[Mi]=F[bd]([]);for(const F of k){const T=[],B=R(F.filter(j=>M[j]!=null)).each(j=>j.data=b[j.data]);l!=null&&B.sort(l),N(B);for(const{source:j,target:I}of B.links())if(!(c!=null&&!c(I,j))){T.push(++C),E[C]=I.data,u.position(j,C,A,S),u.position(I,C,z,L);for(const Y of h)Y[Mi][C]=Y[vd](I,j)}O.push(T)}return{data:E,facets:O}}),...Object.fromEntries(h)}}function Ra(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return jw;case"right":return Fw}throw new Error(`invalid tree anchor: ${t}`)}const jw={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,i){r[n]=e,i[n]=-t}},Fw={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,i){r[n]=-e,i[n]=-t}};function hd(t){return t==null||typeof t=="function"?t:`${t}`.trim().toLowerCase().startsWith("node:")?pd(Ia(t)):pd(Dw(t))}function pd(t){return(e,n)=>Rt(t(e),t(n))}function Dw(t){return e=>e.data?.[t]}function md(t="/"){if(t=`${t}`,t==="/")return n=>n;if(t.length!==1)throw new Error("delimiter must be exactly one character");const e=t.charCodeAt(0);return n=>n.map(r=>qw(r,e))}const Ta=92,yd=47;function qw(t,e){if(e===Ta)throw new Error("delimiter cannot be backslash");let n=!1;for(let r=0,i=t.length;r<i;++r){switch(t.charCodeAt(r)){case Ta:if(!n){n=!0;continue}break;case e:n?(t=t.slice(0,r-1)+t.slice(r),--r,--i):t=t.slice(0,r)+"/"+t.slice(r+1);break;case yd:n?(t=t.slice(0,r)+"\\\\"+t.slice(r),r+=2,i+=2):(t=t.slice(0,r)+"\\"+t.slice(r),++r,++i);break}n=!1}return t}function Yw(t){let e=!1;for(let n=0,r=t.length;n<r;++n){switch(t.charCodeAt(n)){case Ta:if(!e){e=!0;continue}case yd:e&&(t=t.slice(0,n-1)+t.slice(n),--n,--r);break}e=!1}return t}function gd(t){return Tt(t)&&typeof t.node=="function"}function Pw(t){return Tt(t)&&typeof t.link=="function"}function Ia(t){if(gd(t))return t.node;if(t=`${t}`.trim().toLowerCase(),!!t.startsWith("node:")){switch(t){case"node:name":return Wa;case"node:path":return Ba;case"node:internal":return xd;case"node:external":return wd;case"node:depth":return ja;case"node:height":return Fa}throw new Error(`invalid node value: ${t}`)}}function $d(t){if(gd(t))return t.node;if(Pw(t))return t.link;if(t=`${t}`.trim().toLowerCase(),!(!t.startsWith("node:")&&!t.startsWith("parent:"))){switch(t){case"parent:name":return ki(Wa);case"parent:path":return ki(Ba);case"parent:depth":return ki(ja);case"parent:height":return ki(Fa);case"node:name":return Wa;case"node:path":return Ba;case"node:internal":return xd;case"node:external":return wd;case"node:depth":return ja;case"node:height":return Fa}throw new Error(`invalid link value: ${t}`)}}function Ba(t){return t.id}function Wa(t){return Xw(t.id)}function ja(t){return t.depth}function Fa(t){return t.height}function xd(t){return!!t.children}function wd(t){return!t.children}function ki(t){return(e,n)=>n==null?void 0:t(n)}function Xw(t){let e=t.length;for(;--e>0&&!_w(t,e););return Yw(t.slice(e+1))}function _w(t,e){if(t[e]==="/"){let n=0;for(;e>0&&t[--e]==="\\";)++n;if(!(n&1))return!0}return!1}const bd=2,vd=3,Mi=4;function kd(t,e){const n=[];for(const r in t){const i=t[r],o=e(i);o!==void 0&&n.push([r,...Ct(i),o])}return n}function Md(t,{fill:e,stroke:n,strokeWidth:r,strokeOpacity:i,strokeLinejoin:o,strokeLinecap:a,strokeMiterlimit:l,strokeDasharray:s,strokeDashoffset:u,marker:c,markerStart:d=c,markerEnd:f=c,dot:h=lt(d)&&lt(f),text:p="node:name",textStroke:m="var(--plot-background)",title:x="node:path",dx:g,dy:y,textAnchor:w,treeLayout:$=yr,textLayout:v=$===yr||$===Jl?"mirrored":"normal",tip:b,...k}={}){if(g===void 0&&(g=Ra(k.treeAnchor).dx),w!==void 0)throw new Error("textAnchor is not a configurable tree option");v=Ot(v,"textLayout",["mirrored","normal"]);function M(A){return cn(t,Na({treeLayout:$,text:p,fill:e===void 0?"currentColor":e,stroke:m,dx:g,dy:y,title:x,...A,...k}))}return It($f(t,dd({treeLayout:$,markerStart:d,markerEnd:f,stroke:n!==void 0?n:e===void 0?"node:internal":e,strokeWidth:r,strokeOpacity:i,strokeLinejoin:o,strokeLinecap:a,strokeMiterlimit:l,strokeDasharray:s,strokeDashoffset:u,...k})),h?Le(t,Na({treeLayout:$,fill:e===void 0?"node:internal":e,title:x,tip:b,...k})):null,p!=null?v==="mirrored"?[M({textAnchor:"start",treeFilter:"node:external"}),M({textAnchor:"end",treeFilter:"node:internal",dx:-g})]:M():null)}function Gw(t,e){return Md(t,{...e,treeLayout:Jl})}const Ad={ariaLabel:"waffle"};class Ld extends $a{constructor(e,{unit:n=1,gap:r=1,round:i,render:o,multiple:a,...l}={}){super(e,{...l,render:ln(o,Sd("x"))},Ad),this.unit=Math.max(0,n),this.gap=+r,this.round=Ed(i),this.multiple=Od(a)}}class zd extends xa{constructor(e,{unit:n=1,gap:r=1,round:i,render:o,multiple:a,...l}={}){super(e,{...l,render:ln(o,Sd("y"))},Ad),this.unit=Math.max(0,n),this.gap=+r,this.round=Ed(i),this.multiple=Od(a)}}function Sd(t){return function(e,n,r,i,o){const{unit:a,gap:l,rx:s,ry:u,round:c}=this,{document:d}=o,f=r.channels[`${t}1`].value,h=r.channels[`${t}2`].value,p=this[t==="y"?"_width":"_height"](n,r,i),m=this[t==="y"?"_x":"_y"](n,r,i),x=a*Vw(n.scales[t]),{multiple:g=Math.max(1,Math.floor(Math.sqrt(p/x)))}=this,y=Math.min(p/g,x*g),w=x*g,$=t==="y"?([S,L])=>[S*y,-L*w]:([S,L])=>[L*w,S*y],v=(p-g*y)/2,b=typeof m=="function"?S=>m(S)+v:m+v,k=n[t](0),M=Yg(),A=d.createElementNS(Ne.svg,"pattern");A.setAttribute("width",t==="y"?y:w),A.setAttribute("height",t==="y"?w:y),A.setAttribute("patternUnits","userSpaceOnUse");const z=A.appendChild(d.createElementNS(Ne.svg,"rect"));return z.setAttribute("x",l/2),z.setAttribute("y",l/2),z.setAttribute("width",(t==="y"?y:w)-l),z.setAttribute("height",(t==="y"?w:y)-l),s!=null&&z.setAttribute("rx",s),u!=null&&z.setAttribute("ry",u),U("svg:g",o).call(ot,this,i,o).call(this._transform,this,n).call(S=>S.selectAll().data(e).enter().append(()=>A.cloneNode(!0)).attr("id",L=>`${M}-${L}`).select("rect").call(Q,this).call(ct,this,r)).call(S=>S.selectAll().data(e).enter().append("path").attr("transform",t==="y"?un`translate(${b},${k})`:un`translate(${k},${b})`).attr("d",L=>`M${Da(c(f[L]/a),c(h[L]/a),g).map($).join("L")}Z`).attr("fill",L=>`url(#${M}-${L})`).attr("stroke",this.stroke==null?null:L=>`url(#${M}-${L})`)).node()}}function Da(t,e,n){if(t<0||e<0){const r=Math.ceil(-Math.min(t,e)/n);return Da(t+r*n,e+r*n,n).map(([i,o])=>[i,o-r])}return e<t?Da(e,t,n):[[0,Math.ceil(t/n)],[Math.floor(t%n),Math.ceil(t/n)],[Math.floor(t%n),Math.floor(t/n)+t%1],[Math.ceil(t%n),Math.floor(t/n)+t%1],...t%n>n-1?[]:[[Math.ceil(t%n),Math.floor(t/n)],[n,Math.floor(t/n)]],[n,Math.floor(e/n)],[Math.ceil(e%n),Math.floor(e/n)],[Math.ceil(e%n),Math.floor(e/n)+e%1],[Math.floor(e%n),Math.floor(e/n)+e%1],...e%n<1?[]:[[Math.floor(e%n),Math.ceil(e/n)],[0,Math.ceil(e/n)]]]}function Ed(t){if(t===void 0||t===!1)return Number;if(t===!0)return Math.round;if(typeof t!="function")throw new Error(`invalid round: ${t}`);return t}function Od(t){return t===void 0?void 0:Math.max(1,Math.floor(t))}function Vw({domain:t,range:e}){return Cd(e)/Cd(t)}function Cd(t){const[e,n]=yt(t);return n-e}function Hw(t,e={}){return Ke(e)||(e={...e,y:gt,x2:D}),new Ld(t,Qr(Go(Zr(e))))}function Uw(t,e={}){return Ke(e)||(e={...e,x:gt,y2:D}),new zd(t,Jr(Vo(Kr(e))))}const Zw=({marginLeft:t})=>[1,t],Kw=({width:t,marginRight:e})=>[-1,t-e],Qw=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],Jw=({marginTop:t})=>[1,t],tb=({height:t,marginBottom:e})=>[-1,t-e],eb=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function Nd(t){return typeof t=="string"?{anchor:t}:t}function nb(t={},e={}){arguments.length===1&&([t,e]=Rd(t));let{anchor:n="left",padding:r=1,r:i=e.r}=Nd(t);switch(`${n}`.toLowerCase()){case"left":n=Zw;break;case"right":n=Kw;break;case"middle":n=Qw;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Td("x","y",n,rt(r),i,e)}function rb(t={},e={}){arguments.length===1&&([t,e]=Rd(t));let{anchor:n="bottom",padding:r=1,r:i=e.r}=Nd(t);switch(`${n}`.toLowerCase()){case"top":n=Jw;break;case"bottom":n=tb;break;case"middle":n=eb;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Td("y","x",n,rt(r),i,e)}function Rd(t){const{anchor:e,padding:n,...r}=t,{r:i}=r;return[{anchor:e,padding:n,r:i},r]}function Td(t,e,n,r,i,o){if(i!=null&&typeof i!="number"){let{channels:a,sort:l,reverse:s}=o;a=Qi(a),a?.r===void 0&&(o={...o,channels:{...a,r:{value:i,scale:"r"}}}),l===void 0&&s===void 0&&(o.sort={channel:"-r"})}return Lt(o,function(a,l,s,u,c,d){let{[e]:f,r:h}=s;if(!s[e])throw new Error(`missing channel: ${e}`);({[e]:f}=Hn(s,u,d));const p=h?void 0:i!==void 0?rt(i):this.r!==void 0?this.r:3;h&&(h=V(h.value,u[h.scale]||D,Float64Array));let[m,x]=n(c);const g=m?ob:ib,y=new Float64Array(f.length),w=h?$=>h[$]:()=>p;for(let $ of l){const v=Cm();$=$.filter(h?k=>$r(f[k])&&Jt(h[k]):k=>$r(f[k]));const b=new Float64Array(2*$.length+2);for(const k of $){const M=w(k),A=m?M+r:0,z=f[k]-M,S=f[k]+M;let L=2;v.queryInterval(z-r,S+r,([,,E])=>{const O=y[E]-A,R=f[k]-f[E],N=r+(h?h[k]+h[E]:2*p),F=Math.sqrt(N*N-R*R);b[L++]=O-F,b[L++]=O+F});let C=b.slice(0,L);m&&(C=C.filter(E=>E>=0));t:for(const E of C.sort(g)){for(let O=0;O<L;O+=2)if(b[O]+1e-6<E&&E<b[O+1]-1e-6)continue t;y[k]=E+A;break}v.insert([z,S,k])}}m||(m=1);for(const $ of l)for(const v of $)y[v]=y[v]*m+x;return{data:a,facets:l,channels:{[t]:{value:y,source:null},[e]:{value:f,source:s[e]},...h&&{r:{value:h,source:s.r}}}}})}function ib(t,e){return Math.abs(t)-Math.abs(e)}function ob(t,e){return t-e}function ab(t,e){return arguments.length===1&&({basis:t,...e}=t),va(qa(t),e)}function lb(t,e){return arguments.length===1&&({basis:t,...e}=t),ka(qa(t),e)}function qa(t){if(t===void 0)return Id;if(typeof t=="function")return Ai(Ui(t));if(/^p\d{2}$/i.test(t))return kn(Vi(t));switch(`${t}`.toLowerCase()){case"deviation":return cb;case"first":return Id;case"last":return ub;case"max":return fb;case"mean":return db;case"median":return hb;case"min":return pb;case"sum":return mb;case"extent":return sb}throw new Error(`invalid basis: ${t}`)}function Ai(t){return{mapIndex(e,n,r){const i=+t(e,n);for(const o of e)r[o]=n[o]===null?NaN:n[o]/i}}}function kn(t){return Ai((e,n)=>t(e,r=>n[r]))}const sb={mapIndex(t,e,n){const[r,i]=yt(t,a=>e[a]),o=i-r;for(const a of t)n[a]=e[a]===null?NaN:(e[a]-r)/o}},Id=Ai((t,e)=>{for(let n=0;n<t.length;++n){const r=e[t[n]];if(xt(r))return r}}),ub=Ai((t,e)=>{for(let n=t.length-1;n>=0;--n){const r=e[t[n]];if(xt(r))return r}}),cb={mapIndex(t,e,n){const r=cr(t,o=>e[o]),i=fr(t,o=>e[o]);for(const o of t)n[o]=e[o]===null?NaN:i?(e[o]-r)/i:0}},fb=kn(zt),db=kn(cr),hb=kn(Sn),pb=kn(Nt),mb=kn(qt);function yb(t,e){return Bd("x",t,e)}function gb(t,e){return Bd("y",t,e)}function Bd(t,e,n={}){let r,i=1;if(typeof e=="number")i=e,r=(u,c)=>+u+c;else{if(typeof e=="string"){const u=e.startsWith("-")?-1:1;[e,i]=Yi(e.replace(/^[+-]/,"")),i*=u}e=Sr(e),r=(u,c)=>e.offset(u,c)}const o=`${t}1`,a=`${t}2`,l=Ut({[o]:u=>u.map(c=>r(c,i)),[a]:u=>u},n),s=l[a].transform;return l[a].transform=()=>{const u=s(),[c,d]=yt(u);return u.domain=i<0?[c,r(d,i)]:[r(c,i),d],u},l}function $b(t,e={}){if(typeof t=="string")switch(t.toLowerCase()){case"first":return Wd(e);case"last":return jd(e)}if(typeof t=="function")return Se(null,t,e);let n,r;for(n in t){if(r!==void 0)throw new Error("ambiguous selector; multiple inputs");r=xb(t[n])}if(r===void 0)throw new Error(`invalid selector: ${t}`);return Se(n,r,e)}function xb(t){if(typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"min":return Ya;case"max":return Pa}throw new Error(`unknown selector: ${t}`)}function Wd(t){return Se(null,Mb,t)}function jd(t){return Se(null,Ab,t)}function wb(t){return Se("x",Ya,t)}function bb(t){return Se("y",Ya,t)}function vb(t){return Se("x",Pa,t)}function kb(t){return Se("y",Pa,t)}function*Mb(t){yield t[0]}function*Ab(t){yield t[t.length-1]}function*Ya(t,e){yield Em(t,n=>e[n])}function*Pa(t,e){yield Ii(t,n=>e[n])}function Se(t,e,n){if(t!=null){if(n[t]==null)throw new Error(`missing channel: ${t}`);t=n[t]}const r=$e(n);return jt(n,(i,o)=>{const a=V(i,r),l=V(i,t),s=[];for(const u of o){const c=[];for(const d of a?Ce(u,f=>a[f]).values():[u])for(const f of e(d,l))c.push(f);s.push(c)}return{data:i,facets:s}})}et.prototype.plot=function({marks:t=[],...e}={}){return tf({...e,marks:[...t,this]})};export{fi as Area,xf as Arrow,$a as BarX,xa as BarY,hi as Cell,Vf as Contour,Jf as Density,pi as Dot,Vc as Frame,od as Geo,ad as Hexgrid,ld as Image,mi as Line,gf as Link,et as Mark,Ff as Raster,ei as Rect,_u as RuleX,Gu as RuleY,Gr as Text,Of as TickX,Cf as TickY,Hc as Tip,Vr as Vector,Ld as WaffleX,zd as WaffleY,ya as area,tr as areaX,$n as areaY,Gx as arrow,i1 as auto,vf as autoSpec,xc as axisFx,$c as axisFy,Qo as axisX,Ko as axisY,De as barX,qe as barY,Fe as bin,Me as binX,Ae as binY,Ye as bollinger,k1 as bollingerX,M1 as bollingerY,L1 as boxX,z1 as boxY,xn as cell,Ux as cellX,Zx as cellY,id as centroid,t1 as circle,Gw as cluster,Ct as column,q1 as contour,P1 as crosshair,X1 as crosshairX,_1 as crosshairY,iw as delaunayLink,ow as delaunayMesh,cw as density,hw as differenceX,pw as differenceY,nb as dodgeX,rb as dodgeY,Le as dot,Qx as dotX,Jx as dotY,oy as filter,wy as find,vu as formatIsoDate,Wg as formatMonth,bu as formatNumber,jg as formatWeekday,aa as frame,Ca as geo,mw as geoCentroid,xw as graticule,Ac as gridFx,kc as gridFy,Mc as gridX,vc as gridY,so as group,Yn as groupX,Pn as groupY,lo as groupZ,e1 as hexagon,ww as hexbin,kw as hexgrid,aw as hull,D as identity,Sw as image,gt as indexOf,Lt as initializer,Xf as interpolateNearest,Sa as interpolateNone,Pf as interpolatorBarycentric,_f as interpolatorRandomWalk,B$ as legend,yi as line,er as lineX,nr as lineY,Bw as linearRegressionX,Ww as linearRegressionY,$f as link,Ut as map,va as mapX,ka as mapY,It as marks,qa as normalize,ab as normalizeX,lb as normalizeY,$s as numberInterval,tf as plot,qo as pointer,Yo as pointerX,Pr as pointerY,E1 as raster,oa as rect,ii as rectX,oi as rectY,ay as reverse,be as ruleX,ve as ruleY,dg as scale,$b as select,Wd as selectFirst,jd as selectLast,vb as selectMaxX,kb as selectMaxY,wb as selectMinX,bb as selectMinY,yb as shiftX,gb as shiftY,ly as shuffle,Ls as sort,$w as sphere,M$ as spike,Fc as stackX,q$ as stackX1,Y$ as stackX2,Dc as stackY,P$ as stackY1,X$ as stackY2,cn as text,Zu as textX,Ku as textY,Nf as tickX,Rf as tickY,Pi as timeInterval,Uc as tip,jt as transform,Md as tree,dd as treeLink,Na as treeNode,vr as utcInterval,V as valueof,fc as vector,dc as vectorX,hc as vectorY,lw as voronoi,sw as voronoiMesh,Hw as waffleX,Uw as waffleY,xi as window,f1 as windowX,d1 as windowY};
